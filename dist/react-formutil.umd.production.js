!function(e,t){"object"===typeof exports&&"undefined"!==typeof module?t(exports,require("react"),require("prop-types")):"function"===typeof define&&define.amd?define(["exports","react","prop-types"],t):t((e=e||self).ReactFormutil={},e.React,e.PropTypes)}(this,function(e,t,r){"use strict";var n="default"in t?t.default:t;function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),e}function _defineProperty(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"===typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),n.forEach(function(t){_defineProperty(e,t,r[t])})}return e}function _inherits(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf(e,t)}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _objectWithoutProperties(e,t){if(null==e)return{};var r,n,i=function(e,t){if(null==e)return{};var r,n,i={},o=Object.keys(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||(i[r]=e[r]);return i}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _possibleConstructorReturn(e,t){return!t||"object"!==typeof t&&"function"!==typeof t?_assertThisInitialized(e):t}function _slicedToArray(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=[],n=!0,i=!1,o=void 0;try{for(var a,u=e[Symbol.iterator]();!(n=(a=u.next()).done)&&(r.push(a.value),!t||r.length!==t);n=!0);}catch(e){i=!0,o=e}finally{try{n||null==u.return||u.return()}finally{if(i)throw o}}return r}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function _toConsumableArray(e){return function(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}r=r&&r.hasOwnProperty("default")?r.default:r;var i="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof window?window:"undefined"!==typeof global?global:"undefined"!==typeof self?self:{};function unwrapExports(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function createCommonjsModule(e,t){return e(t={exports:{}},t.exports),t.exports}var o="__global_unique_id__",a=function(){return i[o]=(i[o]||0)+1};function makeEmptyFunction(e){return function(){return e}}var u=function(){};u.thatReturns=makeEmptyFunction,u.thatReturnsFalse=makeEmptyFunction(!1),u.thatReturnsTrue=makeEmptyFunction(!0),u.thatReturnsNull=makeEmptyFunction(null),u.thatReturnsThis=function(){return this},u.thatReturnsArgument=function(e){return e};var s=u,l=createCommonjsModule(function(e,t){t.__esModule=!0;_interopRequireDefault(n);var i=_interopRequireDefault(r),o=_interopRequireDefault(a);_interopRequireDefault(s);function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function _inherits(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var u=1073741823;t.default=function(e,t){var r,a,s="__create-react-context-"+(0,o.default)()+"__",l=function(e){function Provider(){var t,r,n,i;_classCallCheck(this,Provider);for(var o=arguments.length,a=Array(o),u=0;u<o;u++)a[u]=arguments[u];return t=r=_possibleConstructorReturn(this,e.call.apply(e,[this].concat(a))),r.emitter=(n=r.props.value,i=[],{on:function(e){i.push(e)},off:function(e){i=i.filter(function(t){return t!==e})},get:function(){return n},set:function(e,t){n=e,i.forEach(function(e){return e(n,t)})}}),_possibleConstructorReturn(r,t)}return _inherits(Provider,e),Provider.prototype.getChildContext=function(){var e;return(e={})[s]=this.emitter,e},Provider.prototype.componentWillReceiveProps=function(e){if(this.props.value!==e.value){var r=this.props.value,n=e.value,i=void 0;((o=r)===(a=n)?0!==o||1/o===1/a:o!==o&&a!==a)?i=0:(i="function"===typeof t?t(r,n):u,0!==(i|=0)&&this.emitter.set(e.value,i))}var o,a},Provider.prototype.render=function(){return this.props.children},Provider}(n.Component);l.childContextTypes=((r={})[s]=i.default.object.isRequired,r);var c=function(t){function Consumer(){var e,r;_classCallCheck(this,Consumer);for(var n=arguments.length,i=Array(n),o=0;o<n;o++)i[o]=arguments[o];return e=r=_possibleConstructorReturn(this,t.call.apply(t,[this].concat(i))),r.state={value:r.getValue()},r.onUpdate=function(e,t){0!==((0|r.observedBits)&t)&&r.setState({value:r.getValue()})},_possibleConstructorReturn(r,e)}return _inherits(Consumer,t),Consumer.prototype.componentWillReceiveProps=function(e){var t=e.observedBits;this.observedBits=void 0===t||null===t?u:t},Consumer.prototype.componentDidMount=function(){this.context[s]&&this.context[s].on(this.onUpdate);var e=this.props.observedBits;this.observedBits=void 0===e||null===e?u:e},Consumer.prototype.componentWillUnmount=function(){this.context[s]&&this.context[s].off(this.onUpdate)},Consumer.prototype.getValue=function(){return this.context[s]?this.context[s].get():e},Consumer.prototype.render=function(){return(e=this.props.children,Array.isArray(e)?e[0]:e)(this.state.value);var e},Consumer}(n.Component);return c.contextTypes=((a={})[s]=i.default.object,a),{Provider:l,Consumer:c}},e.exports=t.default});unwrapExports(l);var c=unwrapExports(createCommonjsModule(function(e,t){t.__esModule=!0;var r=_interopRequireDefault(n),i=_interopRequireDefault(l);function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}t.default=r.default.createContext||i.default,e.exports=t.default})),f=c({}),$=function(){},d=Object.getPrototypeOf({}),p=/\s*(?:\]\s*\.|\]\s*\[|\.|\[|\])\s*/g,h=isUndefined(window)?global:window;function isUndefined(e){return"undefined"===typeof e}function isFunction(e){return"function"===typeof e}function isEmpty(e){return isUndefined(e)||null===e||e+""===""}function isPromise(e){return!!e&&isFunction(e.then)}function isPlainObj(e){return!!function(e){return"[object Object]"===Object.prototype.toString.call(e)}(e)&&(null===Object.getPrototypeOf(e)||!!isFunction(e.constructor)&&e.constructor.prototype===d)}function deepClone(e){if(e&&"object"===typeof e){if(Array.isArray(e)){for(var t=[],r=0,n=e.length;r<n;r++)t[r]=deepClone(e[r]);return t}if(isPlainObj(e)){var i={};for(var o in e)i[o]=deepClone(e[o]);return i}}return e}var m=function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return isFunction(e)&&e.apply(void 0,r),r[0]};function createHOC(e){return function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return isFunction(r[0])?e.apply(void 0,r):function(t){return e(t,r[0])}}}var v=["minlength","maxlength","max","min","required","pattern","step"];var y,g,b=function(e){try{return new Function("origin","global","return typeof ".concat(e," === 'number' || (typeof ").concat(e," !== 'undefined' && !(origin in global)) ? ").concat(e," : origin"))(e,h)}catch(t){return e}},C=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var n=t[0],i=t[1],o=t[2];$("string"===typeof i,"The second parameter(".concat(JSON.stringify(i),") of parsePath() must be a string."));var a=(i.match(p)||[]).map(function(e){return e.replace(/\s/g,"")}),u=i.split(p).map(function(e){return e.trim()}).filter(function(e){return""!==e}),s=n;try{if(t.length<3)for(var l=0,c=u.length;l<c;l++){var f=b(u[l]);if(l+1===c)return s[f];if(isUndefined(s[f]))break;s=s[f]}else for(var d=0,h=u.length;d<h;d++){var m=b(u[d]),v=u[d+1],y=a[d];if(isUndefined(v)){s[m]=o;break}switch(y){case"].":case".":s=isUndefined(s[m])?s[m]={}:s[m];break;case"][":case"[":var g=b(v);s=isUndefined(s[m])?s[m]="number"===typeof g&&g>=0?[]:{}:s[m];break;default:s[m]=o}}}catch(e){$(!1,"The name '%s' of Field seems is not a legal expression.",i)}if(t.length>2)return n},F=function(e,t){for(var r=0,n=e.length;r<n;r++)if(!0===t(e[r]))return e[r]},_=function(e,t){return Object.keys(e).reduce(function(r,n){return r[n]=t(e[n],n,e),r},{})},E=function(e,t){return Object.keys(e).forEach(function(r){return t(e[r],r,e)})},P=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return e.reduce(function(){return t.apply(void 0,arguments),arguments.length<=0?void 0:arguments[0]},r)},w=function(e,t){isUndefined(C(e,t))||(C(e,t,void 0),function CLEAR(e,t,r){E(e,function(t,r){void 0===t?delete e[r]:t&&"object"===typeof t&&CLEAR(t,r,e)}),r&&Object.keys(e).every(function(t){return void 0===e[t]})&&(r[t]=void 0,CLEAR(r))}(e))},S="FORM_VALIDATE_RESULT";"function"===typeof requestAnimationFrame?(y=requestAnimationFrame,g=cancelAnimationFrame):(y=setTimeout,g=clearTimeout);var O=function(e){function Form(e){var t;return _classCallCheck(this,Form),(t=_possibleConstructorReturn(this,_getPrototypeOf(Form).call(this,e))).$$formPending=void 0,t.$$formValidatePromise=void 0,t.$$registers={},t.$$deepRegisters={},t.$$regDuplications={},t.$$duplicateTimer=void 0,t.$$checkDuplication=function(){var e,r=_assertThisInitialized(t).$$regDuplications;E(r,function(t,n){var i=_slicedToArray(t,2),o=i[0],a=i[1];$(o.$$reserved,"The Field with a name '".concat(n,"' has been registered!")),a.$$reset(o.$getState()),e=delete r[n]}),e&&t.$render()},t.$$register=function(e,r,n){if(t.$$unregister(n,r),e){var i=t.$$getRegister(e);i?(g(t.$$duplicateTimer),t.$$regDuplications[e]=[i,r],t.$$duplicateTimer=y(t.$$checkDuplication)):(t.$$fieldChangedQueue.push({name:e,$newValue:r.$getState().$value}),w(t.$$defaultValues,e)),t.$$registers[r.$name=e]=r,t.createDeepRegisters(),t.$render()}},t.$$unregister=function(e,r,n){if(e){if(e in t.$$regDuplications){var i=_slicedToArray(t.$$regDuplications[e],2),o=i[0],a=i[1];t.$$fieldChangedQueue.push({name:e,$newValue:a.$getState().$value,$prevValue:o.$getState().$value}),delete t.$$regDuplications[e]}else t.$$registers[e]===r&&(n?r.$$reserved=!0:(delete t.$$registers[e],t.$$fieldChangedQueue.push({name:e,$prevValue:r.$getState().$value}),w(t.$$defaultValues,e)));t.createDeepRegisters(),t.$render()}},t.$$defaultInitialize=function(){var e=t.props,r=e.$defaultValues,n=e.$defaultStates;t.$$defaultValues=t.$$deepParseObject(deepClone(isFunction(r)?r(t.props)||{}:r)),t.$$defaultStates=t.$$deepParseObject(deepClone(isFunction(n)?n(t.props)||{}:n))},t.$$getDefault=function(){return{$$defaultStates:t.$$defaultStates,$$defaultValues:t.$$defaultValues}},t.$$triggerChangeTimer=void 0,t.$$fieldChangedQueue=[],t.$$triggerFormChange=function(){if(t.$$fieldChangedQueue.length){var e=_toConsumableArray(t.$$fieldChangedQueue);t.$$fieldChangedQueue.length=0;var r={},n={},i=t.$$registers,o=!1;e.forEach(function(e){if(e.name in i||delete e.$newValue,e.$newValue!==e.$prevValue){if("$newValue"in e&&"$prevValue"in e){var a=t.$$getRegister(e.name);a&&a.$$triggerChange(e)}"$newValue"in e&&C(r,e.name,e.$newValue),"$prevValue"in e&&C(n,e.name,e.$prevValue),o=!0}}),o&&(isFunction(t.props.$validator)&&t.$$formValidate(),isFunction(t.props.$onFormChange)&&t.props.$onFormChange(t.$formutil,r,n))}},t.createDeepRegisters=function(){return t.$$deepRegisters=t.$$deepParseObject(t.$$registers)},t.$$getRegister=function(e){if(e){var r=t.$$registers[e]||C(t.$$deepRegisters,e);if(r)return r}},t.$$formValidate=function(e){return t.$$formValidatePromise=new Promise(function(r){var n,i,o,a,u=(0,t.props.$validator)(t.$formutil.$params,t.formtutil),s=function(t){return r(m(e,m(o,t)))};isPromise(u)?(t.$$formPending||(t.$$formPending=!0,t.$render()),i=function(e){return n=e(s)},a=u.then(function(){},function(e){return e}).then(function(e){return n||(t.$shouldCancelPrevAsyncValidate=null,t.$$formPending=!1,t.$$setFormErrors(e,s))})):(t.$$formPending&&(t.$$formPending=!1),a=t.$$setFormErrors(u,s)),t.$shouldCancelPrevAsyncValidate&&t.$shouldCancelPrevAsyncValidate(function(e){return o=e,a}),t.$shouldCancelPrevAsyncValidate=i})},t.$$setFormErrors=function(e,r){return e&&(e instanceof Error||"object"!==typeof e)?($(!1,"The result of $validator in <Form /> should always return None(null,undefined) or an object contains error message of Field."),t.$render(r)):t.$$setStates(e||{},function(e,t){var r=t.$getState().$error,n=void 0===r?{}:r;return e?{$error:_objectSpread({},n,_defineProperty({},S,e))}:n[S]?(delete n[S],{$error:n}):void 0},r,!0)},t.$getField=function(e){var r=t.$$getRegister(e);if($(!e||r,"$getField('".concat(e,"') fail to find the matched Field. Maybe it has been unmounted.")),$(e,"You should pass a name of the mounted Field to $getField()."),r)return r.$new()},t.$$onChange=function(e,r,n){return t.$setStates(_defineProperty({},e,r),n)},t.$$setStates=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0,o=t.$$deepParseObject(e),a=!1;return E(t.$$registers,function(n,u){var s=u in e?e[u]:C(o,u);if(!isUndefined(s)||i){var l=r(s,n);if(l){var c=t.$formutil.$weakParams[u],f=n.$$merge(l).$value;if(n.$$detectChange(l),"$value"in l||"$viewValue"in l){var $=F(t.$$fieldChangedQueue,function(e){return e.name===u});$?("$prevValue"in $||($.$prevValue=$.$newValue),$.$newValue=f):t.$$fieldChangedQueue.push({name:u,$newValue:f,$prevValue:c})}a=!0}}}),a?t.$render(n):Promise.resolve(m(n,t.$formutil))},t.$render=function(e){return new Promise(function(r){return t.forceUpdate(function(){return r(m(e,t.$formutil))})})},t.$validates=function(){for(var e,r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];if(isFunction(n[n.length-1])&&(e=n.pop()),n.length){!function flatter(e){e.forEach(function(e){if(Array.isArray(e))flatter(e);else{var r=t.$getField(e);r&&r.$validate()}})}(n)}else E(t.$$registers,function(e){return e.$validate()}),isFunction(t.props.$validator)&&t.$$formValidate();return t.$onValidates(e)},t.$onValidates=function(e){var r=Object.keys(t.$$registers).map(function(e){return t.$$registers[e].$onValidate()});return r.push(t.$$formValidatePromise),Promise.all(r).then(function(){return m(e,t.$formutil)})},t.$validate=function(e,r){var n=t.$getField(e);return n?n.$validate(r):m(r)},t.$reset=function(e,r){return t.$$defaultInitialize(),isFunction(e)&&(r=e,e={}),t.$$setStates(e,function(e,t){return t.$$reset(e)},r,!0)},t.$setStates=function(e,r){return t.$$setStates(e,function(e){return e},r)},t.$setValues=function(e,r){return t.$$deepParseObject(deepClone(e),t.$$defaultValues),t.$$setStates(e,function(e){return{$value:e}},r)},t.$setFocuses=function(e,r){return t.$$setStates(e,function(e){return{$focused:e}},r)},t.$setDirts=function(e,r){return t.$$setStates(e,function(e){return{$dirty:e}},r)},t.$setTouches=function(e,r){return t.$$setStates(e,function(e){return{$touched:e}},r)},t.$setPendings=function(e,r){return t.$$setStates(e,function(e){return{$pending:e}},r)},t.$setErrors=function(e,r){return t.$$setStates(e,function(e){return{$error:e}},r)},t.$batchState=function(e,r){return t.$setStates(_(t.$$registers,function(){return e}),r)},t.$batchDirty=function(e,r){return t.$batchState({$dirty:e},r)},t.$batchTouched=function(e,r){return t.$batchState({$touched:e},r)},t.$batchFocused=function(e,r){return t.$batchState({$focused:e},r)},t.$batchPending=function(e,r){return t.$batchState({$pending:e},r)},t.$batchError=function(e,r){return t.$batchState({$error:e},r)},t.$$defaultInitialize(),t}return _inherits(Form,t.Component),_createClass(Form,[{key:"getFormContext",value:function(){return{$$registers:this.$$registers,$$register:this.$$register,$$unregister:this.$$unregister,$$onChange:this.$$onChange,$$getDefault:this.$$getDefault,$formutil:this.$formutil}}},{key:"$$deepParseObject",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return E(e,function(e,r){return C(t,r,e)}),t}},{key:"componentDidUpdate",value:function(){var e=this;g(this.$$triggerChangeTimer),this.$$triggerChangeTimer=y(function(){e.$$triggerFormChange()})}},{key:"_render",value:function(){var e=this.$formutil,r=this.props,n=r.children,i=r.render,o=r.component;return o?t.createElement(o,{$formutil:e}):isFunction(i)?i(e):isFunction(n)?n(e):t.Children.map(n,function(r){return r&&isFunction(r.type)?t.cloneElement(r,{$formutil:e}):r})}},{key:"render",value:function(){var e=this,t=this.props.$processer,r=Object.keys(this.$$registers).map(function(t){return{path:t,$state:e.$$registers[t].$getState()}}),i=P(r,function(e,r){var n=r.path,i=r.$state;t&&t(i,n),"$value"in i&&(i.$dirty||!isUndefined(i.$value))&&(e[n]=i.$value)}),o=P(r,function(e,t){var r=t.path;t.$state;return r in i&&C(e,r,i[r])}),a=r.some(function(e){return e.$state.$invalid}),u=r.some(function(e){return e.$state.$dirty}),s=r.some(function(e){return e.$state.$touched}),l=r.some(function(e){return e.$state.$focused}),c=this.$$formPending||r.some(function(e){return e.$state.$pending}),$=this.$formutil={$$registers:_objectSpread({},this.$$registers),$$deepRegisters:this.$$deepRegisters,$states:P(r,function(e,t){var r=t.path,n=t.$state;return C(e,r,n)}),$params:_objectSpread({},this.$$defaultValues,o),$errors:P(r,function(e,t){var r=t.path,n=t.$state;n.$invalid&&C(e,r,n.$error)}),$dirts:P(r,function(e,t){var r=t.path,n=t.$state;return C(e,r,n.$dirty)}),$touches:P(r,function(e,t){var r=t.path,n=t.$state;return C(e,r,n.$touched)}),$focuses:P(r,function(e,t){var r=t.path,n=t.$state;return C(e,r,n.$focused)}),$pendings:P(r,function(e,t){var r=t.path,n=t.$state;return C(e,r,n.$pending)}),$weakStates:P(r,function(e,t){var r=t.path,n=t.$state;return e[r]=n}),$weakParams:i,$weakErrors:P(r,function(e,t){var r=t.path,n=t.$state;n.$invalid&&(e[r]=n.$error)}),$weakDirts:P(r,function(e,t){var r=t.path,n=t.$state;return e[r]=n.$dirty}),$weakTouches:P(r,function(e,t){var r=t.path,n=t.$state;return e[r]=n.$touched}),$weakFocuses:P(r,function(e,t){var r=t.path,n=t.$state;return e[r]=n.$focused}),$weakPendings:P(r,function(e,t){var r=t.path,n=t.$state;return e[r]=n.$pending}),$getFirstError:function(e){if(e){var t=$.$getField(e);return t&&t.$getFirstError()}for(var r in $.$weakErrors){var n=$.$weakErrors[r];for(var i in n)return n[i]instanceof Error?n[i].message:n[i]}},$render:this.$render,$getField:this.$getField,$onValidates:this.$onValidates,$new:function(){return e.$formutil},$setStates:this.$setStates,$setValues:this.$setValues,$setErrors:this.$setErrors,$setTouches:this.$setTouches,$setDirts:this.$setDirts,$setFocuses:this.$setFocuses,$batchState:this.$batchState,$batchTouched:this.$batchTouched,$batchDirty:this.$batchDirty,$batchFocused:this.$batchFocused,$reset:this.$reset,$validates:this.$validates,$validate:this.$validate,$valid:!a,$invalid:a,$dirty:u,$pristine:!u,$touched:s,$untouched:!s,$focused:l,$pending:c};return n.createElement(f.Provider,{value:this.getFormContext()},this._render())}}]),Form}();O.displayName="React.Formutil.Form",O.defaultProps={$defaultValues:{},$defaultStates:{}};var V=createCommonjsModule(function(e,r){Object.defineProperty(r,"__esModule",{value:!0});var n="function"===typeof Symbol&&Symbol.for,i=n?Symbol.for("react.element"):60103,o=n?Symbol.for("react.portal"):60106,a=n?Symbol.for("react.fragment"):60107,u=n?Symbol.for("react.strict_mode"):60108,s=n?Symbol.for("react.profiler"):60114,l=n?Symbol.for("react.provider"):60109,c=n?Symbol.for("react.context"):60110,f=n?Symbol.for("react.async_mode"):60111,$=n?Symbol.for("react.concurrent_mode"):60111,d=n?Symbol.for("react.forward_ref"):60112,p=n?Symbol.for("react.suspense"):60113,h=n?Symbol.for("react.memo"):60115,m=n?Symbol.for("react.lazy"):60116;function t(e){if("object"===typeof e&&null!==e){var t=e.$$typeof;switch(t){case i:switch(e=e.type){case f:case $:case a:case s:case u:case p:return e;default:switch(e=e&&e.$$typeof){case c:case d:case l:return e;default:return t}}case m:case h:case o:return t}}}function v(e){return t(e)===$}r.typeOf=t,r.AsyncMode=f,r.ConcurrentMode=$,r.ContextConsumer=c,r.ContextProvider=l,r.Element=i,r.ForwardRef=d,r.Fragment=a,r.Lazy=m,r.Memo=h,r.Portal=o,r.Profiler=s,r.StrictMode=u,r.Suspense=p,r.isValidElementType=function(e){return"string"===typeof e||"function"===typeof e||e===a||e===$||e===s||e===u||e===p||"object"===typeof e&&null!==e&&(e.$$typeof===m||e.$$typeof===h||e.$$typeof===l||e.$$typeof===c||e.$$typeof===d)},r.isAsyncMode=function(e){return v(e)||t(e)===f},r.isConcurrentMode=v,r.isContextConsumer=function(e){return t(e)===c},r.isContextProvider=function(e){return t(e)===l},r.isElement=function(e){return"object"===typeof e&&null!==e&&e.$$typeof===i},r.isForwardRef=function(e){return t(e)===d},r.isFragment=function(e){return t(e)===a},r.isLazy=function(e){return t(e)===m},r.isMemo=function(e){return t(e)===h},r.isPortal=function(e){return t(e)===o},r.isProfiler=function(e){return t(e)===s},r.isStrictMode=function(e){return t(e)===u},r.isSuspense=function(e){return t(e)===p}});unwrapExports(V);V.typeOf,V.AsyncMode,V.ConcurrentMode,V.ContextConsumer,V.ContextProvider,V.Element,V.ForwardRef,V.Fragment,V.Lazy,V.Memo,V.Portal,V.Profiler,V.StrictMode,V.Suspense,V.isValidElementType,V.isAsyncMode,V.isConcurrentMode,V.isContextConsumer,V.isContextProvider,V.isElement,V.isForwardRef,V.isFragment,V.isLazy,V.isMemo,V.isPortal,V.isProfiler,V.isStrictMode,V.isSuspense;var j=createCommonjsModule(function(e){e.exports=V}),k={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},x={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},R={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},D={};function getStatics(e){return j.isMemo(e)?R:D[e.$$typeof]||k}D[j.ForwardRef]={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0};var T=Object.defineProperty,A=Object.getOwnPropertyNames,N=Object.getOwnPropertySymbols,U=Object.getOwnPropertyDescriptor,M=Object.getPrototypeOf,I=Object.prototype;var L=function hoistNonReactStatics(e,t,r){if("string"!==typeof t){if(I){var n=M(t);n&&n!==I&&hoistNonReactStatics(e,n,r)}var i=A(t);N&&(i=i.concat(N(t)));for(var o=getStatics(e),a=getStatics(t),u=0;u<i.length;++u){var s=i[u];if(!x[s]&&(!r||!r[s])&&(!a||!a[s])&&(!o||!o[s])){var l=U(t,s);try{T(e,s,l)}catch(e){}}}return e}return e};var H=createHOC(function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=function(i){function FormEnhanced(){return _classCallCheck(this,FormEnhanced),_possibleConstructorReturn(this,_getPrototypeOf(FormEnhanced).apply(this,arguments))}return _inherits(FormEnhanced,t.Component),_createClass(FormEnhanced,[{key:"render",value:function(){var t=Object.assign({},this.props),i=this.props,o=(i.component,_objectWithoutProperties(i,["component"]));return["$defaultStates","$defaultValues","$onFormChange","$validator","$processer"].forEach(function(e){e in t&&("$defaultStates"!==e&&"$defaultValues"!==e||(o[e]=_objectSpread({},r[e],t[e])),delete t[e])}),n.createElement(O,Object.assign({},r,o,{render:function(r){return n.createElement(e,Object.assign({},t,{$formutil:r}))}}))}}]),FormEnhanced}();return i.displayName="React.Formutil.withForm."+(e.displayName||e.name||"Anonymous"),L(i,e)}),G=0,q={$valid:!0,$invalid:!1,$dirty:!1,$pristine:!0,$touched:!1,$untouched:!0,$focused:!1,$pending:!1,$error:{}};function isError(e){return!0!==e}function warningValidatorReturn(e,t,r){$(!isUndefined(e),"You should return a string or Error when the validation('".concat(r&&r+": ").concat(t,"') failed, otherwise return true."))}function GET_FIELD_UUID(){return G++}function createHandler(e,t){var r;function $$reset(t){var r,n=e.props,i=e.$formContext;if(i.$$getDefault){var o=n.name,a=i.$$getDefault(),u=a.$$defaultStates,s=a.$$defaultValues;if(o&&s){var l=C(s,o);r=C(u,o)||{},isUndefined(l)||(r.$value=l)}}var c=n.$defaultValue,f=n.$defaultState;return $$merge(_objectSpread({},q,isFunction(f)?f(n):f,{$value:isFunction(c)?c(n):"$defaultValue"in n?c:""},r,t))}function $getState(){return _objectSpread({},e.$state)}function $validate(t){return r=new Promise(function(r){var n,i,o,a,u=e.props,s=e.$formContext,l=_objectSpread({},u.$validators,u.$asyncValidators),c=e.$state,f=c.$value,$=c.$pending,d=Object.assign({},c.$error),p=s.$formutil,h={},v=!1;delete d[S];var y=Object.keys(l).reduce(function(t,r){if(delete d[r],!v&&null!=u[r]){var i=l[r](f,u[r],_objectSpread({},u,{$formutil:p,$fieldutil:e.$fieldutil,$validError:h}));isPromise(i)?t.push(i.catch(function(e){n||$setValidity(r,e||r)})):isError(i)&&(h[r]=i||r,warningValidatorReturn(i,r,u.name),u.$validateLazy&&(v=!0))}return t},[]),g=function(e){return r(m(t,m(o,e)))};y.length?($||$setPending(!0),i=function(e){return n=e(g)},y.push($setError(_objectSpread({},d,h))),a=Promise.all(y).then(function(){return n||(e.$shouldCancelPrevAsyncValidate=null,$setPending(!1,g))})):($&&$setPending(!1),a=$setError(_objectSpread({},d,h),g)),e.$shouldCancelPrevAsyncValidate&&e.$shouldCancelPrevAsyncValidate(function(e){return o=e,a}),e.$shouldCancelPrevAsyncValidate=i})}function $setError(t,r){return e.$setState({$error:t},r)}function $setValidity(t){var r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2?arguments[2]:void 0,i=Object.assign({},e.$state.$error);return isError(r)?(i[t]=r||t,warningValidatorReturn(r,t,e.props.name)):delete i[t],$setError(i,n)}function $setPending(t,r){return e.$setState({$pending:t},r)}function $$merge(t){var r=Object.assign({},t);"$error"in r&&(r.$error||(r.$error={}),r.$valid=0===Object.keys(r.$error).length);var n=e.props,i=n.$parser,o=n.$formatter;if("$viewValue"in r&&!("$value"in r)){r.$value=i?i(r.$viewValue,function(e){return r.$viewValue=e}):r.$viewValue}else if("$value"in r&&!("$viewValue"in r)){r.$viewValue=o?o(r.$value,function(e){return r.$value=e}):r.$value}return"$valid"in r?r.$invalid=!r.$valid:"$invalid"in r&&(r.$dirty=!r.$invalid),"$dirty"in r?r.$pristine=!r.$dirty:"$pristine"in r&&(r.$dirty=!r.$pristine),"$touched"in r?r.$untouched=!r.$touched:"$untouched"in r&&(r.$touched=!r.$untouched),e.$state=_objectSpread({},e.$state,r),$getState()}return{$$FIELD_UUID:e.$$FIELD_UUID,$$reset:$$reset,$$merge:$$merge,$$detectChange:function(e){("$value"in e||"$viewValue"in e)&&$validate()},$$triggerChange:function(t){var r=t.$newValue,n=t.$prevValue,i=e.props.$onFieldChange;isFunction(i)&&i(r,n,e.$formContext.$formutil)},$onValidate:function(e){return r.then(e),r},$new:function(){return e.$fieldutil},$picker:$getState,$getState:$getState,$getComponent:function(){return t},$reset:function(t,r){return e.$setState($$reset(t),r)},$getFirstError:function(){var t=e.$state.$error,r=void 0===t?{}:t;for(var n in r)return r[n]instanceof Error?r[n].message:r[n]},$validate:$validate,$setState:e.$setState,$render:function(t,r){return e.$setState({$viewValue:t,$dirty:!0},r)},$setValue:function(t,r){return e.$setState({$value:t},r)},$setTouched:function(t,r){return e.$setState({$touched:t},r)},$setDirty:function(t,r){return e.$setState({$dirty:t},r)},$setFocused:function(t,r){return e.$setState({$focused:t},r)},$setValidity:$setValidity,$setError:$setError,$setPending:$setPending}}var B=function(e){function Field(){var e,t;_classCallCheck(this,Field);for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return(t=_possibleConstructorReturn(this,(e=_getPrototypeOf(Field)).call.apply(e,[this].concat(n)))).$$FIELD_UUID=GET_FIELD_UUID(),t.$formContext=void 0,t.$state=void 0,t.$setState=function(e,r){return new Promise(function(n){var i=function(){return n(m(r,t.$fieldutil))};if(t.isMounting){var o=t.props.name;o in(t.$formContext.$$registers||{})?t.$formContext.$$onChange(o,e,i):(t.$registered.$$merge(e),t.$registered.$$detectChange(e),t.forceUpdate(i))}else t.$registered.$$merge(e),i()})},t}return _inherits(Field,t.Component),_createClass(Field,[{key:"componentDidMount",value:function(){this.isMounting=!0;var e=this.props.name,t=this.$formContext;$(!e||t.$formutil,"You should enusre that the <Field /> with the name '".concat(e,"' must be used underneath a <Form /> component or withForm() HOC, otherwise it's isolated.")),$(e,"You should assign a name to <Field />, otherwise it will be isolated!"),t.$$register&&t.$$register(e,this.$fieldHandler),this.$prevValue=this.$state.$value}},{key:"componentWillUnmount",value:function(){this.$formContext.$$unregister&&this.$formContext.$$unregister(this.props.name,this.$fieldHandler,this.props.$reserveOnUnmount),this.isMounting=!1}},{key:"componentDidUpdate",value:function(e){var t=this.props.name;t!==e.name&&this.$formContext.$$register&&this.$formContext.$$register(t,this.$fieldHandler,e.name),this.$state.$value!==this.$prevValue&&(t in(this.$formContext.$$registers||{})||this.$registered.$$triggerChange({$newValue:this.$state.$value,$prevValue:this.$prevValue}),this.$prevValue=this.$state.$value)}},{key:"_render",value:function(){return function(e,r){var n=r.children,i=r.render,o=r.component;return o?t.createElement(o,{$fieldutil:e}):isFunction(i)?i(e):isFunction(n)?n(e):t.Children.map(n,function(r){return r&&isFunction(r.type)?t.cloneElement(r,{$fieldutil:e}):r})}(this.$fieldutil=_objectSpread({$name:this.props.name},this.$registered.$getState(),this.$registered,{$$formutil:this.$formContext.$formutil}),this.props)}},{key:"render",value:function(){var e=this,t=!this.$formContext;return n.createElement(f.Consumer,null,function(r){return e.$formContext=r,e.$fieldHandler||(e.$fieldHandler=createHandler(e,e)),e.$registered=(r.$$registers||{})[e.$fieldHandler.$name]||e.$fieldHandler,t&&(e.$fieldHandler.$$reset(),e.$fieldHandler.$validate()),e._render()})}}]),Field}();B.displayName="React.Formutil.Field";var z=createHOC(function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=function(i){function FieldEnhanced(){return _classCallCheck(this,FieldEnhanced),_possibleConstructorReturn(this,_getPrototypeOf(FieldEnhanced).apply(this,arguments))}return _inherits(FieldEnhanced,t.Component),_createClass(FieldEnhanced,[{key:"render",value:function(){var t=Object.assign({},this.props),i=this.props,o=(i.component,_objectWithoutProperties(i,["component"]));return["$validators","$asyncValidators","$validateLazy","$reserveOnUnmount","$defaultValue","$defaultState","$onFieldChange","$parser","$formatter","name"].concat(Object.keys(_objectSpread({},r.$validators,r.$asyncValidators,t.$validators,t.$asyncValidators))).forEach(function(e){e in t&&("$validators"!==e&&"$asyncValidators"!==e&&"$defaultState"!==e||(o[e]=_objectSpread({},r[e],t[e])),delete t[e])}),n.createElement(B,Object.assign({},r,o,{render:function(r){return n.createElement(e,Object.assign({},t,{$fieldutil:r}))}}))}}]),FieldEnhanced}();return i.displayName="React.Formutil.withField."+(e.displayName||e.name||"Anonymous"),L(i,e)}),W=function(e){function EasyFieldNative(){return _classCallCheck(this,EasyFieldNative),_possibleConstructorReturn(this,_getPrototypeOf(EasyFieldNative).apply(this,arguments))}return _inherits(EasyFieldNative,t.Component),_createClass(EasyFieldNative,[{key:"render",value:function(){var e=this,t=this.props,r=(t.$fieldutil,t.value),i=t.onChange,o=t.onFocus,a=t.onBlur,u=t.checked,s=t.unchecked,l=_objectWithoutProperties(t,["$fieldutil","value","onChange","onFocus","onBlur","checked","unchecked"]),c=this.props.type,f={value:"compositionValue"in this?this.compositionValue:r,onCompositionEnd:function(t){e.composition=!1,delete e.compositionValue,f.onChange(t)},onCompositionStart:function(){return e.composition=!0},onChange:function(t){var r=t.target.value;e.composition?(e.compositionValue=r,e.forceUpdate()):i(r,t)},onFocus:o,onBlur:a},$="input";switch(c){case"select":$=c,f.onChange=function(e){var t=e.target,r=t.multiple?[].slice.call(t.options).filter(function(e){return e.selected}).map(function(e){return e.value}):t.value;i(r,e)},delete l.type;break;case"textarea":$=c,delete l.type;break;case"checkbox":case"radio":f={checked:r===u,onChange:function(e){i(e.target.checked?u:s,e)},onFocus:o,onBlur:a}}return n.createElement($,Object.assign({},l,f))}}]),EasyFieldNative}();W.displayName="React.Formutil.EasyField.Native",W.defaultProps={value:"",type:"text",checked:!0,unchecked:!1};var Y=c({}),Q=Y.Provider,K=Y.Consumer,J=function(e){function EasyFieldGroup(){return _classCallCheck(this,EasyFieldGroup),_possibleConstructorReturn(this,_getPrototypeOf(EasyFieldGroup).apply(this,arguments))}return _inherits(EasyFieldGroup,t.Component),_createClass(EasyFieldGroup,[{key:"getGroupContext",value:function(){return this.props}},{key:"_render",value:function(){var e=this.props,r=e.className,i=e.groupNode,o=e.children,a={GroupOption:X,Field:Z},u=isFunction(o)?o(a):t.Children.map(o,function(e){return t.cloneElement(e,a)});return null===i?u:n.createElement(i,{className:r},u)}},{key:"render",value:function(){return n.createElement(Q,{value:this.getGroupContext()},this._render())}}]),EasyFieldGroup}();J.displayName="React.Formutil.EasyField.Group",J.defaultProps={type:"checkbox",groupNode:"div"};var X=function(e){function EasyFieldGroupOption(){return _classCallCheck(this,EasyFieldGroupOption),_possibleConstructorReturn(this,_getPrototypeOf(EasyFieldGroupOption).apply(this,arguments))}return _inherits(EasyFieldGroupOption,t.Component),_createClass(EasyFieldGroupOption,[{key:"componentDidMount",value:function(){$("$value"in this.props,"You should pass a $value to <GroupOption />.")}},{key:"render",value:function(){var e=this.props,t=e.$value,r=e.onChange,i=e.onFocus,o=e.onBlur,a=_objectWithoutProperties(e,["$value","onChange","onFocus","onBlur"]);return n.createElement(K,null,function(e){var u=e.type,s=e.name,l="radio"===u?{checked:e.value===t,onChange:function(n){e.onChange(t,n),r&&r(n)}}:"checkbox"===u?{checked:e.value.indexOf(t)>-1,onChange:function(n){e.onChange(n.target.checked?e.value.concat(t):e.value.filter(function(e){return e!==t}),n),r&&r(n)}}:{value:e.value,onChange:function(t){e.onChange(t),r&&r(t)}};return n.createElement("input",Object.assign({name:s},a,l,{type:u,onFocus:function(t){e.onFocus(t),i&&i(t)},onBlur:function(t){e.onBlur(t),o&&o(t)}}))})}}]),EasyFieldGroupOption}();X.displayName="React.Formutil.EasyField.Group.Option";var Z=function(e){function DeprecatedEasyFieldGroupOption(){return _classCallCheck(this,DeprecatedEasyFieldGroupOption),_possibleConstructorReturn(this,_getPrototypeOf(DeprecatedEasyFieldGroupOption).apply(this,arguments))}return _inherits(DeprecatedEasyFieldGroupOption,t.Component),_createClass(DeprecatedEasyFieldGroupOption,[{key:"componentDidMount",value:function(){$(!1,'The "Field" property in EasyField\'s children-props has been deprecated. Please use "GroupOption" instead.')}},{key:"render",value:function(){return n.createElement(X,this.props)}}]),DeprecatedEasyFieldGroupOption}();Z.displayName="React.Formutil.EasyField.Group.Option.Deprecated";var ee=Array.isArray,te=Object.keys,re=Object.prototype.hasOwnProperty,ne="undefined"!==typeof Element;var ie=function(e,t){try{return function equal(e,t){if(e===t)return!0;if(e&&t&&"object"==typeof e&&"object"==typeof t){var r,n,i,o=ee(e),a=ee(t);if(o&&a){if((n=e.length)!=t.length)return!1;for(r=n;0!==r--;)if(!equal(e[r],t[r]))return!1;return!0}if(o!=a)return!1;var u=e instanceof Date,s=t instanceof Date;if(u!=s)return!1;if(u&&s)return e.getTime()==t.getTime();var l=e instanceof RegExp,c=t instanceof RegExp;if(l!=c)return!1;if(l&&c)return e.toString()==t.toString();var f=te(e);if((n=f.length)!==te(t).length)return!1;for(r=n;0!==r--;)if(!re.call(t,f[r]))return!1;if(ne&&e instanceof Element&&t instanceof Element)return e===t;for(r=n;0!==r--;)if(("_owner"!==(i=f[r])||!e.$$typeof)&&!equal(e[i],t[i]))return!1;return!0}return e!==e&&t!==t}(e,t)}catch(e){if(e.message&&e.message.match(/stack|recursion/i)||-2146828260===e.number)return console.warn("Warning: react-fast-compare does not handle circular references.",e.name,e.message),!1;throw e}},oe=n.Frament||"div",ae=function(e){function EasyFieldList(e){var t;return _classCallCheck(this,EasyFieldList),(t=_possibleConstructorReturn(this,_getPrototypeOf(EasyFieldList).call(this,e))).id=0,t.latestValue=t.props.value,t.$formutil=void 0,t.FieldValidators={required:function(e){return null!==e}},t.$onFormChange=function(e){e.$onValidates(function(e){var r=e.$invalid,n=e.$params;r?t.props.value.length&&t.props.onChange(t.latestValue=[]):ie(t.props.value,n.list)||t.props.onChange(t.latestValue=n.list)})},t.swap=function(e,r,n){return t.$setState(function(t){var n=t.items,i=[n[e],n[r]];return n[r]=i[0],n[e]=i[1],n},n)},t.insert=function(){for(var e,r,n,i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return o.forEach(function(t){isFunction(t)?n=t:"number"===typeof t?e=t:"object"===typeof t&&(r=t)}),t.$setState(function(n){var i=n.items;return isUndefined(e)?i.push(t.getId(r)):i.splice(e,0,t.getId(r)),{items:i}},n)},t.remove=function(){for(var e,r,n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return i.forEach(function(t){isFunction(t)?r=t:"number"===typeof t&&(e=t)}),t.$setState(function(r){var n=r.items;return isUndefined(e)?n.pop():n.splice(e,1),n.length||(n=[t.getId()]),{items:n}},r)},t.$setState=function(e,r){return new Promise(function(n){return t.setState(e,function(){return t.$formutil.$onValidates(function(e){return n(m(r,e))})})})},t.state={items:e.value.length?e.value.map(function(){return t.getId()}):[t.getId()],formKey:0},t}return _inherits(EasyFieldList,t.Component),_createClass(EasyFieldList,[{key:"componentDidUpdate",value:function(e){var t=this;this.props.value!==this.latestValue&&(this.setState({items:this.props.value.length?this.props.value.map(function(){return t.getId()}):[this.getId()],formKey:this.state.formKey+1}),this.latestValue=this.props.value)}},{key:"getId",value:function(e){return{id:this.id++,values:e}}},{key:"render",value:function(){var e=this,t=this.props,r=t.children,i=t.onFocus,o=t.onBlur,a=t.value;if(!isFunction(r))return null;var u={$length:this.state.items.length,$insert:this.insert,$remove:this.remove,$swap:this.swap,$push:function(t,r){return e.insert(t,r)},$pop:function(t){return e.remove(t)},$shift:function(t){return e.remove(0,t)},$unshift:function(t,r){return e.insert(0,t,r)},onFocus:i,onBlur:o};return n.createElement(O,{key:this.state.formKey,$defaultValues:{list:a},$onFormChange:this.$onFormChange,children:function(t){return e.$formutil=t,n.createElement(oe,null,e.state.items.map(function(i,o){var a=i.id,s=i.values;return n.createElement(B,{key:a,required:!0,$defaultValue:s||null,$validators:e.FieldValidators,name:"list[".concat(o,"]"),children:function(i){return n.createElement(O,{$defaultValues:i.$value||{},$onFormChange:function(e){return e.$onValidates(function(e){var t=e.$invalid,r=e.$params;t?null!==i.$viewValue&&i.$render(null):ie(i.$viewValue,r)||i.$render(r)})},children:function(n){return r(_objectSpread({},u,n,{$index:o,$isLast:function(){return o===e.state.items.length-1},$isFirst:function(){return 0===o}}),t)}})}})}))}})}}]),EasyFieldList}();ae.displayName="React.Formutil.EasyField.List";var ue="__TYPE__",se=[["required",function(e,t,r){var n=r.__TYPE__,i=r.checked;return"checked"===n?e===(void 0===i||i):!isEmpty(e)}],["maxLength",function(e,t){return isEmpty(e)||e.length<=t}],["minLength",function(e,t){return isEmpty(e)||e.length>=t}],["max",function(e,t){return isEmpty(e)||1*e<=t}],["min",function(e,t){return isEmpty(e)||1*e>=t}],["pattern",function(e,t){return isEmpty(e)||t.test(e)}],["enum",function(e,t){return isEmpty(e)||t.indexOf(e)>-1}],["checker",function(e,t,r){return t(e,r)}]].reduce(function(e,t){var r=_slicedToArray(t,2),n=r[0],i=r[1];return e[n]=function(e,t,r){var o=r.validMessage,a=void 0===o?{}:o;return i.apply(void 0,arguments)||a[n]||"Error input: ".concat(n)},e},{}),le={validMessage:{},valuePropName:"value",changePropName:"onChange",focusPropName:"onFocus",blurPropName:"onBlur",$parser:function(e){return"string"===typeof e?e.trim():e}};function createHandler$1(e,t,r){var n,i=t.valuePropName,o=t.changePropName,a=t.focusPropName,u=t.blurPropName,s=t.passUtil,l=_objectSpread({},r,(_defineProperty(n={},i,e.$viewValue),_defineProperty(n,o,function(){for(var r=arguments.length,n=new Array(r),a=0;a<r;a++)n[a]=arguments[a];var u=n[0],s=n[n.length-1];s=s&&s.target?[s]:n;var l=t[o];l&&l.apply(void 0,_toConsumableArray(s));var c=function(e){return e&&e.target?e.target[i]:e}(u);e.$render(c)}),_defineProperty(n,a,function(){var r=t[a];r&&r.apply(void 0,arguments),e.$setFocused(!0)}),_defineProperty(n,u,function(){var r=t[u];r&&r.apply(void 0,arguments),e.$untouched&&e.$setTouched(!0),e.$setFocused(!1)}),n));return s&&(l[!0===s?"$fieldutil":s]=e),l}function parseProps(e){var t=e.children,r=e.component,n=e.render,i=_objectWithoutProperties(e,["children","component","render"]),o=i.name,a=i.type,u=i.defaultValue,s=(i.valuePropName,i.changePropName,i.focusPropName,i.blurPropName,i.validMessage,i.__TYPE__,i.passUtil,i.$defaultValue,i.$defaultState,i.$onFieldChange,i.$validators,i.$asyncValidators,i.$validateLazy,i.$reserveOnUnmount,i.$parser,i.$formatter,_objectWithoutProperties(i,["name","type","defaultValue","valuePropName","changePropName","focusPropName","blurPropName","validMessage","__TYPE__","passUtil","$defaultValue","$defaultState","$onFieldChange","$validators","$asyncValidators","$validateLazy","$reserveOnUnmount","$parser","$formatter"])),l={children:t,component:r,render:n},c=!isUndefined(a)||isUndefined(t)&&isUndefined(r)&&isUndefined(n);if(Object.keys(_objectSpread({},i.$validators=_objectSpread({},se,i.$validators),i.$asyncValidators)).forEach(function(e){e in s&&(c&&function(e){return v.indexOf(e.toLowerCase())>-1}(e)||delete s[e])}),c){var f=_slicedToArray((a||"").split("."),2),$=f[0],d=void 0===$?"text":$,p=f[1];switch(l.component="group"===d?J:"list"===d?ae:W,o&&(s.name=o),a&&(s.type=d),t&&(s.children=t),d){case"select":case"textarea":e.multiple&&(i[ue]="array");break;case"group":"checkbox"===p&&(i[ue]="array"),s.type=p;break;case"checkbox":case"radio":i[ue]="checked";break;case"list":i[ue]="array"}}if(!("$defaultValue"in i)&&"defaultValue"in e&&(i.$defaultValue=u),!("$defaultValue"in i)&&ue in i){var h;switch(i[ue]){case"checked":var m=i.unchecked;h=void 0!==m&&m;break;case"array":h=[];break;case"object":h={};break;case"number":h=0}i.$defaultValue=h}return{fieldProps:i,childProps:s,renderProps:l}}var ce=function(e){function EasyField(){return _classCallCheck(this,EasyField),_possibleConstructorReturn(this,_getPrototypeOf(EasyField).apply(this,arguments))}return _inherits(EasyField,t.Component),_createClass(EasyField,[{key:"render",value:function(){var e=parseProps(this.props),r=e.fieldProps,i=e.childProps,o=e.renderProps;return n.createElement(B,Object.assign({},r,{children:function(e){return function(e,r){var n=r.component,i=r.render,o=r.children;return n?t.createElement(n,e):isFunction(i)?i(e):isFunction(o)?o(e):t.Children.map(o,function(r){return t.cloneElement(r,e)})}(createHandler$1(e,r,i),o)}}))}}]),EasyField}();function useFormContext(){if(!n.useState)throw new Error("Hooks api need react@>=16.8, Please upgrade your reactjs.");return(0,n.useContext)(f)}function useField(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!n.useState)throw new Error("Hooks api need react@>=16.8, Please upgrade your reactjs.");var r,i=n.useState,o=n.useLayoutEffect,a=n.useRef;e&&("string"===typeof e?(r=e,t.name=r):r=(t=e).name);var u,s=useFormContext(),l=a({}).current,c=a([]);l.$formContext=s,l.props=t,l.$setState=function(e,t){return new Promise(function(n){var i=function(){return n(m(t,l.$fieldutil))};l.isMounting?r in(s.$$registers||{})?s.$$onChange(r,e,i):(f(u.$$merge(e)),u.$$detectChange(e),c.current.push(i)):(u.$$merge(e),i())})};var f=_slicedToArray(i(function(){l.$$FIELD_UUID=GET_FIELD_UUID(),l.$fieldHandler=u=createHandler(l);var e=l.$fieldHandler.$$reset();return l.$fieldHandler.$validate(),e}),2)[1];return u||(u=(s.$$registers||{})[l.$fieldHandler.$name]||l.$fieldHandler),o(function(){var e=l.$state;if(l.isMounting&&!(r in(s.$$registers||{}))){var t=l.$prevValue;u.$$triggerChange({$newValue:e.$value,$prevValue:t})}l.$prevValue=e.$value},[l.$state.$value]),o(function(){return l.isMounting=!0,$(!r||s.$formutil,"You should enusre that the useField() with the name '".concat(r,"' must be used underneath a <Form /> component or withForm() HOC, otherwise it's isolated.")),$(r,"You should pass a name argument to useField(), otherwise it will be isolated!"),function(){s.$$unregister&&s.$$unregister(r,l.$fieldHandler,t.$reserveOnUnmount),l.isMounting=!1}},[]),o(function(){s.$$register&&s.$$register(r,l.$fieldHandler,l.$prevName),l.$prevName=r},[r]),o(function(){if(c.current.length>0){var e=_toConsumableArray(c.current);for(c.current.length=0;e.length;)e.pop()(l.$fieldutil)}}),l.$fieldutil=_objectSpread({$name:r},u.$getState(),u,{$$formutil:s.$formutil})}ce.displayName="React.Formutil.EasyField",ce.defaultProps=le,e.EasyField=ce,e.Field=B,e.Form=O,e.connect=function(e){var r=function(r){function Connect(){return _classCallCheck(this,Connect),_possibleConstructorReturn(this,_getPrototypeOf(Connect).apply(this,arguments))}return _inherits(Connect,t.Component),_createClass(Connect,[{key:"render",value:function(){var t=this;return n.createElement(f.Consumer,null,function(r){return n.createElement(e,Object.assign({},t.props,{$formutil:r.$formutil}))})}}]),Connect}();return r.displayName="React.Formutil.connect."+(e.displayName||e.name||"Anonymous"),L(r,e)},e.useField=useField,e.useForm=function(){return useFormContext().$formutil},e.useHandler=function(e){var t=parseProps(e=_objectSpread({},le,e,{children:null})),r=t.fieldProps,n=t.childProps;return createHandler$1(useField(r),r,n)},e.withField=z,e.withForm=H,Object.defineProperty(e,"__esModule",{value:!0})});
