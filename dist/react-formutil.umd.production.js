!function(e,t){"object"===typeof exports&&"undefined"!==typeof module?t(exports,require("react"),require("prop-types")):"function"===typeof define&&define.amd?define(["exports","react","prop-types"],t):t((e=e||self).ReactFormutil={},e.React,e.PropTypes)}(this,function(e,t,r){"use strict";var n="default"in t?t.default:t;function o(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function i(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"===typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),n.forEach(function(t){o(e,t,r[t])})}return e}function a(e){return function(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function u(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=[],n=!0,o=!1,i=void 0;try{for(var a,u=e[Symbol.iterator]();!(n=(a=u.next()).done)&&(r.push(a.value),!t||r.length!==t);n=!0);}catch(e){o=!0,i=e}finally{try{n||null==u.return||u.return()}finally{if(o)throw i}}return r}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function c(e,t,r){return t&&l(e.prototype,t),r&&l(e,r),e}function $(e){return($="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function f(e){return(f="function"===typeof Symbol&&"symbol"===$(Symbol.iterator)?function(e){return $(e)}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":$(e)})(e)}function d(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function p(e,t){return!t||"object"!==f(t)&&"function"!==typeof t?d(e):t}function h(e){return(h=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function m(e,t){return(m=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function v(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&m(e,t)}r=r&&r.hasOwnProperty("default")?r.default:r;var g="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof window?window:"undefined"!==typeof global?global:"undefined"!==typeof self?self:{};function y(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function b(e,t){return e(t={exports:{}},t.exports),t.exports}var w="__global_unique_id__",C=function(){return g[w]=(g[w]||0)+1};function P(e){return function(){return e}}var V=function(){};V.thatReturns=P,V.thatReturnsFalse=P(!1),V.thatReturnsTrue=P(!0),V.thatReturnsNull=P(null),V.thatReturnsThis=function(){return this},V.thatReturnsArgument=function(e){return e};var F=V,S=b(function(e,t){t.__esModule=!0;a(n);var o=a(r),i=a(C);a(F);function a(e){return e&&e.__esModule?e:{default:e}}function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function l(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var c=1073741823;t.default=function(e,t){var r,a,$="__create-react-context-"+(0,i.default)()+"__",f=function(e){function r(){var t,n,o,i;u(this,r);for(var a=arguments.length,l=Array(a),c=0;c<a;c++)l[c]=arguments[c];return t=n=s(this,e.call.apply(e,[this].concat(l))),n.emitter=(o=n.props.value,i=[],{on:function(e){i.push(e)},off:function(e){i=i.filter(function(t){return t!==e})},get:function(){return o},set:function(e,t){o=e,i.forEach(function(e){return e(o,t)})}}),s(n,t)}return l(r,e),r.prototype.getChildContext=function(){var e;return(e={})[$]=this.emitter,e},r.prototype.componentWillReceiveProps=function(e){if(this.props.value!==e.value){var r=this.props.value,n=e.value,o=void 0;((i=r)===(a=n)?0!==i||1/i===1/a:i!==i&&a!==a)?o=0:(o="function"===typeof t?t(r,n):c,0!==(o|=0)&&this.emitter.set(e.value,o))}var i,a},r.prototype.render=function(){return this.props.children},r}(n.Component);f.childContextTypes=((r={})[$]=o.default.object.isRequired,r);var d=function(t){function r(){var e,n;u(this,r);for(var o=arguments.length,i=Array(o),a=0;a<o;a++)i[a]=arguments[a];return e=n=s(this,t.call.apply(t,[this].concat(i))),n.state={value:n.getValue()},n.onUpdate=function(e,t){0!==((0|n.observedBits)&t)&&n.setState({value:n.getValue()})},s(n,e)}return l(r,t),r.prototype.componentWillReceiveProps=function(e){var t=e.observedBits;this.observedBits=void 0===t||null===t?c:t},r.prototype.componentDidMount=function(){this.context[$]&&this.context[$].on(this.onUpdate);var e=this.props.observedBits;this.observedBits=void 0===e||null===e?c:e},r.prototype.componentWillUnmount=function(){this.context[$]&&this.context[$].off(this.onUpdate)},r.prototype.getValue=function(){return this.context[$]?this.context[$].get():e},r.prototype.render=function(){return(e=this.props.children,Array.isArray(e)?e[0]:e)(this.state.value);var e},r}(n.Component);return d.contextTypes=((a={})[$]=o.default.object,a),{Provider:f,Consumer:d}},e.exports=t.default});y(S);var O=y(b(function(e,t){t.__esModule=!0;var r=i(n),o=i(S);function i(e){return e&&e.__esModule?e:{default:e}}t.default=r.default.createContext||o.default,e.exports=t.default})),E=O({}),k=function(){},j=Object.getPrototypeOf({}),x=/\s*(?:\]\s*\.|\]\s*\[|\.|\[|\])\s*/g,_=T(window)?global:window;function T(e){return"undefined"===typeof e}function D(e){return"function"===typeof e}function A(e){return T(e)||null===e||e+""===""}function R(e){return!!e&&D(e.then)}function N(e){return!!function(e){return"[object Object]"===Object.prototype.toString.call(e)}(e)&&(null===Object.getPrototypeOf(e)||!!D(e.constructor)&&e.constructor.prototype===j)}function M(e){if(e&&"object"===typeof e){if(Array.isArray(e)){for(var t=[],r=0,n=e.length;r<n;r++)t[r]=M(e[r]);return t}if(N(e)){var o={};for(var i in e)o[i]=M(e[i]);return o}}return e}var U=function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return D(e)&&e.apply(void 0,r),r[0]};function I(e){return function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return D(r[0])?e.apply(void 0,r):function(t){return e(t,r[0])}}}var H=["minlength","maxlength","max","min","required","pattern","step"];var L,B,z=function(e){try{return new Function("origin","global","return typeof ".concat(e," === 'number' || (typeof ").concat(e," !== 'undefined' && !(origin in global)) ? ").concat(e," : origin"))(e,_)}catch(t){return e}},Y=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var n=t[0],o=t[1],i=t[2];k("string"===typeof o,"The second parameter(".concat(JSON.stringify(o),") of parsePath() must be a string."));var a=(o.match(x)||[]).map(function(e){return e.replace(/\s/g,"")}),u=o.split(x).map(function(e){return e.trim()}).filter(function(e){return""!==e}),s=n;try{if(t.length<3)for(var l=0,c=u.length;l<c;l++){var $=z(u[l]);if(l+1===c)return s[$];if(T(s[$]))break;s=s[$]}else for(var f=0,d=u.length;f<d;f++){var p=z(u[f]),h=u[f+1],m=a[f];if(T(h)){s[p]=i;break}switch(m){case"].":case".":s=T(s[p])?s[p]={}:s[p];break;case"][":case"[":var v=z(h);s=T(s[p])?s[p]="number"===typeof v&&v>=0?[]:{}:s[p];break;default:s[p]=i}}}catch(e){k(!1,"The name '%s' of Field seems is not a legal expression.",o)}if(t.length>2)return n},q=function(e,t){for(var r=0,n=e.length;r<n;r++)if(!0===t(e[r]))return e[r]},Q=function(e,t){return Object.keys(e).reduce(function(r,n){return r[n]=t(e[n],n,e),r},{})},G=function(e,t){return Object.keys(e).forEach(function(r){return t(e[r],r,e)})},W=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return e.reduce(function(){return t.apply(void 0,arguments),arguments.length<=0?void 0:arguments[0]},r)},K=function(e,t){T(Y(e,t))||(Y(e,t,void 0),function e(t,r,n){G(t,function(r,n){void 0===r?delete t[n]:r&&"object"===typeof r&&e(r,n,t)}),n&&Object.keys(t).every(function(e){return void 0===t[e]})&&(n[r]=void 0,e(n))}(e))},J="FORM_VALIDATE_RESULT";"function"===typeof requestAnimationFrame?(L=requestAnimationFrame,B=cancelAnimationFrame):(L=setTimeout,B=clearTimeout);var X=function(e){function r(e){var t;return s(this,r),(t=p(this,h(r).call(this,e))).$$formPending=void 0,t.$$formValidatePromise=void 0,t.$$registers={},t.$$deepRegisters={},t.$$regDuplications={},t.$$duplicateTimer=void 0,t.$$checkDuplication=function(){var e,r=d(t).$$regDuplications;G(r,function(t,n){var o=u(t,2),i=o[0],a=o[1];k(i.$$reserved,"The Field with a name '".concat(n,"' has been registered!")),a.$$reset(i.$getState()),e=delete r[n]}),e&&t.$render()},t.$$register=function(e,r,n){if(t.$$unregister(n,r),e){var o=t.$$getRegister(e);o?(B(t.$$duplicateTimer),t.$$regDuplications[e]=[o,r],t.$$duplicateTimer=L(t.$$checkDuplication)):(t.$$fieldChangedQueue.push({name:e,$newValue:r.$getState().$value}),K(t.$$defaultValues,e)),t.$$registers[r.$name=e]=r,t.createDeepRegisters(),t.$render()}},t.$$unregister=function(e,r,n){if(e){if(e in t.$$regDuplications){var o=u(t.$$regDuplications[e],2),i=o[0],a=o[1];t.$$fieldChangedQueue.push({name:e,$newValue:a.$getState().$value,$prevValue:i.$getState().$value}),delete t.$$regDuplications[e]}else t.$$registers[e]===r&&(n?r.$$reserved=!0:(delete t.$$registers[e],t.$$fieldChangedQueue.push({name:e,$prevValue:r.$getState().$value}),K(t.$$defaultValues,e)));t.createDeepRegisters(),t.$render()}},t.$$defaultInitialize=function(){var e=t.props,r=e.$defaultValues,n=e.$defaultStates;t.$$defaultValues=t.$$deepParseObject(M(D(r)?r(t.props)||{}:r)),t.$$defaultStates=t.$$deepParseObject(M(D(n)?n(t.props)||{}:n))},t.$$getDefault=function(){return{$$defaultStates:t.$$defaultStates,$$defaultValues:t.$$defaultValues}},t.$$triggerChangeTimer=void 0,t.$$fieldChangedQueue=[],t.$$triggerFormChange=function(){if(t.$$fieldChangedQueue.length){var e=a(t.$$fieldChangedQueue);t.$$fieldChangedQueue.length=0;var r={},n={},o=t.$$registers,i=!1;e.forEach(function(e){if(e.name in o||delete e.$newValue,e.$newValue!==e.$prevValue){if("$newValue"in e&&"$prevValue"in e){var a=t.$$getRegister(e.name);a&&a.$$triggerChange(e)}"$newValue"in e&&Y(r,e.name,e.$newValue),"$prevValue"in e&&Y(n,e.name,e.$prevValue),i=!0}}),i&&(D(t.props.$validator)&&t.$$formValidate(),D(t.props.$onFormChange)&&t.props.$onFormChange(t.$formutil,r,n))}},t.createDeepRegisters=function(){return t.$$deepRegisters=t.$$deepParseObject(t.$$registers)},t.$$getRegister=function(e){if(e){var r=t.$$registers[e]||Y(t.$$deepRegisters,e);if(r)return r}},t.$$formValidate=function(e){return t.$$formValidatePromise=new Promise(function(r){var n,o,i,a,u=(0,t.props.$validator)(t.$formutil.$params,t.formtutil),s=function(t){return r(U(e,U(i,t)))};R(u)?(t.$$formPending||(t.$$formPending=!0,t.$render()),o=function(e){return n=e(s)},a=u.then(function(){},function(e){return e}).then(function(e){return n||(t.$shouldCancelPrevAsyncValidate=null,t.$$formPending=!1,t.$$setFormErrors(e,s))})):(t.$$formPending&&(t.$$formPending=!1),a=t.$$setFormErrors(u,s)),t.$shouldCancelPrevAsyncValidate&&t.$shouldCancelPrevAsyncValidate(function(e){return i=e,a}),t.$shouldCancelPrevAsyncValidate=o})},t.$$setFormErrors=function(e,r){return e&&(e instanceof Error||"object"!==typeof e)?(k(!1,"The result of $validator in <Form /> should always return None(null,undefined) or an object contains error message of Field."),t.$render(r)):t.$$setStates(e||{},function(e,t){var r=t.$getState().$error,n=void 0===r?{}:r;return e?{$error:i({},n,o({},J,e))}:n[J]?(delete n[J],{$error:n}):void 0},r,!0)},t.$getField=function(e){var r=t.$$getRegister(e);if(k(!e||r,"$getField('".concat(e,"') fail to find the matched Field. Maybe it has been unmounted.")),k(e,"You should pass a name of the mounted Field to $getField()."),r)return r.$new()},t.$$onChange=function(e,r,n){return t.$setStates(o({},e,r),n)},t.$$setStates=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0,o=arguments.length>3?arguments[3]:void 0,i=t.$$deepParseObject(e),a=!1;return G(t.$$registers,function(n,u){var s=u in e?e[u]:Y(i,u);if(!T(s)||o){var l=r(s,n);if(l){var c=t.$formutil.$weakParams[u],$=n.$$merge(l).$value;if(n.$$detectChange(l),"$value"in l||"$viewValue"in l){var f=q(t.$$fieldChangedQueue,function(e){return e.name===u});f?("$prevValue"in f||(f.$prevValue=f.$newValue),f.$newValue=$):t.$$fieldChangedQueue.push({name:u,$newValue:$,$prevValue:c})}a=!0}}}),a?t.$render(n):Promise.resolve(U(n,t.$formutil))},t.$render=function(e){return new Promise(function(r){return t.forceUpdate(function(){return r(U(e,t.$formutil))})})},t.$validates=function(){for(var e,r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];if(D(n[n.length-1])&&(e=n.pop()),n.length){!function e(r){r.forEach(function(r){if(Array.isArray(r))e(r);else{var n=t.$getField(r);n&&n.$validate()}})}(n)}else G(t.$$registers,function(e){return e.$validate()}),D(t.props.$validator)&&t.$$formValidate();return t.$onValidates(e)},t.$onValidates=function(e){var r=Object.keys(t.$$registers).map(function(e){return t.$$registers[e].$onValidate()});return r.push(t.$$formValidatePromise),Promise.all(r).then(function(){return U(e,t.$formutil)})},t.$validate=function(e,r){var n=t.$getField(e);return n?n.$validate(r):U(r)},t.$reset=function(e,r){return t.$$defaultInitialize(),D(e)&&(r=e,e={}),t.$$setStates(e,function(e,t){return t.$$reset(e)},r,!0)},t.$setStates=function(e,r){return t.$$setStates(e,function(e){return e},r)},t.$setValues=function(e,r){return t.$$deepParseObject(M(e),t.$$defaultValues),t.$$setStates(e,function(e){return{$value:e}},r)},t.$setFocuses=function(e,r){return t.$$setStates(e,function(e){return{$focused:e}},r)},t.$setDirts=function(e,r){return t.$$setStates(e,function(e){return{$dirty:e}},r)},t.$setTouches=function(e,r){return t.$$setStates(e,function(e){return{$touched:e}},r)},t.$setPendings=function(e,r){return t.$$setStates(e,function(e){return{$pending:e}},r)},t.$setErrors=function(e,r){return t.$$setStates(e,function(e){return{$error:e}},r)},t.$batchState=function(e,r){return t.$setStates(Q(t.$$registers,function(){return e}),r)},t.$batchDirty=function(e,r){return t.$batchState({$dirty:e},r)},t.$batchTouched=function(e,r){return t.$batchState({$touched:e},r)},t.$batchFocused=function(e,r){return t.$batchState({$focused:e},r)},t.$batchPending=function(e,r){return t.$batchState({$pending:e},r)},t.$batchError=function(e,r){return t.$batchState({$error:e},r)},t.$$defaultInitialize(),t}return v(r,t.Component),c(r,[{key:"getFormContext",value:function(){return{$$registers:this.$$registers,$$register:this.$$register,$$unregister:this.$$unregister,$$onChange:this.$$onChange,$$getDefault:this.$$getDefault,$formutil:this.$formutil}}},{key:"$$deepParseObject",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return G(e,function(e,r){return Y(t,r,e)}),t}},{key:"componentDidUpdate",value:function(){var e=this;B(this.$$triggerChangeTimer),this.$$triggerChangeTimer=L(function(){e.$$triggerFormChange()})}},{key:"_render",value:function(){var e=this.$formutil,r=this.props,n=r.children,o=r.render,i=r.component;return i?t.createElement(i,{$formutil:e}):D(o)?o(e):D(n)?n(e):t.Children.map(n,function(r){return r&&D(r.type)?t.cloneElement(r,{$formutil:e}):r})}},{key:"render",value:function(){var e=this,t=this.props.$processer,r=Object.keys(this.$$registers).map(function(t){return{path:t,$state:e.$$registers[t].$getState()}}),o=W(r,function(e,r){var n=r.path,o=r.$state;t&&t(o,n),"$value"in o&&(o.$dirty||!T(o.$value))&&(e[n]=o.$value)}),a=W(r,function(e,t){var r=t.path;t.$state;return r in o&&Y(e,r,o[r])}),u=r.some(function(e){return e.$state.$invalid}),s=r.some(function(e){return e.$state.$dirty}),l=r.some(function(e){return e.$state.$touched}),c=r.some(function(e){return e.$state.$focused}),$=this.$$formPending||r.some(function(e){return e.$state.$pending}),f=this.$formutil={$$registers:i({},this.$$registers),$$deepRegisters:this.$$deepRegisters,$states:W(r,function(e,t){var r=t.path,n=t.$state;return Y(e,r,n)}),$params:i({},this.$$defaultValues,a),$errors:W(r,function(e,t){var r=t.path,n=t.$state;n.$invalid&&Y(e,r,n.$error)}),$dirts:W(r,function(e,t){var r=t.path,n=t.$state;return Y(e,r,n.$dirty)}),$touches:W(r,function(e,t){var r=t.path,n=t.$state;return Y(e,r,n.$touched)}),$focuses:W(r,function(e,t){var r=t.path,n=t.$state;return Y(e,r,n.$focused)}),$pendings:W(r,function(e,t){var r=t.path,n=t.$state;return Y(e,r,n.$pending)}),$weakStates:W(r,function(e,t){var r=t.path,n=t.$state;return e[r]=n}),$weakParams:o,$weakErrors:W(r,function(e,t){var r=t.path,n=t.$state;n.$invalid&&(e[r]=n.$error)}),$weakDirts:W(r,function(e,t){var r=t.path,n=t.$state;return e[r]=n.$dirty}),$weakTouches:W(r,function(e,t){var r=t.path,n=t.$state;return e[r]=n.$touched}),$weakFocuses:W(r,function(e,t){var r=t.path,n=t.$state;return e[r]=n.$focused}),$weakPendings:W(r,function(e,t){var r=t.path,n=t.$state;return e[r]=n.$pending}),$getFirstError:function(e){if(e){var t=f.$getField(e);return t&&t.$getFirstError()}for(var r in f.$weakErrors){var n=f.$weakErrors[r];for(var o in n)return n[o]instanceof Error?n[o].message:n[o]}},$render:this.$render,$getField:this.$getField,$onValidates:this.$onValidates,$new:function(){return e.$formutil},$setStates:this.$setStates,$setValues:this.$setValues,$setErrors:this.$setErrors,$setTouches:this.$setTouches,$setDirts:this.$setDirts,$setFocuses:this.$setFocuses,$batchState:this.$batchState,$batchTouched:this.$batchTouched,$batchDirty:this.$batchDirty,$batchFocused:this.$batchFocused,$reset:this.$reset,$validates:this.$validates,$validate:this.$validate,$valid:!u,$invalid:u,$dirty:s,$pristine:!s,$touched:l,$untouched:!l,$focused:c,$pending:$};return n.createElement(E.Provider,{value:this.getFormContext()},this._render())}}]),r}();function Z(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r,n,o={},i=Object.keys(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||(o[r]=e[r]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}X.displayName="React.Formutil.Form",X.defaultProps={$defaultValues:{},$defaultStates:{}};var ee=b(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r="function"===typeof Symbol&&Symbol.for,n=r?Symbol.for("react.element"):60103,o=r?Symbol.for("react.portal"):60106,i=r?Symbol.for("react.fragment"):60107,a=r?Symbol.for("react.strict_mode"):60108,u=r?Symbol.for("react.profiler"):60114,s=r?Symbol.for("react.provider"):60109,l=r?Symbol.for("react.context"):60110,c=r?Symbol.for("react.async_mode"):60111,$=r?Symbol.for("react.concurrent_mode"):60111,f=r?Symbol.for("react.forward_ref"):60112,d=r?Symbol.for("react.suspense"):60113,p=r?Symbol.for("react.memo"):60115,h=r?Symbol.for("react.lazy"):60116;function m(e){if("object"===typeof e&&null!==e){var t=e.$$typeof;switch(t){case n:switch(e=e.type){case c:case $:case i:case u:case a:case d:return e;default:switch(e=e&&e.$$typeof){case l:case f:case s:return e;default:return t}}case h:case p:case o:return t}}}function v(e){return m(e)===$}t.typeOf=m,t.AsyncMode=c,t.ConcurrentMode=$,t.ContextConsumer=l,t.ContextProvider=s,t.Element=n,t.ForwardRef=f,t.Fragment=i,t.Lazy=h,t.Memo=p,t.Portal=o,t.Profiler=u,t.StrictMode=a,t.Suspense=d,t.isValidElementType=function(e){return"string"===typeof e||"function"===typeof e||e===i||e===$||e===u||e===a||e===d||"object"===typeof e&&null!==e&&(e.$$typeof===h||e.$$typeof===p||e.$$typeof===s||e.$$typeof===l||e.$$typeof===f)},t.isAsyncMode=function(e){return v(e)||m(e)===c},t.isConcurrentMode=v,t.isContextConsumer=function(e){return m(e)===l},t.isContextProvider=function(e){return m(e)===s},t.isElement=function(e){return"object"===typeof e&&null!==e&&e.$$typeof===n},t.isForwardRef=function(e){return m(e)===f},t.isFragment=function(e){return m(e)===i},t.isLazy=function(e){return m(e)===h},t.isMemo=function(e){return m(e)===p},t.isPortal=function(e){return m(e)===o},t.isProfiler=function(e){return m(e)===u},t.isStrictMode=function(e){return m(e)===a},t.isSuspense=function(e){return m(e)===d}});y(ee);ee.typeOf,ee.AsyncMode,ee.ConcurrentMode,ee.ContextConsumer,ee.ContextProvider,ee.Element,ee.ForwardRef,ee.Fragment,ee.Lazy,ee.Memo,ee.Portal,ee.Profiler,ee.StrictMode,ee.Suspense,ee.isValidElementType,ee.isAsyncMode,ee.isConcurrentMode,ee.isContextConsumer,ee.isContextProvider,ee.isElement,ee.isForwardRef,ee.isFragment,ee.isLazy,ee.isMemo,ee.isPortal,ee.isProfiler,ee.isStrictMode,ee.isSuspense;var te=b(function(e){e.exports=ee}),re={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},ne={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},oe={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},ie={};function ae(e){return te.isMemo(e)?oe:ie[e.$$typeof]||re}ie[te.ForwardRef]={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0};var ue=Object.defineProperty,se=Object.getOwnPropertyNames,le=Object.getOwnPropertySymbols,ce=Object.getOwnPropertyDescriptor,$e=Object.getPrototypeOf,fe=Object.prototype;var de=function e(t,r,n){if("string"!==typeof r){if(fe){var o=$e(r);o&&o!==fe&&e(t,o,n)}var i=se(r);le&&(i=i.concat(le(r)));for(var a=ae(t),u=ae(r),s=0;s<i.length;++s){var l=i[s];if(!ne[l]&&(!n||!n[l])&&(!u||!u[l])&&(!a||!a[l])){var c=ce(r,l);try{ue(t,l,c)}catch(e){}}}return t}return t};var pe=I(function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=function(o){function a(){return s(this,a),p(this,h(a).apply(this,arguments))}return v(a,t.Component),c(a,[{key:"render",value:function(){var t=Object.assign({},this.props),o=this.props,a=(o.component,Z(o,["component"]));return["$defaultStates","$defaultValues","$onFormChange","$validator","$processer"].forEach(function(e){e in t&&("$defaultStates"!==e&&"$defaultValues"!==e||(a[e]=i({},r[e],t[e])),delete t[e])}),n.createElement(X,Object.assign({},r,a,{render:function(r){return n.createElement(e,Object.assign({},t,{$formutil:r}))}}))}}]),a}();return o.displayName="React.Formutil.withForm."+(e.displayName||e.name||"Anonymous"),de(o,e)}),he=0,me={$valid:!0,$invalid:!1,$dirty:!1,$pristine:!0,$touched:!1,$untouched:!0,$focused:!1,$pending:!1,$error:{}};function ve(e){return!0!==e}function ge(e,t,r){k(!T(e),"You should return a string or Error when the validation('".concat(r&&r+": ").concat(t,"') failed, otherwise return true."))}function ye(){return he++}function be(e,t){var r;function n(t){var r,n=e.props,o=e.$formContext;if(o.$$getDefault){var a=n.name,u=o.$$getDefault(),s=u.$$defaultStates,l=u.$$defaultValues;if(a&&l){var $=Y(l,a);r=Y(s,a)||{},T($)||(r.$value=$)}}var f=n.$defaultValue,d=n.$defaultState;return c(i({},me,D(d)?d(n):d,{$value:D(f)?f(n):"$defaultValue"in n?f:""},r,t))}function o(){return i({},e.$state)}function a(t){return r=new Promise(function(r){var n,o,a,c,$=e.props,f=e.$formContext,d=i({},$.$validators,$.$asyncValidators),p=e.$state,h=p.$value,m=p.$pending,v=Object.assign({},p.$error),g=f.$formutil,y={},b=!1;delete v[J];var w=Object.keys(d).reduce(function(t,r){if(delete v[r],!b&&null!=$[r]){var o=d[r](h,$[r],i({},$,{$formutil:g,$fieldutil:e.$fieldutil,$validError:y}));R(o)?t.push(o.catch(function(e){n||s(r,e||r)})):ve(o)&&(y[r]=o||r,ge(o,r,$.name),$.$validateLazy&&(b=!0))}return t},[]),C=function(e){return r(U(t,U(a,e)))};w.length?(m||l(!0),o=function(e){return n=e(C)},w.push(u(i({},v,y))),c=Promise.all(w).then(function(){return n||(e.$shouldCancelPrevAsyncValidate=null,l(!1,C))})):(m&&l(!1),c=u(i({},v,y),C)),e.$shouldCancelPrevAsyncValidate&&e.$shouldCancelPrevAsyncValidate(function(e){return a=e,c}),e.$shouldCancelPrevAsyncValidate=o})}function u(t,r){return e.$setState({$error:t},r)}function s(t){var r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2?arguments[2]:void 0,o=Object.assign({},e.$state.$error);return ve(r)?(o[t]=r||t,ge(r,t,e.props.name)):delete o[t],u(o,n)}function l(t,r){return e.$setState({$pending:t},r)}function c(t){var r=Object.assign({},t);"$error"in r&&(r.$error||(r.$error={}),r.$valid=0===Object.keys(r.$error).length);var n=e.props,a=n.$parser,u=n.$formatter;if("$viewValue"in r&&!("$value"in r)){r.$value=a?a(r.$viewValue,function(e){return r.$viewValue=e}):r.$viewValue}else if("$value"in r&&!("$viewValue"in r)){r.$viewValue=u?u(r.$value,function(e){return r.$value=e}):r.$value}return"$valid"in r?r.$invalid=!r.$valid:"$invalid"in r&&(r.$dirty=!r.$invalid),"$dirty"in r?r.$pristine=!r.$dirty:"$pristine"in r&&(r.$dirty=!r.$pristine),"$touched"in r?r.$untouched=!r.$touched:"$untouched"in r&&(r.$touched=!r.$untouched),e.$state=i({},e.$state,r),o()}return{$$FIELD_UUID:e.$$FIELD_UUID,$$reset:n,$$merge:c,$$detectChange:function(e){("$value"in e||"$viewValue"in e)&&a()},$$triggerChange:function(t){var r=t.$newValue,n=t.$prevValue,o=e.props.$onFieldChange;D(o)&&o(r,n,e.$formContext.$formutil)},$onValidate:function(e){return r.then(e),r},$new:function(){return e.$fieldutil},$picker:o,$getState:o,$getComponent:function(){return t},$reset:function(t,r){return e.$setState(n(t),r)},$getFirstError:function(){var t=e.$state.$error,r=void 0===t?{}:t;for(var n in r)return r[n]instanceof Error?r[n].message:r[n]},$validate:a,$setState:e.$setState,$render:function(t,r){return e.$setState({$viewValue:t,$dirty:!0},r)},$setValue:function(t,r){return e.$setState({$value:t},r)},$setTouched:function(t,r){return e.$setState({$touched:t},r)},$setDirty:function(t,r){return e.$setState({$dirty:t},r)},$setFocused:function(t,r){return e.$setState({$focused:t},r)},$setValidity:s,$setError:u,$setPending:l}}var we=function(e){function r(){var e,t;s(this,r);for(var n=arguments.length,o=new Array(n),i=0;i<n;i++)o[i]=arguments[i];return(t=p(this,(e=h(r)).call.apply(e,[this].concat(o)))).$$FIELD_UUID=ye(),t.$formContext=void 0,t.$state=void 0,t.$setState=function(e,r){return new Promise(function(n){var o=function(){return n(U(r,t.$fieldutil))};if(t.isMounting){var i=t.props.name;i in(t.$formContext.$$registers||{})?t.$formContext.$$onChange(i,e,o):(t.$registered.$$merge(e),t.$registered.$$detectChange(e),t.forceUpdate(o))}else t.$registered.$$merge(e),o()})},t}return v(r,t.Component),c(r,[{key:"componentDidMount",value:function(){this.isMounting=!0;var e=this.props.name,t=this.$formContext;k(!e||t.$formutil,"You should enusre that the <Field /> with the name '".concat(e,"' must be used underneath a <Form /> component or withForm() HOC, otherwise it's isolated.")),k(e,"You should assign a name to <Field />, otherwise it will be isolated!"),t.$$register&&t.$$register(e,this.$fieldHandler),this.$prevValue=this.$state.$value}},{key:"componentWillUnmount",value:function(){this.$formContext.$$unregister&&this.$formContext.$$unregister(this.props.name,this.$fieldHandler,this.props.$reserveOnUnmount),this.isMounting=!1}},{key:"componentDidUpdate",value:function(e){var t=this.props.name;t!==e.name&&this.$formContext.$$register&&this.$formContext.$$register(t,this.$fieldHandler,e.name),this.$state.$value!==this.$prevValue&&(t in(this.$formContext.$$registers||{})||this.$registered.$$triggerChange({$newValue:this.$state.$value,$prevValue:this.$prevValue}),this.$prevValue=this.$state.$value)}},{key:"_render",value:function(){return function(e,r){var n=r.children,o=r.render,i=r.component;return i?t.createElement(i,{$fieldutil:e}):D(o)?o(e):D(n)?n(e):t.Children.map(n,function(r){return r&&D(r.type)?t.cloneElement(r,{$fieldutil:e}):r})}(this.$fieldutil=i({$name:this.props.name},this.$registered.$getState(),this.$registered,{$$formutil:this.$formContext.$formutil}),this.props)}},{key:"render",value:function(){var e=this,t=!this.$formContext;return n.createElement(E.Consumer,null,function(r){return e.$formContext=r,e.$fieldHandler||(e.$fieldHandler=be(e,e)),e.$registered=(r.$$registers||{})[e.$fieldHandler.$name]||e.$fieldHandler,t&&(e.$fieldHandler.$$reset(),e.$fieldHandler.$validate()),e._render()})}}]),r}();we.displayName="React.Formutil.Field";var Ce=I(function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=function(o){function a(){return s(this,a),p(this,h(a).apply(this,arguments))}return v(a,t.Component),c(a,[{key:"render",value:function(){var t=Object.assign({},this.props),o=this.props,a=(o.component,Z(o,["component"]));return["$validators","$asyncValidators","$validateLazy","$reserveOnUnmount","$defaultValue","$defaultState","$onFieldChange","$parser","$formatter","name"].concat(Object.keys(i({},r.$validators,r.$asyncValidators,t.$validators,t.$asyncValidators))).forEach(function(e){e in t&&("$validators"!==e&&"$asyncValidators"!==e&&"$defaultState"!==e||(a[e]=i({},r[e],t[e])),delete t[e])}),n.createElement(we,Object.assign({},r,a,{render:function(r){return n.createElement(e,Object.assign({},t,{$fieldutil:r}))}}))}}]),a}();return o.displayName="React.Formutil.withField."+(e.displayName||e.name||"Anonymous"),de(o,e)}),Pe=function(e){function r(){return s(this,r),p(this,h(r).apply(this,arguments))}return v(r,t.Component),c(r,[{key:"render",value:function(){var e=this,t=this.props,r=(t.$fieldutil,t.value),o=t.onChange,i=t.onFocus,a=t.onBlur,u=t.checked,s=t.unchecked,l=Z(t,["$fieldutil","value","onChange","onFocus","onBlur","checked","unchecked"]),c=this.props.type,$={value:"compositionValue"in this?this.compositionValue:r,onCompositionEnd:function(t){e.composition=!1,delete e.compositionValue,$.onChange(t)},onCompositionStart:function(){return e.composition=!0},onChange:function(t){var r=t.target.value;e.composition?(e.compositionValue=r,e.forceUpdate()):o(r,t)},onFocus:i,onBlur:a},f="input";switch(c){case"select":f=c,$.onChange=function(e){var t=e.target,r=t.multiple?[].slice.call(t.options).filter(function(e){return e.selected}).map(function(e){return e.value}):t.value;o(r,e)},delete l.type;break;case"textarea":f=c,delete l.type;break;case"checkbox":case"radio":$={checked:r===u,onChange:function(e){o(e.target.checked?u:s,e)},onFocus:i,onBlur:a}}return n.createElement(f,Object.assign({},l,$))}}]),r}();Pe.displayName="React.Formutil.EasyField.Native",Pe.defaultProps={value:"",type:"text",checked:!0,unchecked:!1};var Ve=O({}),Fe=Ve.Provider,Se=Ve.Consumer,Oe=function(e){function r(){return s(this,r),p(this,h(r).apply(this,arguments))}return v(r,t.Component),c(r,[{key:"getGroupContext",value:function(){return this.props}},{key:"_render",value:function(){var e=this.props,r=e.className,o=e.groupNode,i=e.children,a={GroupOption:Ee,Field:ke},u=D(i)?i(a):t.Children.map(i,function(e){return t.cloneElement(e,a)});return null===o?u:n.createElement(o,{className:r},u)}},{key:"render",value:function(){return n.createElement(Fe,{value:this.getGroupContext()},this._render())}}]),r}();Oe.displayName="React.Formutil.EasyField.Group",Oe.defaultProps={type:"checkbox",groupNode:"div"};var Ee=function(e){function r(){return s(this,r),p(this,h(r).apply(this,arguments))}return v(r,t.Component),c(r,[{key:"componentDidMount",value:function(){k("$value"in this.props,"You should pass a $value to <GroupOption />.")}},{key:"render",value:function(){var e=this.props,t=e.$value,r=e.onChange,o=e.onFocus,i=e.onBlur,a=Z(e,["$value","onChange","onFocus","onBlur"]);return n.createElement(Se,null,function(e){var u=e.type,s=e.name,l="radio"===u?{checked:e.value===t,onChange:function(n){e.onChange(t,n),r&&r(n)}}:"checkbox"===u?{checked:e.value.indexOf(t)>-1,onChange:function(n){e.onChange(n.target.checked?e.value.concat(t):e.value.filter(function(e){return e!==t}),n),r&&r(n)}}:{value:e.value,onChange:function(t){e.onChange(t),r&&r(t)}};return n.createElement("input",Object.assign({name:s},a,l,{type:u,onFocus:function(t){e.onFocus(t),o&&o(t)},onBlur:function(t){e.onBlur(t),i&&i(t)}}))})}}]),r}();Ee.displayName="React.Formutil.EasyField.Group.Option";var ke=function(e){function r(){return s(this,r),p(this,h(r).apply(this,arguments))}return v(r,t.Component),c(r,[{key:"componentDidMount",value:function(){k(!1,'The "Field" property in EasyField\'s children-props has been deprecated. Please use "GroupOption" instead.')}},{key:"render",value:function(){return n.createElement(Ee,this.props)}}]),r}();ke.displayName="React.Formutil.EasyField.Group.Option.Deprecated";var je=Array.isArray,xe=Object.keys,_e=Object.prototype.hasOwnProperty,Te="undefined"!==typeof Element;var De=function(e,t){try{return function e(t,r){if(t===r)return!0;if(t&&r&&"object"==typeof t&&"object"==typeof r){var n,o,i,a=je(t),u=je(r);if(a&&u){if((o=t.length)!=r.length)return!1;for(n=o;0!==n--;)if(!e(t[n],r[n]))return!1;return!0}if(a!=u)return!1;var s=t instanceof Date,l=r instanceof Date;if(s!=l)return!1;if(s&&l)return t.getTime()==r.getTime();var c=t instanceof RegExp,$=r instanceof RegExp;if(c!=$)return!1;if(c&&$)return t.toString()==r.toString();var f=xe(t);if((o=f.length)!==xe(r).length)return!1;for(n=o;0!==n--;)if(!_e.call(r,f[n]))return!1;if(Te&&t instanceof Element&&r instanceof Element)return t===r;for(n=o;0!==n--;)if(("_owner"!==(i=f[n])||!t.$$typeof)&&!e(t[i],r[i]))return!1;return!0}return t!==t&&r!==r}(e,t)}catch(e){if(e.message&&e.message.match(/stack|recursion/i)||-2146828260===e.number)return console.warn("Warning: react-fast-compare does not handle circular references.",e.name,e.message),!1;throw e}},Ae=n.Frament||"div",Re=function(e){function r(e){var t;return s(this,r),(t=p(this,h(r).call(this,e))).id=0,t.latestValue=t.props.value,t.$formutil=void 0,t.FieldValidators={required:function(e){return null!==e}},t.$onFormChange=function(e){e.$onValidates(function(e){var r=e.$invalid,n=e.$params;r?t.props.value.length&&t.props.onChange(t.latestValue=[]):De(t.props.value,n.list)||t.props.onChange(t.latestValue=n.list)})},t.swap=function(e,r,n){return t.$setState(function(t){var n=t.items,o=[n[e],n[r]];return n[r]=o[0],n[e]=o[1],n},n)},t.insert=function(){for(var e,r,n,o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return i.forEach(function(t){D(t)?n=t:"number"===typeof t?e=t:"object"===typeof t&&(r=t)}),t.$setState(function(n){var o=n.items;return T(e)?o.push(t.getId(r)):o.splice(e,0,t.getId(r)),{items:o}},n)},t.remove=function(){for(var e,r,n=arguments.length,o=new Array(n),i=0;i<n;i++)o[i]=arguments[i];return o.forEach(function(t){D(t)?r=t:"number"===typeof t&&(e=t)}),t.$setState(function(r){var n=r.items;return T(e)?n.pop():n.splice(e,1),n.length||(n=[t.getId()]),{items:n}},r)},t.$setState=function(e,r){return new Promise(function(n){return t.setState(e,function(){return t.$formutil.$onValidates(function(e){return n(U(r,e))})})})},t.state={items:e.value.length?e.value.map(function(){return t.getId()}):[t.getId()],formKey:0},t}return v(r,t.Component),c(r,[{key:"componentDidUpdate",value:function(e){var t=this;this.props.value!==this.latestValue&&(this.setState({items:this.props.value.length?this.props.value.map(function(){return t.getId()}):[this.getId()],formKey:this.state.formKey+1}),this.latestValue=this.props.value)}},{key:"getId",value:function(e){return{id:this.id++,values:e}}},{key:"render",value:function(){var e=this,t=this.props,r=t.children,o=t.onFocus,a=t.onBlur,u=t.value;if(!D(r))return null;var s={$length:this.state.items.length,$insert:this.insert,$remove:this.remove,$swap:this.swap,$push:function(t,r){return e.insert(t,r)},$pop:function(t){return e.remove(t)},$shift:function(t){return e.remove(0,t)},$unshift:function(t,r){return e.insert(0,t,r)},onFocus:o,onBlur:a};return n.createElement(X,{key:this.state.formKey,$defaultValues:{list:u},$onFormChange:this.$onFormChange,children:function(t){return e.$formutil=t,n.createElement(Ae,null,e.state.items.map(function(o,a){var u=o.id,l=o.values;return n.createElement(we,{key:u,required:!0,$defaultValue:l||null,$validators:e.FieldValidators,name:"list[".concat(a,"]"),children:function(o){return n.createElement(X,{$defaultValues:o.$value||{},$onFormChange:function(e){return e.$onValidates(function(e){var t=e.$invalid,r=e.$params;t?null!==o.$viewValue&&o.$render(null):De(o.$viewValue,r)||o.$render(r)})},children:function(n){return r(i({},s,n,{$index:a,$isLast:function(){return a===e.state.items.length-1},$isFirst:function(){return 0===a}}),t)}})}})}))}})}}]),r}();Re.displayName="React.Formutil.EasyField.List";var Ne="__TYPE__",Me=[["required",function(e,t,r){var n=r.__TYPE__,o=r.checked;return"checked"===n?e===(void 0===o||o):!A(e)}],["maxLength",function(e,t){return A(e)||e.length<=t}],["minLength",function(e,t){return A(e)||e.length>=t}],["max",function(e,t){return A(e)||1*e<=t}],["min",function(e,t){return A(e)||1*e>=t}],["pattern",function(e,t){return A(e)||t.test(e)}],["enum",function(e,t){return A(e)||t.indexOf(e)>-1}],["checker",function(e,t,r){return t(e,r)}]].reduce(function(e,t){var r=u(t,2),n=r[0],o=r[1];return e[n]=function(e,t,r){var i=r.validMessage,a=void 0===i?{}:i;return o.apply(void 0,arguments)||a[n]||"Error input: ".concat(n)},e},{}),Ue={validMessage:{},valuePropName:"value",changePropName:"onChange",focusPropName:"onFocus",blurPropName:"onBlur",$parser:function(e){return"string"===typeof e?e.trim():e}};function Ie(e,t,r){var n,u=t.valuePropName,s=t.changePropName,l=t.focusPropName,c=t.blurPropName,$=t.passUtil,f=i({},r,(o(n={},u,e.$viewValue),o(n,s,function(){for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];var i=n[0],l=n[n.length-1];l=l&&l.target?[l]:n;var c=t[s];c&&c.apply(void 0,a(l));var $=function(e){return e&&e.target?e.target[u]:e}(i);e.$render($)}),o(n,l,function(){var r=t[l];r&&r.apply(void 0,arguments),e.$setFocused(!0)}),o(n,c,function(){var r=t[c];r&&r.apply(void 0,arguments),e.$untouched&&e.$setTouched(!0),e.$setFocused(!1)}),n));return $&&(f[!0===$?"$fieldutil":$]=e),f}function He(e){var t=e.children,r=e.component,n=e.render,o=Z(e,["children","component","render"]),a=o.name,s=o.type,l=o.defaultValue,c=(o.valuePropName,o.changePropName,o.focusPropName,o.blurPropName,o.validMessage,o.__TYPE__,o.passUtil,o.$defaultValue,o.$defaultState,o.$onFieldChange,o.$validators,o.$asyncValidators,o.$validateLazy,o.$reserveOnUnmount,o.$parser,o.$formatter,Z(o,["name","type","defaultValue","valuePropName","changePropName","focusPropName","blurPropName","validMessage","__TYPE__","passUtil","$defaultValue","$defaultState","$onFieldChange","$validators","$asyncValidators","$validateLazy","$reserveOnUnmount","$parser","$formatter"])),$={children:t,component:r,render:n},f=!T(s)||T(t)&&T(r)&&T(n);if(Object.keys(i({},o.$validators=i({},Me,o.$validators),o.$asyncValidators)).forEach(function(e){e in c&&(f&&function(e){return H.indexOf(e.toLowerCase())>-1}(e)||delete c[e])}),f){var d=u((s||"").split("."),2),p=d[0],h=void 0===p?"text":p,m=d[1];switch($.component="group"===h?Oe:"list"===h?Re:Pe,a&&(c.name=a),s&&(c.type=h),t&&(c.children=t),h){case"select":case"textarea":e.multiple&&(o[Ne]="array");break;case"group":"checkbox"===m&&(o[Ne]="array"),c.type=m;break;case"checkbox":case"radio":o[Ne]="checked";break;case"list":o[Ne]="array"}}if(!("$defaultValue"in o)&&"defaultValue"in e&&(o.$defaultValue=l),!("$defaultValue"in o)&&Ne in o){var v;switch(o[Ne]){case"checked":var g=o.unchecked;v=void 0!==g&&g;break;case"array":v=[];break;case"object":v={};break;case"number":v=0}o.$defaultValue=v}return{fieldProps:o,childProps:c,renderProps:$}}var Le=function(e){function r(){return s(this,r),p(this,h(r).apply(this,arguments))}return v(r,t.Component),c(r,[{key:"render",value:function(){var e=He(this.props),r=e.fieldProps,o=e.childProps,i=e.renderProps;return n.createElement(we,Object.assign({},r,{children:function(e){return function(e,r){var n=r.component,o=r.render,i=r.children;return n?t.createElement(n,e):D(o)?o(e):D(i)?i(e):t.Children.map(i,function(r){return t.cloneElement(r,e)})}(Ie(e,r,o),i)}}))}}]),r}();function Be(){if(!n.useState)throw new Error("Hooks api need react@>=16.8, Please upgrade your reactjs.");return(0,n.useContext)(E)}function ze(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!n.useState)throw new Error("Hooks api need react@>=16.8, Please upgrade your reactjs.");var r,o=n.useState,s=n.useLayoutEffect,l=n.useRef;e&&("string"===typeof e?(r=e,t.name=r):r=(t=e).name);var c,$=Be(),f=l({}).current,d=l([]);f.$formContext=$,f.props=t,f.$setState=function(e,t){return new Promise(function(n){var o=function(){return n(U(t,f.$fieldutil))};f.isMounting?r in($.$$registers||{})?$.$$onChange(r,e,o):(p(c.$$merge(e)),c.$$detectChange(e),d.current.push(o)):(c.$$merge(e),o())})};var p=u(o(function(){f.$$FIELD_UUID=ye(),f.$fieldHandler=c=be(f);var e=f.$fieldHandler.$$reset();return f.$fieldHandler.$validate(),e}),2)[1];return c||(c=($.$$registers||{})[f.$fieldHandler.$name]||f.$fieldHandler),s(function(){var e=f.$state;if(f.isMounting&&!(r in($.$$registers||{}))){var t=f.$prevValue;c.$$triggerChange({$newValue:e.$value,$prevValue:t})}f.$prevValue=e.$value},[f.$state.$value]),s(function(){return f.isMounting=!0,k(!r||$.$formutil,"You should enusre that the useField() with the name '".concat(r,"' must be used underneath a <Form /> component or withForm() HOC, otherwise it's isolated.")),k(r,"You should pass a name argument to useField(), otherwise it will be isolated!"),function(){$.$$unregister&&$.$$unregister(r,f.$fieldHandler,t.$reserveOnUnmount),f.isMounting=!1}},[]),s(function(){$.$$register&&$.$$register(r,f.$fieldHandler,f.$prevName),f.$prevName=r},[r]),s(function(){if(d.current.length>0){var e=a(d.current);for(d.current.length=0;e.length;)e.pop()(f.$fieldutil)}}),f.$fieldutil=i({$name:r},c.$getState(),c,{$$formutil:$.$formutil})}Le.displayName="React.Formutil.EasyField",Le.defaultProps=Ue,e.EasyField=Le,e.Field=we,e.Form=X,e.connect=function(e){var r=function(r){function o(){return s(this,o),p(this,h(o).apply(this,arguments))}return v(o,t.Component),c(o,[{key:"render",value:function(){var t=this;return n.createElement(E.Consumer,null,function(r){return n.createElement(e,Object.assign({},t.props,{$formutil:r.$formutil}))})}}]),o}();return r.displayName="React.Formutil.connect."+(e.displayName||e.name||"Anonymous"),de(r,e)},e.useField=ze,e.useForm=function(){return Be().$formutil},e.useHandler=function(e){var t=He(e=i({},Ue,e,{children:null})),r=t.fieldProps,n=t.childProps;return Ie(ze(r),r,n)},e.withField=Ce,e.withForm=pe,Object.defineProperty(e,"__esModule",{value:!0})});
