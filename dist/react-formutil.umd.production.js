(function(e,r){typeof exports==="object"&&typeof module!=="undefined"?r(exports,require("react")):typeof define==="function"&&define.amd?define(["exports","react"],r):(e=e||self,r(e.ReactFormutil={},e.React))})(this,function(e,r){"use strict";var t="default"in r?r["default"]:r;function n(e,r,t){if(r in e){Object.defineProperty(e,r,{value:t,enumerable:true,configurable:true,writable:true})}else{e[r]=t}return e}var a=n;function i(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);if(r)n=n.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable});t.push.apply(t,n)}return t}function o(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};if(r%2){i(Object(t),true).forEach(function(r){a(e,r,t[r])})}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(e,Object.getOwnPropertyDescriptors(t))}else{i(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})}}return e}var u=o;function s(e){if(Array.isArray(e)){for(var r=0,t=new Array(e.length);r<e.length;r++){t[r]=e[r]}return t}}var f=s;function l(e){if(Symbol.iterator in Object(e)||Object.prototype.toString.call(e)==="[object Arguments]")return Array.from(e)}var c=l;function $(){throw new TypeError("Invalid attempt to spread non-iterable instance")}var d=$;function v(e){return f(e)||c(e)||d()}var p=v;function h(e){if(Array.isArray(e))return e}var m=h;function g(e,r){if(!(Symbol.iterator in Object(e)||Object.prototype.toString.call(e)==="[object Arguments]")){return}var t=[];var n=true;var a=false;var i=undefined;try{for(var o=e[Symbol.iterator](),u;!(n=(u=o.next()).done);n=true){t.push(u.value);if(r&&t.length===r)break}}catch(e){a=true;i=e}finally{try{if(!n&&o["return"]!=null)o["return"]()}finally{if(a)throw i}}return t}var y=g;function b(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}var w=b;function S(e,r){return m(e)||y(e,r)||w()}var P=S;function C(e,r){if(!(e instanceof r)){throw new TypeError("Cannot call a class as a function")}}var F=C;function V(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}function O(e,r,t){if(r)V(e.prototype,r);if(t)V(e,t);return e}var k=O;function E(e,r){return r={exports:{}},e(r,r.exports),r.exports}var j=E(function(e){function r(t){"@babel/helpers - typeof";if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){e.exports=r=function e(r){return typeof r}}else{e.exports=r=function e(r){return r&&typeof Symbol==="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r}}return r(t)}e.exports=r});function x(e){if(e===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return e}var _=x;function A(e,r){if(r&&(j(r)==="object"||typeof r==="function")){return r}return _(e)}var D=A;var R=E(function(e){function r(t){e.exports=r=Object.setPrototypeOf?Object.getPrototypeOf:function e(r){return r.__proto__||Object.getPrototypeOf(r)};return r(t)}e.exports=r});var N=E(function(e){function r(t,n){e.exports=r=Object.setPrototypeOf||function e(r,t){r.__proto__=t;return r};return r(t,n)}e.exports=r});function U(e,r){if(typeof r!=="function"&&r!==null){throw new TypeError("Super expression must either be null or a function")}e.prototype=Object.create(r&&r.prototype,{constructor:{value:e,writable:true,configurable:true}});if(r)N(e,r)}var T=U;var M=r.createContext(function(){return{}});var I="function"===typeof Symbol&&Symbol.for,H=I?Symbol.for("react.element"):60103,L=I?Symbol.for("react.portal"):60106,z=I?Symbol.for("react.fragment"):60107,B=I?Symbol.for("react.strict_mode"):60108,q=I?Symbol.for("react.profiler"):60114,Q=I?Symbol.for("react.provider"):60109,G=I?Symbol.for("react.context"):60110,K=I?Symbol.for("react.async_mode"):60111,Y=I?Symbol.for("react.concurrent_mode"):60111,W=I?Symbol.for("react.forward_ref"):60112,J=I?Symbol.for("react.suspense"):60113,X=I?Symbol.for("react.suspense_list"):60120,Z=I?Symbol.for("react.memo"):60115,ee=I?Symbol.for("react.lazy"):60116,re=I?Symbol.for("react.block"):60121,te=I?Symbol.for("react.fundamental"):60117,ne=I?Symbol.for("react.responder"):60118,ae=I?Symbol.for("react.scope"):60119;function ie(e){if("object"===typeof e&&null!==e){var r=e.$$typeof;switch(r){case H:switch(e=e.type,e){case K:case Y:case z:case q:case B:case J:return e;default:switch(e=e&&e.$$typeof,e){case G:case W:case ee:case Z:case Q:return e;default:return r}}case L:return r}}}function oe(e){return ie(e)===Y}var ue=K;var se=Y;var fe=G;var le=Q;var ce=H;var $e=W;var de=z;var ve=ee;var pe=Z;var he=L;var me=q;var ge=B;var ye=J;var be=function(e){return oe(e)||ie(e)===K};var we=oe;var Se=function(e){return ie(e)===G};var Pe=function(e){return ie(e)===Q};var Ce=function(e){return"object"===typeof e&&null!==e&&e.$$typeof===H};var Fe=function(e){return ie(e)===W};var Ve=function(e){return ie(e)===z};var Oe=function(e){return ie(e)===ee};var ke=function(e){return ie(e)===Z};var Ee=function(e){return ie(e)===L};var je=function(e){return ie(e)===q};var xe=function(e){return ie(e)===B};var _e=function(e){return ie(e)===J};var Ae=function(e){return"string"===typeof e||"function"===typeof e||e===z||e===Y||e===q||e===B||e===J||e===X||"object"===typeof e&&null!==e&&(e.$$typeof===ee||e.$$typeof===Z||e.$$typeof===Q||e.$$typeof===G||e.$$typeof===W||e.$$typeof===te||e.$$typeof===ne||e.$$typeof===ae||e.$$typeof===re)};var De=ie;var Re={AsyncMode:ue,ConcurrentMode:se,ContextConsumer:fe,ContextProvider:le,Element:ce,ForwardRef:$e,Fragment:de,Lazy:ve,Memo:pe,Portal:he,Profiler:me,StrictMode:ge,Suspense:ye,isAsyncMode:be,isConcurrentMode:we,isContextConsumer:Se,isContextProvider:Pe,isElement:Ce,isForwardRef:Fe,isFragment:Ve,isLazy:Oe,isMemo:ke,isPortal:Ee,isProfiler:je,isStrictMode:xe,isSuspense:_e,isValidElementType:Ae,typeOf:De};var Ne=E(function(e){{e.exports=Re}});var Ue=Ne.isValidElementType;var Te=function(){};var Me=Te;var Ie=Object.getPrototypeOf({});var He=/\s*(?:\]\s*\.|\]\s*\[|\.|\[|\])\s*/g;var Le=ze(window)?global:window;function ze(e){return typeof e==="undefined"}function Be(e){return typeof e==="function"}function qe(e){return ze(e)||e===null||e+""===""}function Qe(e){return!!e&&Be(e.then)}function Ge(e){return Object.prototype.toString.call(e)==="[object Object]"}function Ke(e){if(!Ge(e))return false;if(null===Object.getPrototypeOf(e))return true;if(!Be(e.constructor))return false;return e.constructor.prototype===Ie}function Ye(e){return Ue(e)&&typeof e!=="string"}function We(e){if(Array.isArray(e)){var r=[];for(var t=0,n=e.length;t<n;t++){r[t]=We(e[t])}return r}else if(Ke(e)){var a={};for(var i in e){if(e.hasOwnProperty(i))a[i]=We(e[i])}return a}return e}var Je=function e(r){for(var t=arguments.length,n=new Array(t>1?t-1:0),a=1;a<t;a++){n[a-1]=arguments[a]}if(Be(r)){r.apply(void 0,n)}return n[0]};function Xe(e){return function(){for(var r=arguments.length,t=new Array(r),n=0;n<r;n++){t[n]=arguments[n]}if(Ye(t[0])){return e.apply(void 0,t)}return function(r){return e(r,t[0])}}}var Ze=["minlength","maxlength","max","min","required","pattern","step"];function er(e){return Ze.indexOf(e.toLowerCase())>-1}var rr=function e(r){try{var t=new Function("origin","global","return typeof ".concat(r," === 'number' || (typeof ").concat(r," !== 'undefined' && !(origin in global)) ? ").concat(r," : origin"));return t(r,Le)}catch(e){return r}};function tr(){for(var e=arguments.length,r=new Array(e),t=0;t<e;t++){r[t]=arguments[t]}var n=r[0],a=r[1],i=r[2];Me(typeof a==="string","The second parameter(".concat(JSON.stringify(a),") of parsePath() must be a string."));var o=(a.match(He)||[]).map(function(e){return e.replace(/\s/g,"")});var s=a.split(He).map(function(e){return e.trim()}).filter(function(e){return e!==""});var f=n;try{if(r.length<3){for(var l=0,c=s.length;l<c;l++){var $=rr(s[l]);if(l+1===c){return f[$]}if(ze(f[$])){break}f=f[$]}}else{for(var d=0,v=s.length;d<v;d++){var h=rr(s[d]);var m=s[d+1];var g=o[d];if(ze(m)){f[h]=i;break}switch(g){case"].":case".":f=f[h]=ze(f[h])?{}:u({},f[h]);break;case"][":case"[":var y=rr(m);f=f[h]=ze(f[h])?typeof y==="number"&&y>=0?[]:{}:Array.isArray(f[h])?p(f[h]):u({},f[h]);break;default:f[h]=i;break}}}}catch(e){}if(r.length>2){return n}}function nr(e,r){var t=r.split(He).map(function(e){return e.trim()}).filter(function(e){return e!==""});for(var n=0,a=t.length;n<a;n++){var i=rr(t[n]);if(!(i in e)){break}if(n+1===a){return{data:e[i]}}e=e[i]}}function ar(e,r){if(e){if(Be(e)){e(r)}else if("current"in e){e.current=r}}}var ir=function e(r,t){for(var n=0,a=r.length;n<a;n++){if(t(r[n])===true){return r[n]}}};var or=function e(r,t){return Object.keys(r).reduce(function(e,n){e[n]=t(r[n],n,r);return e},{})};var ur=function e(r,t){return Object.keys(r).forEach(function(e){return t(r[e],e,r)})};var sr=undefined;function fr(e,r,t){ur(e,function(r,t){if(r===sr){delete e[t]}else if(Ke(r)||Array.isArray(r)){fr(r,t,e)}});if(t&&Object.keys(e).every(function(r){return e[r]===sr})){t[r]=sr;fr(t)}}var lr=function e(r,t){if(!ze(tr(r,t))){tr(r,t,sr);fr(r)}};function cr(e,r){if(e===r){return true}var t=Object.keys(e);if(t.length!==Object.keys(r).length){return false}for(var n=0;n<t.length;n++){if(e[t[n]]!==r[t[n]]){return false}}return true}var $r="FORM_VALIDATE_RESULT";var dr,vr;if(typeof requestAnimationFrame==="function"){dr=requestAnimationFrame;vr=cancelAnimationFrame}else{dr=setTimeout;vr=clearTimeout}var pr=function(e){T(n,e);function n(e){var r;F(this,n);r=D(this,R(n).call(this,e));r.$$formPending=void 0;r.$$formValidatePromise=void 0;r.$$registers={};r.$$deepRegisters={};r.getFormContext=function(){return{$$registers:r.$$registers,$$register:r.$$register,$$unregister:r.$$unregister,$$onChange:r.$$onChange,$$getDefault:r.$$getDefault,$formutil:r.$formutil}};r.$$regDuplications={};r.$$duplicateTimer=void 0;r.$$checkDuplication=function(){var e=_(r),t=e.$$regDuplications;var n;ur(t,function(e,r){var a=P(e,2),i=a[0],o=a[1];Me(i.$$reserved);o.$$reset(i.$getState());n=delete t[r]});if(n){r.$render()}};r.$$register=function(e,t,n){r.$$unregister(n,t);if(e){var a=r.$$getRegister(e);if(a){vr(r.$$duplicateTimer);r.$$regDuplications[e]=[a,t];r.$$duplicateTimer=dr(r.$$checkDuplication)}else{r.$$fieldChangedQueue.push({name:e,$newValue:t.$getState().$value});lr(r.$$defaultValues,e)}r.$$registers[t.$name=e]=t;r.$$formShouldUpdateFields[e]=true;r.createDeepRegisters();r.$render()}};r.$$unregister=function(e,t,n){if(e){if(e in r.$$regDuplications){var a=P(r.$$regDuplications[e],2),i=a[0],o=a[1];r.$$fieldChangedQueue.push({name:e,$newValue:o.$getState().$value,$prevValue:i.$getState().$value});delete r.$$regDuplications[e]}else if(r.$$registers[e]===t){if(n){t.$$reserved=true}else{delete r.$$registers[e];r.$$fieldChangedQueue.push({name:e,$prevValue:t.$getState().$value});lr(r.$$defaultValues,e)}}r.$$formShouldUpdateAll=true;r.createDeepRegisters();r.$render()}};r.$$defaultInitialize=function(){var e=r.props,t=e.$defaultValues,n=e.$defaultStates;r.$$defaultValues=r.$$deepParseObject(We(Be(t)?t(r.props)||{}:t));r.$$defaultStates=r.$$deepParseObject(We(Be(n)?n(r.props)||{}:n))};r.$$getDefault=function(){return{$$defaultStates:r.$$defaultStates,$$defaultValues:r.$$defaultValues}};r.$$formShouldUpdateFields={};r.$$formShouldUpdateAll=false;r.$$triggerChangeTimer=void 0;r.$$fieldChangedQueue=[];r.$$triggerFormChange=function(){if(r.$$fieldChangedQueue.length){var e=p(r.$$fieldChangedQueue);r.$$fieldChangedQueue.length=0;var t={};var n={};var a=r.$$registers;var i=false;e.forEach(function(e){if(!(e.name in a)){delete e.$newValue}if(e.$newValue!==e.$prevValue){if("$newValue"in e&&"$prevValue"in e){var o=r.$$getRegister(e.name);if(o){o.$$triggerChange(e)}}"$newValue"in e&&tr(t,e.name,e.$newValue);"$prevValue"in e&&tr(n,e.name,e.$prevValue);i=true}});if(i){if(Be(r.props.$validator)){r.$$formValidate()}if(Be(r.props.$onFormChange)){r.props.$onFormChange(r.$formutil,t,n)}}}};r.createDeepRegisters=function(){return r.$$deepRegisters=r.$$deepParseObject(r.$$registers)};r.$$getRegister=function(e){if(e){var t=r.$$registers[e]||tr(r.$$deepRegisters,e);if(t){return t}}};r.$$formValidate=function(){return r.$$formValidatePromise=new Promise(function(e){var t=r.props.$validator;var n;var a;var i;var o;var u=t(r.$formutil.$params,r.$formutil);var s=function r(t){return e(Je(i,t))};if(Qe(u)){if(!r.$$formPending){r.$$formPending=true;r.$render()}a=function e(r){return n=r(s)};o=u.then(function(){return void 0},function(e){return e}).then(function(e){if(n){return n}r.$shouldCancelPrevAsyncValidate=null;r.$$formPending=false;return r.$$setFormErrors(e,s)})}else{if(r.$$formPending){r.$$formPending=false}o=r.$$setFormErrors(u,s)}if(r.$shouldCancelPrevAsyncValidate){r.$shouldCancelPrevAsyncValidate(function(e){i=e;return o})}r.$shouldCancelPrevAsyncValidate=a})};r.$$setFormErrors=function(e,t){if(e&&(e instanceof Error||typeof e!=="object")){return r.$render(t)}return r.$$setStates(e||{},function(e,r){var t=r.$getState(),n=t.$error,i=n===void 0?{}:n;if(e){return{$error:u({},i,a({},$r,e))}}if(i[$r]){delete i[$r];return{$error:i}}},t,true)};r.$getField=function(e){var t=r.$$getRegister(e);if(t){var n;return(n=t.$new)===null||n===void 0?void 0:n.call(t)}};r.$$onChange=function(e,t,n){return r.$setStates(a({},e,t),n)};r.$$setStates=function(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var t=arguments.length>1?arguments[1]:undefined;var n=arguments.length>2?arguments[2]:undefined;var a=arguments.length>3?arguments[3]:undefined;var i=r.$$deepParseObject(e);ur(r.$$registers,function(e,n){var o=nr(i,n);if(a||o){var u=t(o&&o.data,e);if(u){var s=r.$formutil.$weakParams[n];var f=e.$$merge(u),l=f.$value;e.$$detectChange(u);if("$value"in u||"$viewValue"in u){var c=ir(r.$$fieldChangedQueue,function(e){return e.name===n});if(c){if(!("$prevValue"in c)){c.$prevValue=c.$newValue}c.$newValue=l}else{r.$$fieldChangedQueue.push({name:n,$newValue:l,$prevValue:s})}}r.$$formShouldUpdateFields[n]=true}}});return r.$render(n)};r.$render=function(e){return new Promise(function(t){return r.forceUpdate(function(){return t(Je(e,r.$formutil))})})};r.$validates=function(){var e;for(var t=arguments.length,n=new Array(t),a=0;a<t;a++){n[a]=arguments[a]}if(Be(n[n.length-1])){e=n.pop()}if(n.length){var i=function e(t){t.forEach(function(t){if(Array.isArray(t)){e(t)}else{var n=r.$getField(t);if(n){n.$validate()}}})};i(n)}else{ur(r.$$registers,function(e){return e.$validate()});if(Be(r.props.$validator)){r.$$formValidate()}}return r.$onValidates(e)};r.$onValidates=function(e){var t=Object.keys(r.$$registers).map(function(e){return r.$$registers[e].$onValidate()});t.push(r.$$formValidatePromise);return Promise.all(t).then(function(){return Je(e,r.$formutil)})};r.$validate=function(e,t){var n=r.$getField(e);if(n){return n.$validate(t)}return Je(t)};r.$reset=function(e,t){r.$$defaultInitialize();if(Be(e)){t=e;e={}}return r.$$setStates(e,function(e,r){return r.$$reset(e)},t,true)};r.$setStates=function(e,t){return r.$$setStates(e,function(e){return e},t)};r.$setValues=function(e,t){r.$$deepParseObject(We(e),r.$$defaultValues);fr(r.$$defaultValues);return r.$$setStates(e,function(e){return{$value:e}},t)};r.$setFocuses=function(e,t){return r.$$setStates(e,function(e){return{$focused:e}},t)};r.$setDirts=function(e,t){return r.$$setStates(e,function(e){return{$dirty:e}},t)};r.$setTouches=function(e,t){return r.$$setStates(e,function(e){return{$touched:e}},t)};r.$setPendings=function(e,t){return r.$$setStates(e,function(e){return{$pending:e}},t)};r.$setErrors=function(e,t){return r.$$setStates(e,function(e){return{$error:e}},t)};r.$batchState=function(e,t){return r.$setStates(or(r.$$registers,function(){return e}),t)};r.$batchDirty=function(e,t){return r.$batchState({$dirty:e},t)};r.$batchTouched=function(e,t){return r.$batchState({$touched:e},t)};r.$batchFocused=function(e,t){return r.$batchState({$focused:e},t)};r.$batchPending=function(e,t){return r.$batchState({$pending:e},t)};r.$batchError=function(e,t){return r.$batchState({$error:e},t)};r.$getFirstError=function(e){var t=r.$formutil;if(e){var n=t.$getField(e);return n&&n.$getFirstError()}for(var a in t.$weakErrors){if(t.$weakErrors.hasOwnProperty(a)){var i=t.$weakErrors[a];for(var o in i){if(i.hasOwnProperty(o)){return i[o]instanceof Error?i[o].message:i[o]}}}}};r.$new=function(){return r.$formutil};r.$$defaultInitialize();return r}k(n,[{key:"$$deepParseObject",value:function e(r){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};ur(r,function(e,r){return tr(t,r,e)});return t}},{key:"$$resetFormUpdateFields",value:function e(){this.$$formShouldUpdateFields={};this.$$formShouldUpdateAll=false}},{key:"componentDidMount",value:function e(){ar(this.props.$ref,this.$formutil)}},{key:"componentDidUpdate",value:function e(r){var t=this;ar(this.props.$ref,this.$formutil);vr(this.$$triggerChangeTimer);this.$$triggerChangeTimer=dr(function(){t.$$triggerFormChange()})}},{key:"componentWillUnmount",value:function e(){ar(this.props.$ref,null)}},{key:"_render",value:function e(){var t=this.$formutil;var n=this.props,a=n.children,i=n.render,o=n.component;if(o){return r.createElement(o,{$formutil:t})}if(Be(i)){return i(t)}if(Be(a)){return a(t)}return r.Children.map(a,function(e){return e&&Ye(e.type)?r.cloneElement(e,{$formutil:t}):e})}},{key:"render",value:function e(){var r=this;var n=this.props.$processer;var a=Object.keys(this.$$registers).map(function(e){return{path:e,$state:r.$$registers[e].$getState()}});var i=this.$$formShouldUpdateAll;var o=this.$formutil||{};var s=a.some(function(e){var r=e.$state;return r.$invalid});var f=a.some(function(e){var r=e.$state;return r.$dirty});var l=a.some(function(e){var r=e.$state;return r.$touched});var c=a.some(function(e){var r=e.$state;return r.$focused});var $=this.$$formPending||a.some(function(e){var r=e.$state;return r.$pending});var d=i?{}:u({},o.$pureParams);var v=i?{}:u({},o.$states);var p=i?{}:u({},o.$errors);var h=i?{}:u({},o.$dirts);var m=i?{}:u({},o.$touches);var g=i?{}:u({},o.$focuses);var y=i?{}:u({},o.$pendings);var b=i?{}:u({},o.$weakStates);var w=i?{}:u({},o.$weakParams);var S=i?{}:u({},o.$weakErrors);var P=i?{}:u({},o.$weakDirts);var C=i?{}:u({},o.$weakFocuses);var F=i?{}:u({},o.$weakTouches);var V=i?{}:u({},o.$weakPendings);for(var O=0,k=a.length;O<k;O++){var E=a[O],j=E.$state,x=E.path;if(!i){if(!this.$$formShouldUpdateFields[x]){continue}}if(n){n(j,x)}if(x in w&&j.$pristine&&ze(j.$value)){delete w[x];lr(d,x)}else if(w[x]!==j.$value){w[x]=j.$value;tr(d,x,j.$value)}tr(v,x,j);b[x]=j;if(S[x]!==j.$error){if(j.$invalid){tr(p,x,j.$error);S[x]=j.$error}else if(x in S){lr(p,x);delete S[x]}}if(P[x]!==j.$dirty){tr(h,x,j.$dirty);P[x]=j.$dirty}if(F[x]!==j.$touched){tr(m,x,j.$touched);F[x]=j.$touched}if(C[x]!==j.$focused){tr(g,x,j.$focused);C[x]=j.$focused}if(V[x]!==j.$pending){tr(y,x,j.$pending);V[x]=j.$pending}}this.$formutil={$$registers:u({},this.$$registers),$$deepRegisters:this.$$deepRegisters,$states:v,$pureParams:d,$params:u({},this.$$defaultValues,{},d),$errors:p,$dirts:h,$touches:m,$focuses:g,$pendings:y,$weakStates:b,$weakParams:w,$weakErrors:S,$weakDirts:P,$weakTouches:F,$weakFocuses:C,$weakPendings:V,$getFirstError:this.$getFirstError,$render:this.$render,$getField:this.$getField,$onValidates:this.$onValidates,$new:this.$new,$setStates:this.$setStates,$setValues:this.$setValues,$setErrors:this.$setErrors,$setTouches:this.$setTouches,$setDirts:this.$setDirts,$setFocuses:this.$setFocuses,$setPendings:this.$setPendings,$batchState:this.$batchState,$batchTouched:this.$batchTouched,$batchDirty:this.$batchDirty,$batchFocused:this.$batchFocused,$batchPending:this.$batchPending,$reset:this.$reset,$validates:this.$validates,$validate:this.$validate,$valid:!s,$invalid:s,$dirty:f,$pristine:!f,$touched:l,$untouched:!l,$focused:c,$pending:$};this.$$resetFormUpdateFields();return t.createElement(M.Provider,{value:this.getFormContext},this._render())}}]);return n}(r.Component);pr.displayName="React.Formutil.Form";pr.defaultProps={$defaultValues:{},$defaultStates:{}};function hr(e,r){if(e==null)return{};var t={};var n=Object.keys(e);var a,i;for(i=0;i<n.length;i++){a=n[i];if(r.indexOf(a)>=0)continue;t[a]=e[a]}return t}var mr=hr;function gr(e,r){if(e==null)return{};var t=mr(e,r);var n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++){n=i[a];if(r.indexOf(n)>=0)continue;if(!Object.prototype.propertyIsEnumerable.call(e,n))continue;t[n]=e[n]}}return t}var yr=gr;var br={childContextTypes:true,contextType:true,contextTypes:true,defaultProps:true,displayName:true,getDefaultProps:true,getDerivedStateFromError:true,getDerivedStateFromProps:true,mixins:true,propTypes:true,type:true};var wr={name:true,length:true,prototype:true,caller:true,callee:true,arguments:true,arity:true};var Sr={$$typeof:true,render:true,defaultProps:true,displayName:true,propTypes:true};var Pr={$$typeof:true,compare:true,defaultProps:true,displayName:true,propTypes:true,type:true};var Cr={};Cr[Ne.ForwardRef]=Sr;Cr[Ne.Memo]=Pr;function Fr(e){if(Ne.isMemo(e)){return Pr}return Cr[e["$$typeof"]]||br}var Vr=Object.defineProperty;var Or=Object.getOwnPropertyNames;var kr=Object.getOwnPropertySymbols;var Er=Object.getOwnPropertyDescriptor;var jr=Object.getPrototypeOf;var xr=Object.prototype;function _r(e,r,t){if(typeof r!=="string"){if(xr){var n=jr(r);if(n&&n!==xr){_r(e,n,t)}}var a=Or(r);if(kr){a=a.concat(kr(r))}var i=Fr(e);var o=Fr(r);for(var u=0;u<a.length;++u){var s=a[u];if(!wr[s]&&!(t&&t[s])&&!(o&&o[s])&&!(i&&i[s])){var f=Er(r,s);try{Vr(e,s,f)}catch(e){}}}}return e}var Ar=_r;var Dr=["render","component","children","$defaultValues","$defaultStates","$onFormChange","$validator","$processer","$ref"];function Rr(e){var n=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};var a=function(r){T(a,r);function a(){var r;var n;F(this,a);for(var i=arguments.length,o=new Array(i),u=0;u<i;u++){o[u]=arguments[u]}n=D(this,(r=R(a)).call.apply(r,[this].concat(o)));n.renderChildren=function(r){return t.createElement(e,Object.assign({},n.othersProps,{$formutil:r,ref:n.props.__forwardRef__}))};return n}k(a,[{key:"render",value:function e(){var r=Object.assign({},this.props);var a=this.props,i=a.component,o=yr(a,["component"]);Dr.forEach(function(e){if(e in r){if(e==="$defaultStates"||e==="$defaultValues"){o[e]=u({},n[e],{},r[e])}delete r[e]}});this.othersProps=r;return t.createElement(pr,Object.assign({},n,o,{render:this.renderChildren}))}}]);return a}(r.Component);a.displayName="React.Formutil.withForm."+(e.displayName||e.name||"Anonymous");var i=r.forwardRef(function(e,r){return t.createElement(a,Object.assign({__forwardRef__:r},e))});i.displayName="React.Formutil.withForm.ForwardRef."+(e.displayName||e.name||"Anonymous");return Ar(i,e)}var Nr=Xe(Rr);var Ur=0;var Tr={$valid:true,$invalid:false,$dirty:false,$pristine:true,$touched:false,$untouched:true,$focused:false,$pending:false,$error:{}};function Mr(e){return e!==true}function Ir(e,r,t){}var Hr="React.Formutil.Field";function Lr(){return Ur++}function zr(e,t){var n=t.children,a=t.render,i=t.component;if(i){return r.createElement(i,{$fieldutil:e})}if(Be(a)){return a(e)}if(Be(n)){return n(e)}return r.Children.map(n,function(t){return t&&Ye(t.type)?r.cloneElement(t,{$fieldutil:e}):t})}function Br(e,r){var t={$$FIELD_UUID:e.$$FIELD_UUID,$$reset:s,$$merge:b,$$detectChange:a,$$triggerChange:i,$onValidate:o,$new:function r(){return e.$fieldutil},$picker:f,$getState:f,$getComponent:function e(){return r},$reset:function r(t,n){return e.$setState(s(t),n)},$getFirstError:y,$validate:l,$setState:e.$setState,$render:c,$setValue:$,$setTouched:d,$setDirty:v,$setFocused:p,$setValidity:m,$setError:h,$setPending:g};var n;function a(e){if("$value"in e||"$viewValue"in e){l()}}function i(r){var t=r.$newValue,n=r.$prevValue;var a=e.props.$onFieldChange;if(Be(a)){a(t,n,e.$formContext.$formutil)}}function o(e){n.then(e);return n}function s(r){var t;var n=e.props,a=e.$formContext;if(a.$$getDefault){var i=n.name;var o=a.$$getDefault(),s=o.$$defaultStates,f=o.$$defaultValues;if(i&&f){var l=tr(f,i);t=tr(s,i)||{};if(!ze(l)){t.$value=l}}}var c=n.$defaultValue,$=n.$defaultState;return b(u({},Tr,{},Be($)?$(n):$,{$value:Be(c)?c(n):"$defaultValue"in n?c:""},t,{},r))}function f(){return u({},e.$state)}function l(r){return n=new Promise(function(t){var n=e.props,a=e.$formContext;var i=u({},n.$validators,{},n.$asyncValidators);var o=e.$state,s=o.$value,f=o.$pending,l=Object.assign({},o.$error);var c=a.$formutil;var $={};var d=false;var v;var p;var y;var b;delete l[$r];var w=Object.keys(i).reduce(function(r,t){delete l[t];if(!d&&n[t]!=null){var a=i[t](s,n[t],u({},n,{$formutil:c,$fieldutil:e.$fieldutil,$validError:$}));if(Qe(a)){r.push(a["catch"](function(e){if(!v){m(t,e||t)}}))}else if(Mr(a)){$[t]=a||t;Ir(a,t,n.name);if(n.$validateLazy){d=true}}}return r},[]);var S=function e(n){return t(Je(r,Je(y,n)))};if(w.length){if(!f){g(true)}p=function e(r){return v=r(S)};w.push(h(u({},l,{},$)));b=Promise.all(w).then(function(){if(v){return v}e.$shouldCancelPrevAsyncValidate=null;return g(false,S)})}else{if(f){g(false)}b=h(u({},l,{},$),S)}if(e.$shouldCancelPrevAsyncValidate){e.$shouldCancelPrevAsyncValidate(function(e){y=e;return b})}e.$shouldCancelPrevAsyncValidate=p})}function c(r,t){return e.$setState({$viewValue:r,$dirty:true},t)}function $(r,t){return e.$setState({$value:r},t)}function d(r,t){return e.$setState({$touched:r},t)}function v(r,t){return e.$setState({$dirty:r},t)}function p(r,t){return e.$setState({$focused:r},t)}function h(r,t){return e.$setState({$error:r},t)}function m(r){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:true;var n=arguments.length>2?arguments[2]:undefined;var a=Object.assign({},e.$state.$error);if(Mr(t)){a[r]=t||r;Ir(t,r,e.props.name)}else{delete a[r]}return h(a,n)}function g(r,t){return e.$setState({$pending:r},t)}function y(){var r=e.$state.$error,t=r===void 0?{}:r;for(var n in t){if(t.hasOwnProperty(n)){return t[n]instanceof Error?t[n].message:t[n]}}}function b(r){var t=Object.assign({},r);if("$error"in t){if(!t.$error){t.$error={}}t.$valid=Object.keys(t.$error).length===0}var n=e.props,a=n.$parser,i=n.$formatter;if("$viewValue"in t&&!("$value"in t)){var o=function e(r){return t.$viewValue=r};t.$value=a?a(t.$viewValue,o):t.$viewValue}else if("$value"in t&&!("$viewValue"in t)){var s=function e(r){return t.$value=r};t.$viewValue=i?i(t.$value,s):t.$value}if("$valid"in t){t.$invalid=!t.$valid}else if("$invalid"in t){t.$dirty=!t.$invalid}if("$dirty"in t){t.$pristine=!t.$dirty}else if("$pristine"in t){t.$dirty=!t.$pristine}if("$touched"in t){t.$untouched=!t.$touched}else if("$untouched"in t){t.$touched=!t.$untouched}e.$state=u({},e.$state,{},t);return f()}return t}var qr=typeof Element!=="undefined";var Qr=typeof Map==="function";var Gr=typeof Set==="function";var Kr=typeof ArrayBuffer==="function";function Yr(e,r){if(e===r)return true;if(e&&r&&typeof e=="object"&&typeof r=="object"){if(e.constructor!==r.constructor)return false;var t,n,a;if(Array.isArray(e)){t=e.length;if(t!=r.length)return false;for(n=t;n--!==0;)if(!Yr(e[n],r[n]))return false;return true}var i;if(Qr&&e instanceof Map&&r instanceof Map){if(e.size!==r.size)return false;i=e.entries();while(!(n=i.next()).done)if(!r.has(n.value[0]))return false;i=e.entries();while(!(n=i.next()).done)if(!Yr(n.value[1],r.get(n.value[0])))return false;return true}if(Gr&&e instanceof Set&&r instanceof Set){if(e.size!==r.size)return false;i=e.entries();while(!(n=i.next()).done)if(!r.has(n.value[0]))return false;return true}if(Kr&&ArrayBuffer.isView(e)&&ArrayBuffer.isView(r)){t=e.length;if(t!=r.length)return false;for(n=t;n--!==0;)if(e[n]!==r[n])return false;return true}if(e.constructor===RegExp)return e.source===r.source&&e.flags===r.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===r.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===r.toString();a=Object.keys(e);t=a.length;if(t!==Object.keys(r).length)return false;for(n=t;n--!==0;)if(!Object.prototype.hasOwnProperty.call(r,a[n]))return false;if(qr&&e instanceof Element)return false;for(n=t;n--!==0;){if(a[n]==="_owner"&&e.$$typeof){continue}if(!Yr(e[a[n]],r[a[n]]))return false}return true}return e!==e&&r!==r}var Wr=function e(r,t){try{return Yr(r,t)}catch(e){if((e.message||"").match(/stack|recursion/i)){console.warn("react-fast-compare cannot handle circular refs");return false}throw e}};var Jr=function(e){T(r,e);function r(){var e;var t;F(this,r);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++){a[i]=arguments[i]}t=D(this,(e=R(r)).call.apply(e,[this].concat(a)));t.$$FIELD_UUID=Lr();t.$formContext=void 0;t.$state=void 0;t.shouldRendered=false;t.$setState=function(e,r){return new Promise(function(n){var a=function e(){return n(Je(r,t.$fieldutil))};if(t.isMounting){var i=t.props.name;if(i in(t.$formContext.$$registers||{})){t.shouldRendered=false;t.$formContext.$$onChange(i,e,a);if(!t.shouldRendered){t.forceUpdate()}}else{t.$registered.$$merge(e);t.$registered.$$detectChange(e);t.forceUpdate(a)}}else{t.$registered.$$merge(e);a()}})};return t}k(r,[{key:"componentDidMount",value:function e(){this.isMounting=true;var r=this.props.name,t=this.$formContext;Me(!r||t.$formutil);if(t.$$register){t.$$register(r,this.$fieldHandler)}this.$prevState=this.$state;ar(this.props.$ref,this.$fieldutil)}},{key:"componentWillUnmount",value:function e(){if(this.$formContext.$$unregister){this.$formContext.$$unregister(this.props.name,this.$fieldHandler,this.props.$reserveOnUnmount)}this.isMounting=false;ar(this.props.$ref,null)}},{key:"componentDidUpdate",value:function e(r){var t=this.props.name;if(t!==r.name){if(this.$formContext.$$register){this.$formContext.$$register(t,this.$fieldHandler,r.name)}}ar(this.props.$ref,this.$fieldutil);if(this.$state.$value!==this.$prevState.$value){if(!(t in(this.$formContext.$$registers||{}))){this.$registered.$$triggerChange({$newValue:this.$state.$value,$prevValue:this.$prevState.$value})}}this.$prevState=this.$state}},{key:"shouldComponentUpdate",value:function e(r){var t=r.$memo;return!t||!cr(this.$registered.$getState(),this.$prevState)||!(Array.isArray(t)?Wr(t,this.props.$memo):Wr(this.props,r))}},{key:"_render",value:function e(){var r=this.$fieldutil=u({$name:this.props.name},this.$registered.$getState(),{},this.$registered,{$$formutil:this.$formContext.$formutil});return zr(r,this.props)}},{key:"render",value:function e(){var r=this;this.shouldRendered=true;return t.createElement(M.Consumer,null,function(e){var t=!r.$formContext;r.$formContext=e();if(!r.$fieldHandler){r.$fieldHandler=Br(r,r)}r.$registered=(r.$formContext.$$registers||{})[r.$fieldHandler.$name]||r.$fieldHandler;if(t){r.$fieldHandler.$$reset();r.$fieldHandler.$validate()}return r._render()})}}]);return r}(r.Component);Jr.displayName=Hr;var Xr=["name","$defaultValue","$defaultState","$onFieldChange","$validators","$asyncValidators","$validateLazy","$memo","$reserveOnUnmount","$ref","$parser","$formatter","render","component","children"];function Zr(e){var n=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};var a=function(r){T(a,r);function a(){var r;var n;F(this,a);for(var i=arguments.length,o=new Array(i),u=0;u<i;u++){o[u]=arguments[u]}n=D(this,(r=R(a)).call.apply(r,[this].concat(o)));n.renderChildren=function(r){return t.createElement(e,Object.assign({},n.othersProps,{$fieldutil:r,ref:n.props.__forwardRef__}))};return n}k(a,[{key:"render",value:function e(){var r=Object.assign({},this.props);var a=this.props,i=a.component,o=yr(a,["component"]);Xr.concat(Object.keys(u({},n.$validators,{},n.$asyncValidators,{},r.$validators,{},r.$asyncValidators))).forEach(function(e){if(e in r){if(e==="$validators"||e==="$asyncValidators"||e==="$defaultState"){o[e]=u({},n[e],{},r[e])}delete r[e]}});this.othersProps=r;return t.createElement(Jr,Object.assign({},n,o,{render:this.renderChildren}))}}]);return a}(r.Component);a.displayName="React.Formutil.withField."+(e.displayName||e.name||"Anonymous");var i=r.forwardRef(function(e,r){return t.createElement(a,Object.assign({__forwardRef__:r},e))});i.displayName="React.Formutil.withField.ForwardRef."+(e.displayName||e.name||"Anonymous");return Ar(i,e)}var et=Xe(Zr);var rt=function(e){T(r,e);function r(){F(this,r);return D(this,R(r).apply(this,arguments))}k(r,[{key:"render",value:function e(){var r=this;var n=this.props,a=n.$fieldutil,i=n.value,o=n.onChange,u=n.onFocus,s=n.onBlur,f=n.checked,l=n.unchecked,c=yr(n,["$fieldutil","value","onChange","onFocus","onBlur","checked","unchecked"]);var $=this.props.type;var d={value:"compositionValue"in this?this.compositionValue:i,onCompositionEnd:function e(t){r.composition=false;delete r.compositionValue;d.onChange(t)},onCompositionStart:function e(){return r.composition=true},onChange:function e(t){var n=t.target.value;if(r.composition){r.compositionValue=n;r.forceUpdate()}else{o(n,t)}},onFocus:u,onBlur:s};var v="input";switch($){case"select":v=$;d.onChange=function(e){var r=e.target;var t=r.multiple?[].slice.call(r.options).filter(function(e){return e.selected}).map(function(e){return e.value}):r.value;o(t,e)};delete c.type;break;case"textarea":v=$;delete c.type;break;case"checkbox":case"radio":d={checked:i===f,onChange:function e(r){o(r.target.checked?f:l,r)},onFocus:u,onBlur:s};break}return t.createElement(v,Object.assign({},c,d))}}]);return r}(r.Component);rt.displayName="React.Formutil.EasyField.Native";rt.defaultProps={value:"",type:"text",checked:true,unchecked:false};var tt=r.createContext(function(){return{}}),nt=tt.Provider,at=tt.Consumer;var it=function(e){T(n,e);function n(){var e;var r;F(this,n);for(var t=arguments.length,a=new Array(t),i=0;i<t;i++){a[i]=arguments[i]}r=D(this,(e=R(n)).call.apply(e,[this].concat(a)));r.getGroupContext=function(){return r.props};return r}k(n,[{key:"_render",value:function e(){var n=this.props,a=n.className,i=n.groupNode,o=n.children;var u={GroupOption:ot,Field:ut};var s=Be(o)?o(u):r.Children.map(o,function(e){return r.cloneElement(e,u)});if(i===null){return s}return t.createElement(i,{className:a},s)}},{key:"render",value:function e(){return t.createElement(nt,{value:this.getGroupContext},this._render())}}]);return n}(r.Component);it.displayName="React.Formutil.EasyField.Group";it.defaultProps={type:"checkbox",groupNode:"div"};var ot=function(e){T(r,e);function r(){F(this,r);return D(this,R(r).apply(this,arguments))}k(r,[{key:"componentDidMount",value:function e(){Me("$value"in this.props)}},{key:"render",value:function e(){var r=this.props,n=r.$value,a=r.onChange,i=r.onFocus,o=r.onBlur,u=yr(r,["$value","onChange","onFocus","onBlur"]);return t.createElement(at,null,function(e){var r=e();var s=r.type,f=r.name;var l=s==="radio"?{checked:r.value===n,onChange:function e(t){r.onChange(n,t);a&&a(t)}}:s==="checkbox"?{checked:r.value.indexOf(n)>-1,onChange:function e(t){r.onChange(t.target.checked?r.value.concat(n):r.value.filter(function(e){return e!==n}),t);a&&a(t)}}:{value:r.value,onChange:function e(t){r.onChange(t);a&&a(t)}};return t.createElement("input",Object.assign({name:f},u,l,{type:s,onFocus:function e(t){r.onFocus(t);i&&i(t)},onBlur:function e(t){r.onBlur(t);o&&o(t)}}))})}}]);return r}(r.Component);ot.displayName="React.Formutil.EasyField.Group.Option";var ut=function(e){T(r,e);function r(){F(this,r);return D(this,R(r).apply(this,arguments))}k(r,[{key:"componentDidMount",value:function e(){}},{key:"render",value:function e(){return t.createElement(ot,this.props)}}]);return r}(r.Component);ut.displayName="React.Formutil.EasyField.Group.Option.Deprecated";var st=t.Frament||"div";var ft=function(e){T(r,e);function r(e){var t;F(this,r);t=D(this,R(r).call(this,e));t.id=0;t.latestValue=t.props.value;t.$formutil=void 0;t.FieldValidators={required:function e(r){return r!==null}};t.$onFormChange=function(e){e.$onValidates(function(e){var r=e.$invalid,n=e.$params;if(r){if(t.props.value.length){t.props.onChange(t.latestValue=[])}}else if(!Wr(t.props.value,n.list)){t.props.onChange(t.latestValue=n.list)}})};t.swap=function(e,r,n){return t.$setState(function(t){var n=t.items;var a=[n[e],n[r]];n[r]=a[0];n[e]=a[1];return n},n)};t.insert=function(){var e,r,n;for(var a=arguments.length,i=new Array(a),o=0;o<a;o++){i[o]=arguments[o]}i.forEach(function(t){if(Be(t)){n=t}else if(typeof t==="number"){e=t}else if(typeof t==="object"){r=t}});return t.$setState(function(n){var a=n.items;if(ze(e)){a.push(t.getId(r))}else{a.splice(e,0,t.getId(r))}return{items:a}},n)};t.remove=function(){var e,r;for(var n=arguments.length,a=new Array(n),i=0;i<n;i++){a[i]=arguments[i]}a.forEach(function(t){if(Be(t)){r=t}else if(typeof t==="number"){e=t}});return t.$setState(function(r){var n=r.items;if(ze(e)){n.pop()}else{n.splice(e,1)}if(!n.length){n=[t.getId()]}return{items:n}},r)};t.$setState=function(e,r){return new Promise(function(n){return t.setState(e,function(){return t.$formutil.$onValidates(function(e){return n(Je(r,e))})})})};t.state={items:e.value.length?e.value.map(function(){return t.getId()}):[t.getId()],formKey:0};return t}k(r,[{key:"componentDidUpdate",value:function e(r){var t=this;if(this.props.value!==this.latestValue){this.setState({items:this.props.value.length?this.props.value.map(function(){return t.getId()}):[this.getId()],formKey:this.state.formKey+1});this.latestValue=this.props.value}}},{key:"getId",value:function e(r){return{id:this.id++,values:r}}},{key:"render",value:function e(){var r=this;var n=this.props,a=n.children,i=n.onFocus,o=n.onBlur,s=n.value;var f=this;if(!Be(a)){return null}var l={$insert:this.insert,$remove:this.remove,$swap:this.swap,$push:function e(t,n){return r.insert(t,n)},$pop:function e(t){return r.remove(t)},$shift:function e(t){return r.remove(0,t)},$unshift:function e(t,n){return r.insert(0,t,n)},onFocus:i,onBlur:o};return t.createElement(pr,{key:this.state.formKey,$defaultValues:{list:s},$onFormChange:this.$onFormChange,children:function e(n){r.$formutil=n;return t.createElement(st,null,r.state.items.map(function(e,i){var o=e.id,s=e.values;return t.createElement(Jr,{key:o,required:true,$defaultValue:s||null,$validators:r.FieldValidators,name:"list[".concat(i,"]"),children:function e(o){return t.createElement(pr,{$defaultValues:o.$value||{},$onFormChange:function e(r){return r.$onValidates(function(e){var r=e.$invalid,t=e.$params;if(r){if(o.$viewValue!==null){o.$render(null)}}else if(!Wr(o.$viewValue,t)){o.$render(t)}})},children:function e(t){return a(u({get $length(){return f.state.items.length},$index:i,$isLast:function e(){return i===r.state.items.length-1},$isFirst:function e(){return i===0}},l,{},t),n)}})}})}))}})}}]);return r}(r.Component);ft.displayName="React.Formutil.EasyField.List";var lt="__TYPE__";var ct=[["required",function(e,r,t){var n=t.__TYPE__,a=t.checked,i=a===void 0?true:a;return n==="checked"?e===i:!qe(e)}],["maxLength",function(e,r,t){return t.required&&qe(e)||e.length<=r}],["minLength",function(e,r,t){return t.required&&qe(e)||e.length>=r}],["max",function(e,r,t){return t.required&&qe(e)||e*1<=r}],["min",function(e,r,t){return t.required&&qe(e)||e*1>=r}],["pattern",function(e,r,t){return t.required&&qe(e)||r.test(e)}],["enum",function(e,r,t){return t.required&&qe(e)||r.indexOf(e)>-1}],["checker",function(e,r,t){return r(e,t)}]].reduce(function(e,r){var t=P(r,2),n=t[0],a=t[1];e[n]=function e(r,t,i){var o=i.validMessage,u=o===void 0?{}:o;return a.apply(void 0,arguments)||u[n]||"Error input: ".concat(n)};return e},{});var $t="React.Formutil.EasyField";var dt={validMessage:{},valuePropName:"value",changePropName:"onChange",focusPropName:"onFocus",blurPropName:"onBlur",$parser:function e(r){return typeof r==="string"?r.trim():r}};function vt(e,r,t){var n;var i=r.valuePropName,o=r.changePropName,s=r.focusPropName,f=r.blurPropName,l=r.getValueFromEvent,c=r.passUtil;var $=function e(r){return r&&r.target?r.target[i]:r};var d=u({},t,(n={},a(n,i,e.$viewValue),a(n,o,function(t){var n;for(var a=arguments.length,i=new Array(a>1?a-1:0),u=1;u<a;u++){i[u-1]=arguments[u]}if(((n=i[0])===null||n===void 0?void 0:n.nativeEvent)instanceof Event){i.push(t)}else{i.unshift(t)}var s=r[o];s&&s.apply(void 0,i);var f=l?l.apply(void 0,i):$(t);e.$render(f)}),a(n,s,function(){var t=r[s];t&&t.apply(void 0,arguments);e.$setFocused(true)}),a(n,f,function(){var t=r[f];t&&t.apply(void 0,arguments);if(e.$untouched){e.$setTouched(true)}e.$setFocused(false)}),n));if(c){d[c===true?"$fieldutil":String(c)]=e}return d}function pt(e){var r=e.children,t=e.component,n=e.render,a=yr(e,["children","component","render"]);var i=a.name,o=a.type,s=a.defaultValue,f=a.valuePropName,l=a.changePropName,c=a.focusPropName,$=a.blurPropName,d=a.getValueFromEvent,v=a.validMessage,p=a.checked,h=a.unchecked,m=a.__TYPE__,g=a.__DIFF__,y=a.passUtil,b=a.$defaultValue,w=a.$defaultState,S=a.$onFieldChange,C=a.$validators,F=a.$asyncValidators,V=a.$validateLazy,O=a.$memo,k=a.$reserveOnUnmount,E=a.$parser,j=a.$formatter,x=a.$ref,_=yr(a,["name","type","defaultValue","valuePropName","changePropName","focusPropName","blurPropName","getValueFromEvent","validMessage","checked","unchecked","__TYPE__","__DIFF__","passUtil","$defaultValue","$defaultState","$onFieldChange","$validators","$asyncValidators","$validateLazy","$memo","$reserveOnUnmount","$parser","$formatter","$ref"]);var A={children:r,component:t,render:n};if(O===true&&ze(g)){a.__DIFF__=[r,t,n]}var D=!ze(o)||ze(r)&&ze(t)&&ze(n);Object.keys(u({},a.$validators=u({},ct,{},a.$validators),{},a.$asyncValidators)).forEach(function(e){if(e in _){if(!D||!er(e)){delete _[e]}}});if(D){var R=(o||"").split("."),N=P(R,2),U=N[0],T=U===void 0?"text":U,M=N[1];A.component=T==="group"?it:T==="list"?ft:rt;if(i){_.name=i}if(o){_.type=T}if(r){_.children=r}_.checked=p;_.unchecked=h;switch(T){case"select":case"textarea":if(e.multiple){a[lt]="array"}break;case"group":if(M==="checkbox"){a[lt]="array"}_.type=M;break;case"checkbox":case"radio":a[lt]="checked";break;case"list":a[lt]="array";break}}if(!("$defaultValue"in a)&&"defaultValue"in e){a.$defaultValue=s}if(!("$defaultValue"in a)&&lt in a){var I;switch(a[lt]){case"checked":var H=a.unchecked,L=H===void 0?false:H;I=L;break;case"array":I=[];break;case"object":I={};break;case"number":I=0;break}a.$defaultValue=I}return{fieldProps:a,childProps:_,renderProps:A}}function ht(e,t){var n=t.component,a=t.render,i=t.children;if(n){return r.createElement(n,e)}if(Be(a)){return a(e)}if(Be(i)){return i(e)}return r.Children.map(i,function(t){return r.cloneElement(t,e)})}var mt=function(e){T(r,e);function r(){var e;var t;F(this,r);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++){a[i]=arguments[i]}t=D(this,(e=R(r)).call.apply(e,[this].concat(a)));t.renderChildren=function(e){var r=t.parsedProps,n=r.fieldProps,a=r.childProps,i=r.renderProps;return ht(vt(e,n,a),i)};t.parsedProps={};return t}k(r,[{key:"render",value:function e(){var r=this.parsedProps=pt(this.props),n=r.fieldProps;return t.createElement(Jr,Object.assign({},n,{children:this.renderChildren}))}}]);return r}(r.Component);mt.displayName=$t;mt.defaultProps=dt;function gt(e){var n=r.forwardRef(function(r,n){return t.createElement(M.Consumer,null,function(a){return t.createElement(e,Object.assign({},r,{$formutil:a().$formutil,ref:n}))})});n.displayName="React.Formutil.connect."+(e.displayName||e.name||"Anonymous");return Ar(n,e)}function yt(){if(!t.useState){throw new Error("Hooks api need react@>=16.8, Please upgrade your reactjs.")}var e=t.useContext;var r=e(M);return r()}function bt(e){var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};if(!t.useState){throw new Error("Hooks api need react@>=16.8, Please upgrade your reactjs.")}var n=t.useState,a=t.useLayoutEffect,i=t.useRef;var o;if(e){if(typeof e==="string"){o=e;r.name=o}else{r=e;o=r.name}}var s=yt();var f=i({}).current;var l=i([]);var c;f.$formContext=s;f.props=r;f.$setState=h;f.shouldRendered=true;var $=n(function(){f.$$FIELD_UUID=Lr();f.$fieldHandler=c=Br(f);f.$fieldHandler.$$reset();f.$fieldHandler.$validate()}),d=P($,2),v=d[1];if(!c){c=(s.$$registers||{})[f.$fieldHandler.$name]||f.$fieldHandler}a(function(){var e=f.$state;if(f.isMounting){if(!(o in(s.$$registers||{}))){c.$$triggerChange({$newValue:e.$value,$prevValue:f.$prevState.$value})}}f.$prevState=e},[f.$state.$value]);a(function(){f.isMounting=true;Me(!o||s.$formutil);return function(){f.isMounting=false;ar(r.$ref,null)}},[]);a(function(){if(s.$$register){s.$$register(o,f.$fieldHandler)}return function(){if(s.$$unregister){s.$$unregister(o,f.$fieldHandler,!f.isMounting&&r.$reserveOnUnmount)}}},[o]);a(function(){ar(r.$ref,f.$fieldutil)});a(function(){if(l.current.length>0){var e=p(l.current);l.current.length=0;while(e.length){e.pop()(f.$fieldutil)}}});function h(e,r){return new Promise(function(t){var n=function e(){return t(Je(r,f.$fieldutil))};if(f.isMounting){if(o in(s.$$registers||{})){f.shouldRendered=false;s.$$onChange(o,e,n);if(!f.shouldRendered){v({})}}else{c.$$merge(e);c.$$detectChange(e);v({});l.current.push(n)}}else{c.$$merge(e);n()}})}return f.$fieldutil=u({$name:o},c.$getState(),{},c,{$$formutil:s.$formutil})}function wt(){var e=yt(),r=e.$formutil;return r}function St(e){e=u({},dt,{},e,{children:null});var r=pt(e),t=r.fieldProps,n=r.childProps;var a=bt(t);return vt(a,t,n)}e.EasyField=mt;e.Field=Jr;e.Form=pr;e.connect=gt;e.formContext=M;e.useField=bt;e.useForm=wt;e.useHandler=St;e.withField=et;e.withForm=Nr;Object.defineProperty(e,"__esModule",{value:true})});
