(function(e,t){typeof exports==="object"&&typeof module!=="undefined"?t(exports,require("react"),require("prop-types")):typeof define==="function"&&define.amd?define(["exports","react","prop-types"],t):(e=e||self,t(e.ReactFormutil={},e.React,e.PropTypes))})(this,function(e,t,r){"use strict";var n="default"in t?t["default"]:t;r=r&&r.hasOwnProperty("default")?r["default"]:r;function a(e,t,r){if(t in e){Object.defineProperty(e,t,{value:r,enumerable:true,configurable:true,writable:true})}else{e[t]=r}return e}function i(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);if(t)n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable});r.push.apply(r,n)}return r}function o(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};if(t%2){i(Object(r),true).forEach(function(t){a(e,t,r[t])})}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(e,Object.getOwnPropertyDescriptors(r))}else{i(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}}return e}function u(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++){r[t]=e[t]}return r}}function s(e){if(Symbol.iterator in Object(e)||Object.prototype.toString.call(e)==="[object Arguments]")return Array.from(e)}function f(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function l(e){return u(e)||s(e)||f()}function c(e){if(Array.isArray(e))return e}function $(e,t){if(!(Symbol.iterator in Object(e)||Object.prototype.toString.call(e)==="[object Arguments]")){return}var r=[];var n=true;var a=false;var i=undefined;try{for(var o=e[Symbol.iterator](),u;!(n=(u=o.next()).done);n=true){r.push(u.value);if(t&&r.length===t)break}}catch(e){a=true;i=e}finally{try{if(!n&&o["return"]!=null)o["return"]()}finally{if(a)throw i}}return r}function d(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function p(e,t){return c(e)||$(e,t)||d()}function v(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function h(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}function m(e,t,r){if(t)h(e.prototype,t);if(r)h(e,r);return e}function g(e){"@babel/helpers - typeof";if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){g=function e(t){return typeof t}}else{g=function e(t){return t&&typeof Symbol==="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t}}return g(e)}function y(e){if(e===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return e}function b(e,t){if(t&&(g(t)==="object"||typeof t==="function")){return t}return y(e)}function P(e){P=Object.setPrototypeOf?Object.getPrototypeOf:function e(t){return t.__proto__||Object.getPrototypeOf(t)};return P(e)}function S(e,t){S=Object.setPrototypeOf||function e(t,r){t.__proto__=r;return t};return S(e,t)}function w(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function")}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:true,configurable:true}});if(t)S(e,t)}var C=t.createContext(function(){return{}});function V(e,t){return t={exports:{}},e(t,t.exports),t.exports}var O="function"===typeof Symbol&&Symbol.for,k=O?Symbol.for("react.element"):60103,E=O?Symbol.for("react.portal"):60106,F=O?Symbol.for("react.fragment"):60107,j=O?Symbol.for("react.strict_mode"):60108,x=O?Symbol.for("react.profiler"):60114,D=O?Symbol.for("react.provider"):60109,A=O?Symbol.for("react.context"):60110,_=O?Symbol.for("react.async_mode"):60111,T=O?Symbol.for("react.concurrent_mode"):60111,R=O?Symbol.for("react.forward_ref"):60112,N=O?Symbol.for("react.suspense"):60113,M=O?Symbol.for("react.suspense_list"):60120,U=O?Symbol.for("react.memo"):60115,I=O?Symbol.for("react.lazy"):60116,L=O?Symbol.for("react.block"):60121,H=O?Symbol.for("react.fundamental"):60117,z=O?Symbol.for("react.responder"):60118,B=O?Symbol.for("react.scope"):60119;function q(e){if("object"===typeof e&&null!==e){var t=e.$$typeof;switch(t){case k:switch(e=e.type,e){case _:case T:case F:case x:case j:case N:return e;default:switch(e=e&&e.$$typeof,e){case A:case R:case I:case U:case D:return e;default:return t}}case E:return t}}}function Q(e){return q(e)===T}var G=_;var K=T;var Y=A;var W=D;var J=k;var X=R;var Z=F;var ee=I;var te=U;var re=E;var ne=x;var ae=j;var ie=N;var oe=function(e){return Q(e)||q(e)===_};var ue=Q;var se=function(e){return q(e)===A};var fe=function(e){return q(e)===D};var le=function(e){return"object"===typeof e&&null!==e&&e.$$typeof===k};var ce=function(e){return q(e)===R};var $e=function(e){return q(e)===F};var de=function(e){return q(e)===I};var pe=function(e){return q(e)===U};var ve=function(e){return q(e)===E};var he=function(e){return q(e)===x};var me=function(e){return q(e)===j};var ge=function(e){return q(e)===N};var ye=function(e){return"string"===typeof e||"function"===typeof e||e===F||e===T||e===x||e===j||e===N||e===M||"object"===typeof e&&null!==e&&(e.$$typeof===I||e.$$typeof===U||e.$$typeof===D||e.$$typeof===A||e.$$typeof===R||e.$$typeof===H||e.$$typeof===z||e.$$typeof===B||e.$$typeof===L)};var be=q;var Pe={AsyncMode:G,ConcurrentMode:K,ContextConsumer:Y,ContextProvider:W,Element:J,ForwardRef:X,Fragment:Z,Lazy:ee,Memo:te,Portal:re,Profiler:ne,StrictMode:ae,Suspense:ie,isAsyncMode:oe,isConcurrentMode:ue,isContextConsumer:se,isContextProvider:fe,isElement:le,isForwardRef:ce,isFragment:$e,isLazy:de,isMemo:pe,isPortal:ve,isProfiler:he,isStrictMode:me,isSuspense:ge,isValidElementType:ye,typeOf:be};var Se=V(function(e){{e.exports=Pe}});var we=Se.isValidElementType;var Ce=function(){};var Ve=Ce;var Oe=Object.getPrototypeOf({});var ke=/\s*(?:\]\s*\.|\]\s*\[|\.|\[|\])\s*/g;var Ee=Fe(window)?global:window;function Fe(e){return typeof e==="undefined"}function je(e){return typeof e==="function"}function xe(e){return Fe(e)||e===null||e+""===""}function De(e){return!!e&&je(e.then)}function Ae(e){return Object.prototype.toString.call(e)==="[object Object]"}function _e(e){if(!Ae(e))return false;if(null===Object.getPrototypeOf(e))return true;if(!je(e.constructor))return false;return e.constructor.prototype===Oe}function Te(e){return we(e)&&typeof e!=="string"}function Re(e,t,r){if(e[t]&&!Te(e[t])){return new Error("Invalid prop 'component' supplied to '".concat(r,"': the prop is not a valid React component"))}}function Ne(e){if(Array.isArray(e)){var t=[];for(var r=0,n=e.length;r<n;r++){t[r]=Ne(e[r])}return t}else if(_e(e)){var a={};for(var i in e){if(e.hasOwnProperty(i))a[i]=Ne(e[i])}return a}return e}var Me=function e(t){for(var r=arguments.length,n=new Array(r>1?r-1:0),a=1;a<r;a++){n[a-1]=arguments[a]}if(je(t)){t.apply(void 0,n)}return n[0]};function Ue(e){return function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++){r[n]=arguments[n]}if(Te(r[0])){return e.apply(void 0,r)}return function(t){return e(t,r[0])}}}var Ie=["minlength","maxlength","max","min","required","pattern","step"];function Le(e){return Ie.indexOf(e.toLowerCase())>-1}var He=function e(t){try{var r=new Function("origin","global","return typeof ".concat(t," === 'number' || (typeof ").concat(t," !== 'undefined' && !(origin in global)) ? ").concat(t," : origin"));return r(t,Ee)}catch(e){return t}};function ze(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++){t[r]=arguments[r]}var n=t[0],a=t[1],i=t[2];Ve(typeof a==="string","The second parameter(".concat(JSON.stringify(a),") of parsePath() must be a string."));var o=(a.match(ke)||[]).map(function(e){return e.replace(/\s/g,"")});var u=a.split(ke).map(function(e){return e.trim()}).filter(function(e){return e!==""});var s=n;try{if(t.length<3){for(var f=0,l=u.length;f<l;f++){var c=He(u[f]);if(f+1===l){return s[c]}if(Fe(s[c])){break}s=s[c]}}else{for(var $=0,d=u.length;$<d;$++){var p=He(u[$]);var v=u[$+1];var h=o[$];if(Fe(v)){s[p]=i;break}switch(h){case"].":case".":s=Fe(s[p])?s[p]={}:s[p];break;case"][":case"[":var m=He(v);s=Fe(s[p])?s[p]=typeof m==="number"&&m>=0?[]:{}:s[p];break;default:s[p]=i;break}}}}catch(e){}if(t.length>2){return n}}function Be(e,t){var r=t.split(ke).map(function(e){return e.trim()}).filter(function(e){return e!==""});for(var n=0,a=r.length;n<a;n++){var i=He(r[n]);if(!(i in e)){break}if(n+1===a){return{data:e[i]}}e=e[i]}}function qe(e,t){if(e){if(je(e)){e(t)}else if("current"in e){e.current=t}}}var Qe=function e(t,r){for(var n=0,a=t.length;n<a;n++){if(r(t[n])===true){return t[n]}}};var Ge=function e(t,r){return Object.keys(t).reduce(function(e,n){e[n]=r(t[n],n,t);return e},{})};var Ke=function e(t,r){return Object.keys(t).forEach(function(e){return r(t[e],e,t)})};var Ye=function e(t,r){var n=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{};return t.reduce(function(){r.apply(void 0,arguments);return arguments.length<=0?undefined:arguments[0]},n)};var We=undefined;function Je(e,t,r){Ke(e,function(t,r){if(t===We){delete e[r]}else if(_e(t)||Array.isArray(t)){Je(t,r,e)}});if(r&&Object.keys(e).every(function(t){return e[t]===We})){r[t]=We;Je(r)}}var Xe=function e(t,r){if(!Fe(ze(t,r))){ze(t,r,We);Je(t)}};var Ze="FORM_VALIDATE_RESULT";var et,tt;if(typeof requestAnimationFrame==="function"){et=requestAnimationFrame;tt=cancelAnimationFrame}else{et=setTimeout;tt=clearTimeout}var rt={render:r.func,component:Re,children:function e(t){var n=r.oneOfType([r.func,r.node]);if(!t.render&&!t.component){n=n.isRequired}for(var a=arguments.length,i=new Array(a>1?a-1:0),o=1;o<a;o++){i[o-1]=arguments[o]}return n.apply(void 0,[t].concat(i))},$defaultValues:r.oneOfType([r.object,r.func]),$defaultStates:r.oneOfType([r.object,r.func]),$onFormChange:r.func,$validator:r.func,$processer:r.func,$ref:r.oneOfType([r.func,r.shape({current:r.any})])};var nt=function(e){w(r,e);function r(e){var t;v(this,r);t=b(this,P(r).call(this,e));t.$$formPending=void 0;t.$$formValidatePromise=void 0;t.$$registers={};t.$$deepRegisters={};t.getFormContext=function(){return{$$registers:t.$$registers,$$register:t.$$register,$$unregister:t.$$unregister,$$onChange:t.$$onChange,$$getDefault:t.$$getDefault,$formutil:t.$formutil}};t.$$regDuplications={};t.$$duplicateTimer=void 0;t.$$checkDuplication=function(){var e=y(t),r=e.$$regDuplications;var n;Ke(r,function(e,t){var a=p(e,2),i=a[0],o=a[1];Ve(i.$$reserved);o.$$reset(i.$getState());n=delete r[t]});if(n){t.$render()}};t.$$register=function(e,r,n){t.$$unregister(n,r);if(e){var a=t.$$getRegister(e);if(a){tt(t.$$duplicateTimer);t.$$regDuplications[e]=[a,r];t.$$duplicateTimer=et(t.$$checkDuplication)}else{t.$$fieldChangedQueue.push({name:e,$newValue:r.$getState().$value});Xe(t.$$defaultValues,e)}t.$$registers[r.$name=e]=r;t.createDeepRegisters();t.$render()}};t.$$unregister=function(e,r,n){if(e){if(e in t.$$regDuplications){var a=p(t.$$regDuplications[e],2),i=a[0],o=a[1];t.$$fieldChangedQueue.push({name:e,$newValue:o.$getState().$value,$prevValue:i.$getState().$value});delete t.$$regDuplications[e]}else if(t.$$registers[e]===r){if(n){r.$$reserved=true}else{delete t.$$registers[e];t.$$fieldChangedQueue.push({name:e,$prevValue:r.$getState().$value});Xe(t.$$defaultValues,e)}}t.createDeepRegisters();t.$render()}};t.$$defaultInitialize=function(){var e=t.props,r=e.$defaultValues,n=e.$defaultStates;t.$$defaultValues=t.$$deepParseObject(Ne(je(r)?r(t.props)||{}:r));t.$$defaultStates=t.$$deepParseObject(Ne(je(n)?n(t.props)||{}:n))};t.$$getDefault=function(){return{$$defaultStates:t.$$defaultStates,$$defaultValues:t.$$defaultValues}};t.$$triggerChangeTimer=void 0;t.$$fieldChangedQueue=[];t.$$triggerFormChange=function(){if(t.$$fieldChangedQueue.length){var e=l(t.$$fieldChangedQueue);t.$$fieldChangedQueue.length=0;var r={};var n={};var a=t.$$registers;var i=false;e.forEach(function(e){if(!(e.name in a)){delete e.$newValue}if(e.$newValue!==e.$prevValue){if("$newValue"in e&&"$prevValue"in e){var o=t.$$getRegister(e.name);if(o){o.$$triggerChange(e)}}"$newValue"in e&&ze(r,e.name,e.$newValue);"$prevValue"in e&&ze(n,e.name,e.$prevValue);i=true}});if(i){if(je(t.props.$validator)){t.$$formValidate()}if(je(t.props.$onFormChange)){t.props.$onFormChange(t.$formutil,r,n)}}}};t.createDeepRegisters=function(){return t.$$deepRegisters=t.$$deepParseObject(t.$$registers)};t.$$getRegister=function(e){if(e){var r=t.$$registers[e]||ze(t.$$deepRegisters,e);if(r){return r}}};t.$$formValidate=function(e){return t.$$formValidatePromise=new Promise(function(r){var n=t.props.$validator;var a;var i;var o;var u;var s=n(t.$formutil.$params,t.formtutil);var f=function t(n){return r(Me(e,Me(o,n)))};if(De(s)){if(!t.$$formPending){t.$$formPending=true;t.$render()}i=function e(t){return a=t(f)};u=s.then(function(){return void 0},function(e){return e}).then(function(e){if(a){return a}t.$shouldCancelPrevAsyncValidate=null;t.$$formPending=false;return t.$$setFormErrors(e,f)})}else{if(t.$$formPending){t.$$formPending=false}u=t.$$setFormErrors(s,f)}if(t.$shouldCancelPrevAsyncValidate){t.$shouldCancelPrevAsyncValidate(function(e){o=e;return u})}t.$shouldCancelPrevAsyncValidate=i})};t.$$setFormErrors=function(e,r){if(e&&(e instanceof Error||typeof e!=="object")){return t.$render(r)}return t.$$setStates(e||{},function(e,t){var r=t.$getState(),n=r.$error,i=n===void 0?{}:n;if(e){return{$error:o({},i,a({},Ze,e))}}if(i[Ze]){delete i[Ze];return{$error:i}}return},r,true)};t.$getField=function(e){var r=t.$$getRegister(e);if(r){return r.$new()}};t.$$onChange=function(e,r,n){return t.$setStates(a({},e,r),n)};t.$$setStates=function(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var r=arguments.length>1?arguments[1]:undefined;var n=arguments.length>2?arguments[2]:undefined;var a=arguments.length>3?arguments[3]:undefined;var i=t.$$deepParseObject(e);Ke(t.$$registers,function(e,n){var o;if(a||(o=Be(i,n))){var u=r(o&&o.data,e);if(u){var s=t.$formutil.$weakParams[n];var f=e.$$merge(u),l=f.$value;e.$$detectChange(u);if("$value"in u||"$viewValue"in u){var c=Qe(t.$$fieldChangedQueue,function(e){return e.name===n});if(c){if(!("$prevValue"in c)){c.$prevValue=c.$newValue}c.$newValue=l}else{t.$$fieldChangedQueue.push({name:n,$newValue:l,$prevValue:s})}}}}});return t.$render(n)};t.$render=function(e){return new Promise(function(r){return t.forceUpdate(function(){return r(Me(e,t.$formutil))})})};t.$validates=function(){var e;for(var r=arguments.length,n=new Array(r),a=0;a<r;a++){n[a]=arguments[a]}if(je(n[n.length-1])){e=n.pop()}if(n.length){var i=function e(r){r.forEach(function(r){if(Array.isArray(r)){e(r)}else{var n=t.$getField(r);if(n){n.$validate()}}})};i(n)}else{Ke(t.$$registers,function(e){return e.$validate()});if(je(t.props.$validator)){t.$$formValidate()}}return t.$onValidates(e)};t.$onValidates=function(e){var r=Object.keys(t.$$registers).map(function(e){return t.$$registers[e].$onValidate()});r.push(t.$$formValidatePromise);return Promise.all(r).then(function(){return Me(e,t.$formutil)})};t.$validate=function(e,r){var n=t.$getField(e);if(n){return n.$validate(r)}return Me(r)};t.$reset=function(e,r){t.$$defaultInitialize();if(je(e)){r=e;e={}}return t.$$setStates(e,function(e,t){return t.$$reset(e)},r,true)};t.$setStates=function(e,r){return t.$$setStates(e,function(e){return e},r)};t.$setValues=function(e,r){t.$$deepParseObject(Ne(e),t.$$defaultValues);Je(t.$$defaultValues);return t.$$setStates(e,function(e){return{$value:e}},r)};t.$setFocuses=function(e,r){return t.$$setStates(e,function(e){return{$focused:e}},r)};t.$setDirts=function(e,r){return t.$$setStates(e,function(e){return{$dirty:e}},r)};t.$setTouches=function(e,r){return t.$$setStates(e,function(e){return{$touched:e}},r)};t.$setPendings=function(e,r){return t.$$setStates(e,function(e){return{$pending:e}},r)};t.$setErrors=function(e,r){return t.$$setStates(e,function(e){return{$error:e}},r)};t.$batchState=function(e,r){return t.$setStates(Ge(t.$$registers,function(){return e}),r)};t.$batchDirty=function(e,r){return t.$batchState({$dirty:e},r)};t.$batchTouched=function(e,r){return t.$batchState({$touched:e},r)};t.$batchFocused=function(e,r){return t.$batchState({$focused:e},r)};t.$batchPending=function(e,r){return t.$batchState({$pending:e},r)};t.$batchError=function(e,r){return t.$batchState({$error:e},r)};t.$$defaultInitialize();return t}m(r,[{key:"$$deepParseObject",value:function e(t){var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};Ke(t,function(e,t){return ze(r,t,e)});return r}},{key:"componentDidMount",value:function e(){qe(this.props.$ref,this.$formutil)}},{key:"componentDidUpdate",value:function e(t){var r=this;qe(this.props.$ref,this.$formutil);tt(this.$$triggerChangeTimer);this.$$triggerChangeTimer=et(function(){r.$$triggerFormChange()})}},{key:"componentWillUnmount",value:function e(){qe(this.props.$ref,null)}},{key:"_render",value:function e(){var r=this.$formutil;var n=this.props,a=n.children,i=n.render,o=n.component;if(o){return t.createElement(o,{$formutil:r})}if(je(i)){return i(r)}if(je(a)){return a(r)}return t.Children.map(a,function(e){return e&&Te(e.type)?t.cloneElement(e,{$formutil:r}):e})}},{key:"render",value:function e(){var t=this;var r=this.props.$processer;var a=Object.keys(this.$$registers).map(function(e){return{path:e,$state:t.$$registers[e].$getState()}});var i=Ye(a,function(e,t){var n=t.path,a=t.$state;if(r){r(a,n)}if("$value"in a&&(a.$dirty||!Fe(a.$value))){e[n]=a.$value}});var u=Ye(a,function(e,t){var r=t.path,n=t.$state;return r in i&&ze(e,r,i[r])});var s=a.some(function(e){var t=e.$state;return t.$invalid});var f=a.some(function(e){var t=e.$state;return t.$dirty});var l=a.some(function(e){var t=e.$state;return t.$touched});var c=a.some(function(e){var t=e.$state;return t.$focused});var $=this.$$formPending||a.some(function(e){var t=e.$state;return t.$pending});var d=this.$formutil={$$registers:o({},this.$$registers),$$deepRegisters:this.$$deepRegisters,$states:Ye(a,function(e,t){var r=t.path,n=t.$state;return ze(e,r,n)}),$params:o({},this.$$defaultValues,{},u),$errors:Ye(a,function(e,t){var r=t.path,n=t.$state;if(n.$invalid){ze(e,r,n.$error)}}),$dirts:Ye(a,function(e,t){var r=t.path,n=t.$state;return ze(e,r,n.$dirty)}),$touches:Ye(a,function(e,t){var r=t.path,n=t.$state;return ze(e,r,n.$touched)}),$focuses:Ye(a,function(e,t){var r=t.path,n=t.$state;return ze(e,r,n.$focused)}),$pendings:Ye(a,function(e,t){var r=t.path,n=t.$state;return ze(e,r,n.$pending)}),$weakStates:Ye(a,function(e,t){var r=t.path,n=t.$state;return e[r]=n}),$weakParams:i,$weakErrors:Ye(a,function(e,t){var r=t.path,n=t.$state;if(n.$invalid){e[r]=n.$error}}),$weakDirts:Ye(a,function(e,t){var r=t.path,n=t.$state;return e[r]=n.$dirty}),$weakTouches:Ye(a,function(e,t){var r=t.path,n=t.$state;return e[r]=n.$touched}),$weakFocuses:Ye(a,function(e,t){var r=t.path,n=t.$state;return e[r]=n.$focused}),$weakPendings:Ye(a,function(e,t){var r=t.path,n=t.$state;return e[r]=n.$pending}),$getFirstError:function e(t){if(t){var r=d.$getField(t);return r&&r.$getFirstError()}for(var n in d.$weakErrors){if(d.$weakErrors.hasOwnProperty(n)){var a=d.$weakErrors[n];for(var i in a){if(a.hasOwnProperty(i)){return a[i]instanceof Error?a[i].message:a[i]}}}}},$render:this.$render,$getField:this.$getField,$onValidates:this.$onValidates,$new:function e(){return t.$formutil},$setStates:this.$setStates,$setValues:this.$setValues,$setErrors:this.$setErrors,$setTouches:this.$setTouches,$setDirts:this.$setDirts,$setFocuses:this.$setFocuses,$batchState:this.$batchState,$batchTouched:this.$batchTouched,$batchDirty:this.$batchDirty,$batchFocused:this.$batchFocused,$reset:this.$reset,$validates:this.$validates,$validate:this.$validate,$valid:!s,$invalid:s,$dirty:f,$pristine:!f,$touched:l,$untouched:!l,$focused:c,$pending:$};return n.createElement(C.Provider,{value:this.getFormContext},this._render())}}]);return r}(t.Component);nt.displayName="React.Formutil.Form";nt.defaultProps={$defaultValues:{},$defaultStates:{}};function at(e,t){if(e==null)return{};var r={};var n=Object.keys(e);var a,i;for(i=0;i<n.length;i++){a=n[i];if(t.indexOf(a)>=0)continue;r[a]=e[a]}return r}function it(e,t){if(e==null)return{};var r=at(e,t);var n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++){n=i[a];if(t.indexOf(n)>=0)continue;if(!Object.prototype.propertyIsEnumerable.call(e,n))continue;r[n]=e[n]}}return r}var ot={childContextTypes:true,contextType:true,contextTypes:true,defaultProps:true,displayName:true,getDefaultProps:true,getDerivedStateFromError:true,getDerivedStateFromProps:true,mixins:true,propTypes:true,type:true};var ut={name:true,length:true,prototype:true,caller:true,callee:true,arguments:true,arity:true};var st={$$typeof:true,render:true,defaultProps:true,displayName:true,propTypes:true};var ft={$$typeof:true,compare:true,defaultProps:true,displayName:true,propTypes:true,type:true};var lt={};lt[Se.ForwardRef]=st;lt[Se.Memo]=ft;function ct(e){if(Se.isMemo(e)){return ft}return lt[e["$$typeof"]]||ot}var $t=Object.defineProperty;var dt=Object.getOwnPropertyNames;var pt=Object.getOwnPropertySymbols;var vt=Object.getOwnPropertyDescriptor;var ht=Object.getPrototypeOf;var mt=Object.prototype;function gt(e,t,r){if(typeof t!=="string"){if(mt){var n=ht(t);if(n&&n!==mt){gt(e,n,r)}}var a=dt(t);if(pt){a=a.concat(pt(t))}var i=ct(e);var o=ct(t);for(var u=0;u<a.length;++u){var s=a[u];if(!ut[s]&&!(r&&r[s])&&!(o&&o[s])&&!(i&&i[s])){var f=vt(t,s);try{$t(e,s,f)}catch(e){}}}}return e}var yt=gt;var bt=Object.keys(rt);function Pt(e){var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};var a=t.forwardRef(function(t,a){var i=Object.assign({},t);var u=t.component,s=it(t,["component"]);bt.forEach(function(e){if(e in i){if(e==="$defaultStates"||e==="$defaultValues"){s[e]=o({},r[e],{},i[e])}delete i[e]}});return n.createElement(nt,Object.assign({},r,s,{render:function t(r){return n.createElement(e,Object.assign({},i,{$formutil:r,ref:a}))}}))});a.displayName="React.Formutil.withForm."+(e.displayName||e.name||"Anonymous");return yt(a,e)}var St=Ue(Pt);var wt=0;var Ct={$valid:true,$invalid:false,$dirty:false,$pristine:true,$touched:false,$untouched:true,$focused:false,$pending:false,$error:{}};function Vt(e){return e!==true}function Ot(e,t,r){}var kt=undefined;var Et="React.Formutil.Field";function Ft(){return wt++}function jt(e,r){var n=r.children,a=r.render,i=r.component;if(i){return t.createElement(i,{$fieldutil:e})}if(je(a)){return a(e)}if(je(n)){return n(e)}return t.Children.map(n,function(r){return r&&Te(r.type)?t.cloneElement(r,{$fieldutil:e}):r})}function xt(e,t){var r={$$FIELD_UUID:e.$$FIELD_UUID,$$reset:s,$$merge:b,$$detectChange:a,$$triggerChange:i,$onValidate:u,$new:function t(){return e.$fieldutil},$picker:f,$getState:f,$getComponent:function e(){return t},$reset:function t(r,n){return e.$setState(s(r),n)},$getFirstError:y,$validate:l,$setState:e.$setState,$render:c,$setValue:$,$setTouched:d,$setDirty:p,$setFocused:v,$setValidity:m,$setError:h,$setPending:g};var n;function a(e){if("$value"in e||"$viewValue"in e){l()}}function i(t){var r=t.$newValue,n=t.$prevValue;var a=e.props.$onFieldChange;if(je(a)){a(r,n,e.$formContext.$formutil)}}function u(e){n.then(e);return n}function s(t){var r;var n=e.props,a=e.$formContext;if(a.$$getDefault){var i=n.name;var u=a.$$getDefault(),s=u.$$defaultStates,f=u.$$defaultValues;if(i&&f){var l=ze(f,i);r=ze(s,i)||{};if(!Fe(l)){r.$value=l}}}var c=n.$defaultValue,$=n.$defaultState;return b(o({},Ct,{},je($)?$(n):$,{$value:je(c)?c(n):"$defaultValue"in n?c:""},r,{},t))}function f(){return o({},e.$state)}function l(t){return n=new Promise(function(r){var n=e.props,a=e.$formContext;var i=o({},n.$validators,{},n.$asyncValidators);var u=e.$state,s=u.$value,f=u.$pending,l=Object.assign({},u.$error);var c=a.$formutil;var $={};var d=false;var p;var v;var y;var b;delete l[Ze];var P=Object.keys(i).reduce(function(t,r){delete l[r];if(!d&&n[r]!=null){var a=i[r](s,n[r],o({},n,{$formutil:c,$fieldutil:e.$fieldutil,$validError:$}));if(De(a)){t.push(a["catch"](function(e){if(!p){m(r,e||r)}}))}else if(Vt(a)){$[r]=a||r;Ot(a,r,n.name);if(n.$validateLazy){d=true}}}return t},[]);var S=function e(n){return r(Me(t,Me(y,n)))};if(P.length){if(!f){g(true)}v=function e(t){return p=t(S)};P.push(h(o({},l,{},$)));b=Promise.all(P).then(function(){if(p){return p}e.$shouldCancelPrevAsyncValidate=null;return g(false,S)})}else{if(f){g(false)}b=h(o({},l,{},$),S)}if(e.$shouldCancelPrevAsyncValidate){e.$shouldCancelPrevAsyncValidate(function(e){y=e;return b})}e.$shouldCancelPrevAsyncValidate=v})}function c(t,r){return e.$setState({$viewValue:t,$dirty:true},r)}function $(t,r){return e.$setState({$value:t},r)}function d(t,r){return e.$setState({$touched:t},r)}function p(t,r){return e.$setState({$dirty:t},r)}function v(t,r){return e.$setState({$focused:t},r)}function h(t,r){return e.$setState({$error:t},r)}function m(t){var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:true;var n=arguments.length>2?arguments[2]:undefined;var a=Object.assign({},e.$state.$error);if(Vt(r)){a[t]=r||t;Ot(r,t,e.props.name)}else{delete a[t]}return h(a,n)}function g(t,r){return e.$setState({$pending:t},r)}function y(){var t=e.$state.$error,r=t===void 0?{}:t;for(var n in r){if(r.hasOwnProperty(n)){return r[n]instanceof Error?r[n].message:r[n]}}}function b(t){var r=Object.assign({},t);if("$error"in r){if(!r.$error){r.$error={}}r.$valid=Object.keys(r.$error).length===0}var n=e.props,a=n.$parser,i=n.$formatter;if("$viewValue"in r&&!("$value"in r)){var u=function e(t){return r.$viewValue=t};r.$value=a?a(r.$viewValue,u):r.$viewValue}else if("$value"in r&&!("$viewValue"in r)){var s=function e(t){return r.$value=t};r.$viewValue=i?i(r.$value,s):r.$value}if("$valid"in r){r.$invalid=!r.$valid}else if("$invalid"in r){r.$dirty=!r.$invalid}if("$dirty"in r){r.$pristine=!r.$dirty}else if("$pristine"in r){r.$dirty=!r.$pristine}if("$touched"in r){r.$untouched=!r.$touched}else if("$untouched"in r){r.$touched=!r.$untouched}e.$state=o({},e.$state,{},r);return f()}return r}var Dt=Array.isArray;var At=Object.keys;var _t=Object.prototype.hasOwnProperty;var Tt=typeof Element!=="undefined";function Rt(e,t){if(e===t)return true;if(e&&t&&typeof e=="object"&&typeof t=="object"){var r=Dt(e),n=Dt(t),a,i,o;if(r&&n){i=e.length;if(i!=t.length)return false;for(a=i;a--!==0;)if(!Rt(e[a],t[a]))return false;return true}if(r!=n)return false;var u=e instanceof Date,s=t instanceof Date;if(u!=s)return false;if(u&&s)return e.getTime()==t.getTime();var f=e instanceof RegExp,l=t instanceof RegExp;if(f!=l)return false;if(f&&l)return e.toString()==t.toString();var c=At(e);i=c.length;if(i!==At(t).length)return false;for(a=i;a--!==0;)if(!_t.call(t,c[a]))return false;if(Tt&&e instanceof Element&&t instanceof Element)return e===t;for(a=i;a--!==0;){o=c[a];if(o==="_owner"&&e.$$typeof){continue}else{if(!Rt(e[o],t[o]))return false}}return true}return e!==e&&t!==t}var Nt=function e(t,r){try{return Rt(t,r)}catch(e){if(e.message&&e.message.match(/stack|recursion/i)||e.number===-2146828260){console.warn("Warning: react-fast-compare does not handle circular references.",e.name,e.message);return false}throw e}};var Mt=function(e){w(t,e);function t(){var e;var r;v(this,t);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++){a[i]=arguments[i]}r=b(this,(e=P(t)).call.apply(e,[this].concat(a)));r.$$FIELD_UUID=Ft();r.$formContext=void 0;r.$state=void 0;r.$setState=function(e,t){return new Promise(function(n){var a=function e(){return n(Me(t,r.$fieldutil))};if(r.isMounting){var i=r.props.name;if(i in(r.$formContext.$$registers||{})){r.$formContext.$$onChange(i,e,a)}else{r.$registered.$$merge(e);r.$registered.$$detectChange(e);r.forceUpdate(a)}}else{r.$registered.$$merge(e);a()}})};return r}m(t,[{key:"componentDidMount",value:function e(){this.isMounting=true;var t=this.props.name,r=this.$formContext;Ve(!t||r.$formutil);if(r.$$register){r.$$register(t,this.$fieldHandler)}this.$prevState=this.$state;qe(this.props.$ref,this.$fieldutil)}},{key:"componentWillUnmount",value:function e(){if(this.$formContext.$$unregister){this.$formContext.$$unregister(this.props.name,this.$fieldHandler,this.props.$reserveOnUnmount)}this.isMounting=false;qe(this.props.$ref,null)}},{key:"componentDidUpdate",value:function e(t){var r=this.props.name;if(r!==t.name){if(this.$formContext.$$register){this.$formContext.$$register(r,this.$fieldHandler,t.name)}}qe(this.props.$ref,this.$fieldutil);if(this.$state.$value!==this.$prevState.$value){if(!(r in(this.$formContext.$$registers||{}))){this.$registered.$$triggerChange({$newValue:this.$state.$value,$prevValue:this.$prevState.$value})}}this.$prevState=this.$state}},{key:"shouldComponentUpdate",value:function e(t){if(this.props.$renderLazy){return!Nt(t,this.props)||!Nt(this.$registered.$getState(),this.$prevState)}return true}},{key:"_render",value:function e(){var t=this.$fieldutil=o({$name:this.props.name},this.$registered.$getState(),{},this.$registered,{$$formutil:this.$formContext.$formutil});return jt(t,this.props)}},{key:"render",value:function e(){var t=this;return n.createElement(C.Consumer,null,function(e){var r=!t.$formContext;t.$formContext=e();if(!t.$fieldHandler){t.$fieldHandler=xt(t,t)}t.$registered=(t.$formContext.$$registers||{})[t.$fieldHandler.$name]||t.$fieldHandler;if(r){t.$fieldHandler.$$reset();t.$fieldHandler.$validate()}return t._render()})}}]);return t}(t.Component);Mt.displayName=Et;var Ut=Object.keys(kt);function It(e){var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};var a=t.forwardRef(function(t,a){var i=Object.assign({},t);var u=t.component,s=it(t,["component"]);Ut.concat(Object.keys(o({},r.$validators,{},r.$asyncValidators,{},i.$validators,{},i.$asyncValidators))).forEach(function(e){if(e in i){if(e==="$validators"||e==="$asyncValidators"||e==="$defaultState"){s[e]=o({},r[e],{},i[e])}delete i[e]}});return n.createElement(Mt,Object.assign({},r,s,{render:function t(r){return n.createElement(e,Object.assign({},i,{$fieldutil:r,ref:a}))}}))});a.displayName="React.Formutil.withField."+(e.displayName||e.name||"Anonymous");return yt(a,e)}var Lt=Ue(It);var Ht=function(e){w(t,e);function t(){v(this,t);return b(this,P(t).apply(this,arguments))}m(t,[{key:"render",value:function e(){var t=this;var r=this.props,a=r.$fieldutil,i=r.value,o=r.onChange,u=r.onFocus,s=r.onBlur,f=r.checked,l=r.unchecked,c=it(r,["$fieldutil","value","onChange","onFocus","onBlur","checked","unchecked"]);var $=this.props.type;var d={value:"compositionValue"in this?this.compositionValue:i,onCompositionEnd:function e(r){t.composition=false;delete t.compositionValue;d.onChange(r)},onCompositionStart:function e(){return t.composition=true},onChange:function e(r){var n=r.target.value;if(t.composition){t.compositionValue=n;t.forceUpdate()}else{o(n,r)}},onFocus:u,onBlur:s};var p="input";switch($){case"select":p=$;d.onChange=function(e){var t=e.target;var r=t.multiple?[].slice.call(t.options).filter(function(e){return e.selected}).map(function(e){return e.value}):t.value;o(r,e)};delete c.type;break;case"textarea":p=$;delete c.type;break;case"checkbox":case"radio":d={checked:i===f,onChange:function e(t){o(t.target.checked?f:l,t)},onFocus:u,onBlur:s};break}return n.createElement(p,Object.assign({},c,d))}}]);return t}(t.Component);Ht.displayName="React.Formutil.EasyField.Native";Ht.defaultProps={value:"",type:"text",checked:true,unchecked:false};var zt=t.createContext(function(){return{}}),Bt=zt.Provider,qt=zt.Consumer;var Qt=function(e){w(r,e);function r(){var e;var t;v(this,r);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++){a[i]=arguments[i]}t=b(this,(e=P(r)).call.apply(e,[this].concat(a)));t.getGroupContext=function(){return t.props};return t}m(r,[{key:"_render",value:function e(){var r=this.props,a=r.className,i=r.groupNode,o=r.children;var u={GroupOption:Gt,Field:Kt};var s=je(o)?o(u):t.Children.map(o,function(e){return t.cloneElement(e,u)});if(i===null){return s}return n.createElement(i,{className:a},s)}},{key:"render",value:function e(){return n.createElement(Bt,{value:this.getGroupContext},this._render())}}]);return r}(t.Component);Qt.displayName="React.Formutil.EasyField.Group";Qt.defaultProps={type:"checkbox",groupNode:"div"};var Gt=function(e){w(t,e);function t(){v(this,t);return b(this,P(t).apply(this,arguments))}m(t,[{key:"componentDidMount",value:function e(){Ve("$value"in this.props)}},{key:"render",value:function e(){var t=this.props,r=t.$value,a=t.onChange,i=t.onFocus,o=t.onBlur,u=it(t,["$value","onChange","onFocus","onBlur"]);return n.createElement(qt,null,function(e){var t=e();var s=t.type,f=t.name;var l=s==="radio"?{checked:t.value===r,onChange:function e(n){t.onChange(r,n);a&&a(n)}}:s==="checkbox"?{checked:t.value.indexOf(r)>-1,onChange:function e(n){t.onChange(n.target.checked?t.value.concat(r):t.value.filter(function(e){return e!==r}),n);a&&a(n)}}:{value:t.value,onChange:function e(r){t.onChange(r);a&&a(r)}};return n.createElement("input",Object.assign({name:f},u,l,{type:s,onFocus:function e(r){t.onFocus(r);i&&i(r)},onBlur:function e(r){t.onBlur(r);o&&o(r)}}))})}}]);return t}(t.Component);Gt.displayName="React.Formutil.EasyField.Group.Option";var Kt=function(e){w(t,e);function t(){v(this,t);return b(this,P(t).apply(this,arguments))}m(t,[{key:"componentDidMount",value:function e(){}},{key:"render",value:function e(){return n.createElement(Gt,this.props)}}]);return t}(t.Component);Kt.displayName="React.Formutil.EasyField.Group.Option.Deprecated";var Yt=n.Frament||"div";var Wt=function(e){w(t,e);function t(e){var r;v(this,t);r=b(this,P(t).call(this,e));r.id=0;r.latestValue=r.props.value;r.$formutil=void 0;r.FieldValidators={required:function e(t){return t!==null}};r.$onFormChange=function(e){e.$onValidates(function(e){var t=e.$invalid,n=e.$params;if(t){if(r.props.value.length){r.props.onChange(r.latestValue=[])}}else if(!Nt(r.props.value,n.list)){r.props.onChange(r.latestValue=n.list)}})};r.swap=function(e,t,n){return r.$setState(function(r){var n=r.items;var a=[n[e],n[t]];n[t]=a[0];n[e]=a[1];return n},n)};r.insert=function(){var e,t,n;for(var a=arguments.length,i=new Array(a),o=0;o<a;o++){i[o]=arguments[o]}i.forEach(function(r){if(je(r)){n=r}else if(typeof r==="number"){e=r}else if(typeof r==="object"){t=r}});return r.$setState(function(n){var a=n.items;if(Fe(e)){a.push(r.getId(t))}else{a.splice(e,0,r.getId(t))}return{items:a}},n)};r.remove=function(){var e,t;for(var n=arguments.length,a=new Array(n),i=0;i<n;i++){a[i]=arguments[i]}a.forEach(function(r){if(je(r)){t=r}else if(typeof r==="number"){e=r}});return r.$setState(function(t){var n=t.items;if(Fe(e)){n.pop()}else{n.splice(e,1)}if(!n.length){n=[r.getId()]}return{items:n}},t)};r.$setState=function(e,t){return new Promise(function(n){return r.setState(e,function(){return r.$formutil.$onValidates(function(e){return n(Me(t,e))})})})};r.state={items:e.value.length?e.value.map(function(){return r.getId()}):[r.getId()],formKey:0};return r}m(t,[{key:"componentDidUpdate",value:function e(t){var r=this;if(this.props.value!==this.latestValue){this.setState({items:this.props.value.length?this.props.value.map(function(){return r.getId()}):[this.getId()],formKey:this.state.formKey+1});this.latestValue=this.props.value}}},{key:"getId",value:function e(t){return{id:this.id++,values:t}}},{key:"render",value:function e(){var t=this;var r=this.props,a=r.children,i=r.onFocus,u=r.onBlur,s=r.value;var f=this;if(!je(a)){return null}var l={$insert:this.insert,$remove:this.remove,$swap:this.swap,$push:function e(r,n){return t.insert(r,n)},$pop:function e(r){return t.remove(r)},$shift:function e(r){return t.remove(0,r)},$unshift:function e(r,n){return t.insert(0,r,n)},onFocus:i,onBlur:u};return n.createElement(nt,{key:this.state.formKey,$defaultValues:{list:s},$onFormChange:this.$onFormChange,children:function e(r){t.$formutil=r;return n.createElement(Yt,null,t.state.items.map(function(e,i){var u=e.id,s=e.values;return n.createElement(Mt,{key:u,required:true,$defaultValue:s||null,$validators:t.FieldValidators,name:"list[".concat(i,"]"),children:function e(u){return n.createElement(nt,{$defaultValues:u.$value||{},$onFormChange:function e(t){return t.$onValidates(function(e){var t=e.$invalid,r=e.$params;if(t){if(u.$viewValue!==null){u.$render(null)}}else if(!Nt(u.$viewValue,r)){u.$render(r)}})},children:function e(n){return a(o({get $length(){return f.state.items.length},$index:i,$isLast:function e(){return i===t.state.items.length-1},$isFirst:function e(){return i===0}},l,{},n),r)}})}})}))}})}}]);return t}(t.Component);Wt.displayName="React.Formutil.EasyField.List";var Jt="__TYPE__";var Xt=[["required",function(e,t,r){var n=r.__TYPE__,a=r.checked,i=a===void 0?true:a;return n==="checked"?e===i:!xe(e)}],["maxLength",function(e,t){return xe(e)||e.length<=t}],["minLength",function(e,t){return xe(e)||e.length>=t}],["max",function(e,t){return xe(e)||e*1<=t}],["min",function(e,t){return xe(e)||e*1>=t}],["pattern",function(e,t){return xe(e)||t.test(e)}],["enum",function(e,t){return xe(e)||t.indexOf(e)>-1}],["checker",function(e,t,r){return t(e,r)}]].reduce(function(e,t){var r=p(t,2),n=r[0],a=r[1];e[n]=function e(t,r,i){var o=i.validMessage,u=o===void 0?{}:o;return a.apply(void 0,arguments)||u[n]||"Error input: ".concat(n)};return e},{});var Zt="React.Formutil.EasyField";var er={validMessage:{},valuePropName:"value",changePropName:"onChange",focusPropName:"onFocus",blurPropName:"onBlur",$parser:function e(t){return typeof t==="string"?t.trim():t}};function tr(e,t,r){var n;var i=t.valuePropName,u=t.changePropName,s=t.focusPropName,f=t.blurPropName,l=t.getValueFromEvent,c=t.passUtil;var $=function e(t){return t&&t.target?t.target[i]:t};var d=o({},r,(n={},a(n,i,e.$viewValue),a(n,u,function(r){var n;for(var a=arguments.length,i=new Array(a>1?a-1:0),o=1;o<a;o++){i[o-1]=arguments[o]}if(((n=i[0])===null||n===void 0?void 0:n.nativeEvent)instanceof Event){i.push(r)}else{i.unshift(r)}var s=t[u];s&&s.apply(void 0,i);var f=l?l.apply(void 0,i):$(r);e.$render(f)}),a(n,s,function(){var r=t[s];r&&r.apply(void 0,arguments);e.$setFocused(true)}),a(n,f,function(){var r=t[f];r&&r.apply(void 0,arguments);if(e.$untouched){e.$setTouched(true)}e.$setFocused(false)}),n));if(c){d[c===true?"$fieldutil":String(c)]=e}return d}function rr(e){var t=e.children,r=e.component,n=e.render,a=it(e,["children","component","render"]);var i=a.name,u=a.type,s=a.defaultValue,f=a.valuePropName,l=a.changePropName,c=a.focusPropName,$=a.blurPropName,d=a.getValueFromEvent,v=a.validMessage,h=a.checked,m=a.unchecked,g=a.__TYPE__,y=a.passUtil,b=a.$defaultValue,P=a.$defaultState,S=a.$onFieldChange,w=a.$validators,C=a.$asyncValidators,V=a.$validateLazy,O=a.$reserveOnUnmount,k=a.$parser,E=a.$formatter,F=a.$ref,j=it(a,["name","type","defaultValue","valuePropName","changePropName","focusPropName","blurPropName","getValueFromEvent","validMessage","checked","unchecked","__TYPE__","passUtil","$defaultValue","$defaultState","$onFieldChange","$validators","$asyncValidators","$validateLazy","$reserveOnUnmount","$parser","$formatter","$ref"]);var x={children:t,component:r,render:n};var D=!Fe(u)||Fe(t)&&Fe(r)&&Fe(n);Object.keys(o({},a.$validators=o({},Xt,{},a.$validators),{},a.$asyncValidators)).forEach(function(e){if(e in j){if(!D||!Le(e)){delete j[e]}}});if(D){var A=(u||"").split("."),_=p(A,2),T=_[0],R=T===void 0?"text":T,N=_[1];x.component=R==="group"?Qt:R==="list"?Wt:Ht;if(i){j.name=i}if(u){j.type=R}if(t){j.children=t}j.checked=h;j.unchecked=m;switch(R){case"select":case"textarea":if(e.multiple){a[Jt]="array"}break;case"group":if(N==="checkbox"){a[Jt]="array"}j.type=N;break;case"checkbox":case"radio":a[Jt]="checked";break;case"list":a[Jt]="array";break}}if(!("$defaultValue"in a)&&"defaultValue"in e){a.$defaultValue=s}if(!("$defaultValue"in a)&&Jt in a){var M;switch(a[Jt]){case"checked":var U=a.unchecked,I=U===void 0?false:U;M=I;break;case"array":M=[];break;case"object":M={};break;case"number":M=0;break}a.$defaultValue=M}return{fieldProps:a,childProps:j,renderProps:x}}function nr(e,r){var n=r.component,a=r.render,i=r.children;if(n){return t.createElement(n,e)}if(je(a)){return a(e)}if(je(i)){return i(e)}return t.Children.map(i,function(r){return t.cloneElement(r,e)})}var ar=function(e){w(t,e);function t(){v(this,t);return b(this,P(t).apply(this,arguments))}m(t,[{key:"render",value:function e(){var t=rr(this.props),r=t.fieldProps,a=t.childProps,i=t.renderProps;return n.createElement(Mt,Object.assign({},r,{children:function e(t){return nr(tr(t,r,a),i)}}))}}]);return t}(t.Component);ar.displayName=Zt;ar.defaultProps=er;var ir=function(e){w(r,e);function r(){v(this,r);return b(this,P(r).apply(this,arguments))}m(r,[{key:"shouldComponentUpdate",value:function e(t){var n=r.pruneProps(t);var a=r.pruneProps(this.props);return!Nt(n,a)}},{key:"render",value:function e(){var r=this.props,n=r.$component,a=r.$pruneProps,i=it(r,["$component","$pruneProps"]);if(we(n))return t.createElement(n,i);return null}}]);return r}(t.Component);ir.displayName="React.Formutil.LazyRender";ir.defaultProps={$pruneProps:[]};ir.pruneProps=function(e){var t=Object.assign({},e);t.$pruneProps.forEach(function(e){delete t[e]});return t};function or(e){var r=t.forwardRef(function(t,r){return n.createElement(C.Consumer,null,function(a){return n.createElement(e,Object.assign({},t,{$formutil:a().$formutil,ref:r}))})});r.displayName="React.Formutil.connect."+(e.displayName||e.name||"Anonymous");return yt(r,e)}function ur(){if(!n.useState){throw new Error("Hooks api need react@>=16.8, Please upgrade your reactjs.")}var e=n.useContext;var t=e(C);return t()}function sr(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};if(!n.useState){throw new Error("Hooks api need react@>=16.8, Please upgrade your reactjs.")}var r=n.useState,a=n.useLayoutEffect,i=n.useRef;var u;if(e){if(typeof e==="string"){u=e;t.name=u}else{t=e;u=t.name}}var s=ur();var f=i({}).current;var c=i([]);var $;f.$formContext=s;f.props=t;f.$setState=m;var d=r(function(){f.$$FIELD_UUID=Ft();f.$fieldHandler=$=xt(f);var e=f.$fieldHandler.$$reset();f.$fieldHandler.$validate();return e}),v=p(d,2),h=v[1];if(!$){$=(s.$$registers||{})[f.$fieldHandler.$name]||f.$fieldHandler}a(function(){var e=f.$state;if(f.isMounting){if(!(u in(s.$$registers||{}))){$.$$triggerChange({$newValue:e.$value,$prevValue:f.$prevState.$value})}}f.$prevState=e},[f.$state.$value]);a(function(){f.isMounting=true;Ve(!u||s.$formutil);return function(){f.isMounting=false;qe(t.$ref,null)}},[]);a(function(){if(s.$$register){s.$$register(u,f.$fieldHandler)}return function(){if(s.$$unregister){s.$$unregister(u,f.$fieldHandler,!f.isMounting&&t.$reserveOnUnmount)}}},[u]);a(function(){qe(t.$ref,f.$fieldutil)});a(function(){if(c.current.length>0){var e=l(c.current);c.current.length=0;while(e.length){e.pop()(f.$fieldutil)}}});function m(e,t){return new Promise(function(r){var n=function e(){return r(Me(t,f.$fieldutil))};if(f.isMounting){if(u in(s.$$registers||{})){s.$$onChange(u,e,n)}else{h($.$$merge(e));$.$$detectChange(e);c.current.push(n)}}else{$.$$merge(e);n()}})}return f.$fieldutil=o({$name:u},$.$getState(),{},$,{$$formutil:s.$formutil})}function fr(){var e=ur(),t=e.$formutil;return t}function lr(e){e=o({},er,{},e,{children:null});var t=rr(e),r=t.fieldProps,n=t.childProps;var a=sr(r);return tr(a,r,n)}e.EasyField=ar;e.Field=Mt;e.Form=nt;e.LazyRender=ir;e.connect=or;e.formContext=C;e.useField=sr;e.useForm=fr;e.useHandler=lr;e.withField=Lt;e.withForm=St;Object.defineProperty(e,"__esModule",{value:true})});
